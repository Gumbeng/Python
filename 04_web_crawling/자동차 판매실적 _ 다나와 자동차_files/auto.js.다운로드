$(function(){
	
	if (lnb == 'home') {
		
		// 견적 추가문의 선택시 제공동의 문구 수정
		$(document).on('click', "#write_form div[id^='addRequestList_']", function() {
			if($("input[name=comapnyCode]").val() != "danawa") {
				var sellerName = $("#sellerName").val();
				var otherHoldingPeriod = "6개월";
				var check = true;
				
				var addRequestCompanyCode = '';
				var danawaCheck = false;
				$("input[id^=r-addesti_]:checked").each(function(i, e){
					check = false;
					
					if (!sellerName) {
						sellerName += $(this).val();
					}
					else {
						sellerName += ", " + $(this).val();
					}
	
					if($(this).val() == "(주)오토홀딩스") {
						otherHoldingPeriod += " (직영몰 계약 시 계약 만료일까지)";
						sellerName += ", " + "(주)마이카오토";
					}
					
					var currentTargetId = $(this).get(0).id;
					var idArray = currentTargetId.split('_');
					if(idArray.length == 3) {
						if(idArray[1] == 'danawa') {
							danawaCheck = true;
						}
					}
				});
				
				if ($("input[id^=r-addesti_]:checked").length != 5) {
					$("#write_form #checkAddRequestTop5").attr('checked', false);
				}
				
				$("#otherSeller").html(sellerName);
				$(".txtHoldingPeriod").html(otherHoldingPeriod);
				
				if(danawaCheck) {
					$("#otherAgreeSamsung").show();
					$("#otherAgreeStarAuto").show();
				} else {
					$("#otherAgreeSamsung").hide();
					$("#otherAgreeStarAuto").hide();    					
				}
			}
		});
		
		// 전화상담 > 동의
		$(document).on('click', "#write_form dt .btn-toggle", function() {
			var $selectAgree = $(this).closest("dl");
			if ($selectAgree.hasClass("g-agree--open")) {
				$selectAgree.removeClass("g-agree--open");
				$selectAgree.addClass("g-agree--close");
			}
			else {
				$selectAgree.removeClass("g-agree--close");
				$selectAgree.addClass("g-agree--open");
			}
		});
	
		// 재확인 요청 레이어 숨김처리
		$(document).on("click", ".reconfirmClose", function() {
			$("#reconfirmLayerPopup").css('display', 'none');
		});
		
		// 재확인 후 견적 요청
		$(document).on("click", "#reconfirmCompletion", function() {
			// 다중 버튼 클릭시, 한번만 실행되도록 체크
			if(doubleSubmitCheck()) {
				return;
			}
			
			var url = webUrl+"/action/ssl.leaserent.request.action.php";
			
			if (bIsReal) {
				url = "https://auto.danawa.com/action/ssl.leaserent.request.action.php";
			}
			
			//전환스크립트 호출전
			sendGA('렌트/리스_호출전','');
			if($('#lastServerNum').length > 0) {
				if($('#lastServerNum').val() > 0) {
					eval('try{ _trk_clickTrace( \'EVT\', \'렌트_리스_호출전_' + $('#lastServerNum').val() + '\' ); }catch(_e){ }');
				}
			}
			
			if (gnb == 'home') {
				naverScript(1, 10000000000000);
			}
	
			var sPordList = "";
			$('#write_form').ajaxForm({
				url: url,
				enctype: "multipart/form-data",
				type: 'POST',
				async: false,
				dataType : 'json',
				success: function(data){
					if (data.code == "1" && bIsReal) {
						// 전환분석 스크립트
						if($("#write_form input[name='comapnyCode']").val() == 'danawaDeals') {
							naverScript(1, 100);
							
							var brandCode = $("#write_form input[name='nBrandCode']").val();
							var modelCode = $("#write_form input[name='nModelCode']").val();
							if(DmpScriptModule) {
								DmpScriptModule.actionUrl(webUrl+'/occasion/2103_danawaHotdealScript.php?trk_pnc='+brandCode+""+modelCode);
							}
						} else {
							naverScript(1, 1);
								
							if(DmpScriptModule) {
								DmpScriptModule.actionUrl(webUrl+'/occasion/1906_rentLeaseScript.php?trk_pnc='+$("#rentLeaseEstimateBrand").attr('brand')+""+$("#model").val());
							}
						}
						
						//gtag 이벤트 스니펫 추가
						gtag('event', 'conversion', {'send_to': 'AW-952650720/rSVuCOfA08EYEOCXocYD'});
						
						//전환스크립트 호출후
						sendGA('렌트/리스_호출완료',$("#write_form input[name='comapnyCode']").val());
						
						/** 추가 견적 요청에 따른 전환 스크립트 **/
						if($("input[id^=r-addesti_]:checked").length > 0) {
							$("input[id^=r-addesti_]:checked").each(function(e){
								var addCompanyInfo = $(this).get(0).id.replace('r-addesti_', '').split("_")[0];
								var addCompanyDanawaPrice = $("#addRequestList_" + addCompanyInfo).find(".price .num").text().replace(/[^\d]+/g, "");
								
								
								if(addCompanyInfo == 'danawa') {
	
								} else {
									naverScript(1, 1);
									
									if(DmpScriptModule) {
										DmpScriptModule.actionUrl(webUrl+'/occasion/1906_rentLeaseScript.php?trk_pnc='+$("#rentLeaseEstimateBrand").attr('brand')+""+$("#model").val());
									}
								}
								
								if (gnb == 'home') {
									naverScript(1, 10000000000000);
								}
								
								//gtag 이벤트 스니펫 추가
								gtag('event', 'conversion', {'send_to': 'AW-952650720/rSVuCOfA08EYEOCXocYD'});
								
								//전환스크립트 호출후
								sendGA('렌트/리스_호출완료',$("#write_form input[name='comapnyCode']").val());
							});
						}
						/** //추가 견적 요청에 따른 전환 스크립트 **/
						
						alert(data.message);
					} else {
						alert(data.message);
					}
				},
				complete: function () {
					window.location.reload(true);
				}
			});
			
			$("#write_form").submit();
			return false;
		});
	
		// 전화상담 > 견적요청
		$(document).on("click", "#rentLeaseSubmit.on", function() {
	
			var vaildMsg = trk_pnc = "";
			var tranName = $("#write_form input[name='name']").val().replace(/[^가-힣a-zA-Z]/gi, "");
			
			if ($("#rentLeaseSubmit").hasClass('disabled')) {
				vaildMsg = '견적 요청중입니다.';
			}
			else {
				$("#rentLeaseSubmit").addClass('disabled');
			}
			
			if($("#write_form input[name='comapnyCode']").val() == 'danawa') {
				var phoneNumber = $('#userPhone1').val() + $('#userPhone2').val();
				var testPhoneNumber = phoneNumber.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3");
				$("#write_form input[name='validatedPhoneNumber']").val(testPhoneNumber);
			}
			
			if ($("#write_form input[name='name']").val() == "") vaildMsg = "이름을 반드시 입력해 주세요.";
			else if ($("#write_form input[name='name']").val().length > 0 && (tranName.length < 2 || $("#write_form input[name='name']").val() != tranName)) vaildMsg = "이름을 바르게 입력했는지 다시 확인해주세요.";
			else if ($("#write_form input[name='validatedPhoneNumber']").val() == "") vaildMsg = "휴대전화번호를 반드시 입력해 주세요.";
			else if ($("#write_form input[name='validatedPhoneNumber']").val().length < 10) vaildMsg = "휴대전화번호를 바르게 입력했는지 다시 확인해주세요.";
			else if (($("#write_form select[name='sido']").val() == "") || ($("#write_form select[name='sigungu']").val() == "")) vaildMsg = "지역을 선택해주세요.";
			else if (!$("#write_form #agreeCheck1").is(":checked") || !$("#write_form #agreeCheck2").is(":checked")) vaildMsg = "개인정보 수집 및 제3자 제공에 동의해야 견적 요청이 가능합니다.";
			
	        if (vaildMsg != "") {
	        	$("#rentLeaseSubmit").removeClass('disabled');
		        alert(vaildMsg);
		        return false;
	        }
		 	
		 	if (1 && vaildMsg == "") {
		 		$("#rentLeaseSubmit").removeClass('disabled');
				$("#reconfirmLayerPopup").css('display', 'block');
				
				$("#reconfirmLocal").text($("#write_form select[name='sido']").val() + ' ' + $("#write_form select[name='sigungu']").val());
				$("#reconfirmName").text($("#write_form input[name='name']").val());
				
				$("#reconfirmPhoneNum").text($("#write_form input[name='validatedPhoneNumber']").val());
				
				$("#write_form input[name='optionSeqs']").val("");
				var optionSeqs = "";
				$("#Optn_1 .eChkItemList input:checked").each(function(e){
					var optionSeq = $(this).attr('code');
					var optionName = $("label[for='"+ $(this).get(0).id +"']").text();
					if(e == 0) {
						optionSeqs += optionSeq +":" + optionName;
					} else {
						optionSeqs += "@" + optionSeq +":" + optionName;
					}					
				});
				$("#write_form input[name='optionSeqs']").val(optionSeqs);
				
				var companyCode = '';
				var requestNo = '';
				
				var addRequestCompanyCode = '';
				var addRequestCompanyName = '';
				
				$("input[id^=r-addesti_]:checked").each(function(e){
					
					var codeArray = $(this).get(0).id.replace('r-addesti_', '').split("_");
					
					if(e == 0) {
						companyCode = codeArray[0];
						requestNo = codeArray[1];
						
						if(codeArray[0] != 'danawa') {
							addRequestCompanyName += $(this).val();
						}
					} else {
						if (e == 1) {
							addRequestCompanyCode += $(this).get(0).id.replace('r-addesti_', '');							
						}
						else {
							addRequestCompanyCode += "," + $(this).get(0).id.replace('r-addesti_', '');
						}
						
						if(codeArray[0] != 'danawa') {
							addRequestCompanyName += ", " + $(this).val();
						}
					}
				});

				$("#companyCode").val(companyCode);
				$("#requestNo").val(requestNo);
				
				$("#write_form input[name='addRequestCompanyCode']").val(addRequestCompanyCode);
				$("#write_form input[name='addRequestCompanyName']").val(addRequestCompanyName);
				
			}

			sendGA('전광판', '렌트리스_브랜드_모델_상담신청_신청완료');

			return false;
			
		});
		
		// 견적요청 필수값 체크
		$(document).on("change", "#write_form input[name='name'], " +
				"#write_form input[name='validatedPhoneNumber'], " +
				"#write_form #agreeCheck1, " +
				"#write_form #agreeCheck2, " +
				"#write_form #userPhone2, " +
				"#write_form #sigungu, " + 
				"#write_form .request-addesti__item, " +
				".request-addesti ", function(){	
			if ($("#write_form input[name='name']").val() &&
				($("#write_form input[name='validatedPhoneNumber']").val() || $("#write_form #userPhone2").val())
				&& $("#write_form #agreeCheck1").is(":checked") 
				&& $("#write_form #agreeCheck2").is(":checked") 
				&& $("#write_form #sigungu").val()
				&& $('input[type="checkbox"][id^="r-addesti_"]:checked').length > 0) {
				$("#rentLeaseSubmit").addClass('on');
	    	} else {
	    		$("#rentLeaseSubmit").removeClass('on');
	    	}
	    });
		
		$(document).on("change", "#write_form #sido", function () {
			var sidoCode = $(this).val();
			var sidoName = $("#sido option:selected").html();
	
			$.get(
					"../service/ajax_auto_sigunguSelect.php",
					{
					    Sido:sidoCode,
					    Type:"name"
					},
					function (data, status) {
						if (status == "success") {
							$("#write_form #sigungu").html(data.replace("전지역", "시/군/구")).parent().find('label').addClass('hide').find('.placeholder').text('시/군/구');
							
							if($("#write_form #sigungu").data('actionlabel') != "") {
								$("#write_form #sigungu").val($("#write_form #sigungu").data('actionlabel'));
							}
						}
					}
				);
		});
	
		// 전화상담 > 상담내용
		$(document).on("keyup", "#write_form #requestContents", function(){
			if ($(this).val().length == 0) {
				$("#requestContents").parent(".textareabox").find('label').removeClass('hide');
			}
			else {
				$("#requestContents").parent(".textareabox").find('label').addClass('hide');
			}
		})
		
		/** 인증번호 발송 이벤트 **/
		$(document).on("click","#certifyRequestItem #simpleCertifyRequestBtn",function(event) {

			event.preventDefault();
	
			if($(this).hasClass("certify-request__btn--disable") === true) {
				$(this).removeClass("certify-request__btn--disable");
				$(this).text("인증요청");
				$("#r-text_02").parents('div').removeClass("inputbox--disable");
				$("#r-text_02").val("");
				$("#certifySuccessItem").hide();
				$("#certifyNumberItemText").hide();
				$("#certifyTime").text("3:00");
				$("#r-text_02").attr("disabled", false);
				
				/** 전화번호 값 저장 **/
				$("#validatedPhoneNumber").val("");
				$("#validatedPhoneNumber").trigger("change");
				
			} else {
				var userName = $(".request-personal #userName").val();
				var phoneNumber = $(".request-personal #r-text_02").val();
	
				if($.trim(userName) == "") {
					$(".request-personal #userName").val("");
					$(".request-personal #userName").focus();
					return false;
				} else if(phoneNumber == "") {
					$(".request-personal #r-text_02").focus();
					return false;
				}
	
				$.ajax({
					type:"POST",
					url : webUrl + "/service/ajax_sendSms.php",
					data: {
	    				processKind: 'easyCertification',
	    				name : $(".request-personal #userName").val(),
	    				phoneNumber : $("#r-text_02").val(),
	    				serviceType : 1
	    			},
					dataType : "json",
					error : function(request, status, error) {
						alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
					},
					success: function (data) {
						if(data.result) {
							alert(data.message);
							
							if(data.tempRandNum > 0) {
								alert(data.tempRandNum);
							}
							$("#certifyPhoneNumber").val(phoneNumber);
							clearInterval(certificationObj);
							certificationTime = 180;
							certificationMin = "";
							certificationSec = "";
							
							$("#certifyNumber").val("");
							$("#certifyNumberItem").show();
							$("#certifyNumberItemText").show();
							$("#certifyTimeout").hide();
							
							certificationObj = setInterval(certificationTimeout, 1000);
							
							$(document).on("click","#layerPopup .btn-close", function(){
								clearInterval(certificationObj);
							});
						} else {
							alert(data.message);
							return false;
						}
					}
				});
			}
		});
		
		/** 인증번호 확인 이벤트 **/
		$(document).on("click", "#certifyCheckBtn", function(e) {
			
			var userName = $(".request-personal #userName").val();
			var phoneNumber = $("#certifyPhoneNumber").val();
			var certifyNumber = $("#certifyNumber").val();
			
			/** 입력 유효성 체크 **/
			if($.trim(userName) == "") {
				$(".request-personal #userName").val("");
				$(".request-personal #userName").focus();
				return false;
			} else if(phoneNumber == "") {
				$(".request-personal #r-text_02").focus();
				return false;
			}
	
			$.ajax({
				type:"POST",
				url : webUrl + "/service/ajax_sendSms.php",
				data: {
					processKind: 'certificationNumberChk',
					userName : userName,
					phoneNumber : phoneNumber,
					certifyNumber : certifyNumber,
					serviceType : 1
				},
				dataType : "json",
				error : function(request, status, error) {
					alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
				},
				success: function (data) {
					if(data.result) {
						clearInterval(certificationObj);
						$("#certifyNumberItem").hide();
						$("#certifySuccessItem").show();
						$("#r-text_02").parents('div').addClass('inputbox--disable');
						$("#certifyRequestBtn").addClass('certify-request__btn--disable');
						$("#certifyRequestBtn").text('번호변경');
						$("#r-text_02").attr("disabled", true);
						
						/** 전화번호 값 저장 **/
						$("#validatedPhoneNumber").val(phoneNumber.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"));
						$("#validatedPhoneNumber").trigger("change");
						
						if(phoneNumber.length == 11) {
							phoneNumber = phoneNumber.substring(0,3) + "****" + phoneNumber.substring(phoneNumber.length-4, phoneNumber.length);
						} else {
							phoneNumber = phoneNumber.substring(0,3) + "***" + phoneNumber.substring(phoneNumber.length-4, phoneNumber.length);
						}
						$("#r-text_02").val(phoneNumber);
						
						var date = new Date();
						date.setTime(date.getTime() + (180 * 1000)); //3분
						$.cookie('leaserentCertifiy', data.leaserentCertifiy, { expires: 1 });
						$.cookie('leaserentCertifiyNum', data.leaserentCertifiyNum, { expires: 1 });
						$.cookie('leaserentCertifiyName', data.leaserentCertifiyName, { expires: 1 });
					} else {
						alert(data.message);
					}
				}
			});
		});
		
		// 메인 렌트/리스 간편상담 더보기/닫기 버튼 클릭 시
		$(document).on("click",".request-addesti__wrap .choice-more",function(){
			if ($(".request-addesti__wrap .choice-more").hasClass("choice-more--open")) {
				$(".request-addesti__wrap .choice-more").removeClass("choice-more--open");
				$(".request-addesti__wrap .choice-more span").text("더보기");
				
				$("div[id^='addRequestList_']:GT(3)").addClass('off');
			}
			else {
				$(".request-addesti__wrap .choice-more").addClass("choice-more--open");
				$(".request-addesti__wrap .choice-more span").text("닫기");
				
				$("div[id^='addRequestList_']").removeClass('off');
			}
		});
		
		// 전화상담 > 색상선택(외장)
		$(document).on("click", "#write_form #mainRentLeaseColor #requestExteriorColorList button", function() {    			
			var choiceChk = false;
	
			if($(this).hasClass("request-color--choice") === false) {
				choiceChk = true;
			}
			choiceChk = true;
			var selectedColor = '';
			var selectedRgbColor = '';
	
			if ($(this).hasClass("request-color--choice")) {
				$(this).removeClass("request-color--choice");
			} else {
				$("#write_form #requestExteriorColorList button").removeClass('request-color--choice')
				$(this).addClass("request-color--choice");
			}
	
			$("#write_form #requestExteriorColorList .request-color__choice").empty();
			
			if ($("#requestExteriorColorList .request-color--choice").length) {
				$("#requestExteriorColorList .request-color--choice").each(function(idx, element){
					selectedColor += ", " + $(element).text();
					selectedRgbColor += "," + rgb2hex($(element).css('background-color'));
					$("#requestExteriorColorList .request-color__choice").append("<span class='txt'>"+$(element).text()+"</span>");
				});
			}
			
			if (selectedColor.length > 1) {
				selectedColor = selectedColor.substr(1, selectedColor.length);
			}
			if(selectedRgbColor.length > 1) {
				selectedRgbColor = selectedRgbColor.substr(1, selectedRgbColor.length);
			}
	
			$("#write_form input[name='carcolor']").val(selectedColor);
			$("#write_form input[name='carRgbColor']").val(selectedRgbColor);
			
			$("#requestInteriorColorList button").removeClass('request-color--disable');
			$("#requestInteriorColorList button").removeAttr('disabled');
			
			$("#requestExteriorColorList button").removeClass('request-color--disable');
			$("#requestExteriorColorList button").removeAttr('disabled');
			if(choiceChk) {
				var colorGroupArray = [];
				
				$(".request-color--choice").each(function() {
					var colorGroup = $(this).attr("group");
					if(colorGroup != "") {
						if(colorGroup.indexOf(",") > -1) {
							var tempArray = colorGroup.split(",");
							tempArray.forEach(function(item){
								colorGroupArray.push(item);
							});
						} else {
							colorGroupArray.push($(this).attr("group"));
						}
					}
				});
				
				colorGroupArray.forEach(function(item){
					$("#requestExteriorColorList button").each(function () {
						if($(this).hasClass("request-color--choice") === false) {
							if($(this).attr("group").indexOf(item) > -1) {
								$(this).addClass('request-color--disable');
								$(this).attr('disabled', 'disabled');								
							} 
						}
					});
					
					$("#requestInteriorColorList button").each(function () {
						if($(this).hasClass("request-color--choice") === false) {
							if($(this).attr("group").indexOf(item) > -1) {
								$(this).addClass('request-color--disable');
								$(this).attr('disabled', 'disabled');								
							}							
						}
					});
				});
			}
		});
		
		// 전화상담 > 색상선택(내장)
		$(document).on("click", "#write_form #mainRentLeaseColor #requestInteriorColorList button", function() {
			var choiceChk = false;
			if($(this).hasClass("request-color--choice") === false) {
				choiceChk = true;
			}
			choiceChk = true;
			var selectedColor = '';
			var selectedRgbColor = '';
			if ($(this).hasClass("request-color--choice")) {
				$(this).removeClass("request-color--choice");
			}
			else {
				$("#write_form #requestInteriorColorList button").removeClass('request-color--choice')
				$(this).addClass("request-color--choice");
			}
			
			$("#write_form #requestInteriorColorList .request-color__choice").empty();
			
			if ($("#requestInteriorColorList .request-color--choice").length) {
				$("#requestInteriorColorList .request-color--choice").each(function(idx, element){
					selectedColor += ", " + $(element).text();
					selectedRgbColor += "," + rgb2hex($(element).css('background-color'));
					if($(this).hasClass('request-color--twotone')) {
						selectedRgbColor += ":" + rgb2hex($(this).find('span.color').css('background-color'));
					}
					$("#requestInteriorColorList .request-color__choice").append("<span class='txt'>"+$(element).text()+"</span>");
				});
			}
			   			
			if (selectedColor.length > 1) {
				selectedColor = selectedColor.substr(1, selectedColor.length);
			}
			if(selectedRgbColor.length > 1) {
				selectedRgbColor = selectedRgbColor.substr(1, selectedRgbColor.length);
			}
			
			$("#write_form input[name='carInteriorColor']").val(selectedColor);
			$("#write_form input[name='carRgbInteriorColor']").val(selectedRgbColor);
			
			$("#requestInteriorColorList button").removeClass('request-color--disable');
			$("#requestInteriorColorList button").removeAttr('disabled');
			
			$("#requestExteriorColorList button").removeClass('request-color--disable');
			$("#requestExteriorColorList button").removeAttr('disabled');
			if(choiceChk) {
				var colorGroupArray = [];
				
				$(".request-color--choice").each(function() {
					var colorGroup = $(this).attr("group");
					if(colorGroup != "") {
						if(colorGroup.indexOf(",") > -1) {
							var tempArray = colorGroup.split(",");
							tempArray.forEach(function(item){
								colorGroupArray.push(item);
							});
						} else {
							colorGroupArray.push($(this).attr("group"));
						}    						
					}
				});
				
				colorGroupArray.forEach(function(item){
					$("#requestExteriorColorList button").each(function () {
						if($(this).hasClass("request-color--choice") === false) {
							if($(this).attr("group").indexOf(item) > -1) {
								$(this).addClass('request-color--disable');
								$(this).attr('disabled', 'disabled');								
							} 
						}
					});
					
					$("#requestInteriorColorList button").each(function () {
						if($(this).hasClass("request-color--choice") === false) {
							if($(this).attr("group").indexOf(item) > -1) {
								$(this).addClass('request-color--disable');
								$(this).attr('disabled', 'disabled');								
							}							
						}
					});
				});
			}
		});		
	
		// 메인 렌트/리스 간편상담 보증금/선납금 버튼 클릭 시
		//TODO
	
		// 메인 렌트/리스 간편상담 옵션 '변경하기' 버튼 클릭 시
		$(document).on("click", ".request-model__terms .box__option .button__change", function() {
			var prodType = $(".request-model__terms .box__option #prodtype li.on").data('prodtype');
			var period = $(".request-model__terms .box__option #month li.on").data('month');
			var priceType = $(".request-model__terms .box__option #pricetype li.on").data('pricetype');
			
			var prodTypeText = $(".request-model__terms .box__option #prodtype li.on").text();
			var periodText = $(".request-model__terms .box__option #month li.on").text();
			var priceTypeText = $(".request-model__terms .box__option #pricetype li.on").text();
			
			$("#prodType").val(prodType);
			$("#period").val(period);
			$("#priceType").val(priceType);
			
			if (prodType == 'R') {
				$('.request-model__rentinfo').html("약정 주행거리 연간 2만km<br/>부가세/자동차세/보험료 포함 (만 26세 이상 기준)");
			}
			else if (prodType == 'L') {
				$('.request-model__rentinfo').html("약정 주행거리 연간 2만km<br/>부가세 포함, 자동차세/보험료 별도 (만 26세 이상 기준)");
			}
			
			$(".request-model__terms #optionBox .box__header button").text(prodTypeText + " • " + periodText + " • " + priceTypeText);

			if ($(".request-model__terms #optionBox").hasClass("box__select--open")) {
				$(".request-model__terms #optionBox").removeClass("box__select--open");
				$(".request-model__terms #optionBox").addClass("box__select--close");
			}
			else if ($(".request-model__terms #optionBox").hasClass("box__select--close")){
				$(".request-model__terms #optionBox").removeClass("box__select--close");
				$(".request-model__terms #optionBox").addClass("box__select--open");
			}
			
			setSimpleRentLeaseLineup();
			setSimpleRentLeaseProductList();
			setSimpleRentLeaseFirstAmount();

		});
		
		// 메인 렌트/리스 간편상담 옵션 버튼 선택 시 이벤트 바인딩
		$(document).on("click", ".box__option ul li button", function () {
			$(this).closest('ul').find('li').removeClass('on');
			$(this).closest('li').addClass('on');
		});
		
		// 트림 변경하기 버튼 클릭 시
		$(document).on("click", ".request-model__terms .button__change", function() {
			var trimsCode = $('input[name=radio_01]:checked').val();
			var lineup = $('input[name=radio_01]:checked').data('title');
	
			var splitIndex = lineup.lastIndexOf('(');
			var subTitle = lineup.substring(0, splitIndex);
			
			if (lineup && trimsCode) {
				$('.request-model__terms #lineupBox .button__toggle').text(lineup);
				$('#trimsCode').val(trimsCode);
				$('.request-model__name .sub_title').text(subTitle);
				
				if ($('.request-model__terms #lineupBox').hasClass('box__select--open')) {
					$('.request-model__terms #lineupBox').removeClass('box__select--open');
					$('.request-model__terms #lineupBox').addClass('box__select--close');
				}
				
			}
			setSimpleRentLeaseFirstAmount();
			setSimpleRentLeaseProductList();	
		});
		
		// 메인 렌트/리스 간편상담 버튼 이벤트 바인딩
		$(document).on("click", ".request-model__terms .box__select .box__header button", function() {
			var buttonId = $(this).attr("id");
			var boxId = "";
	
			if (buttonId == 'lineupButton') {
				boxId = "#lineupBox";
			}
			else if (buttonId == 'optionButton') {
				boxId = "#optionBox";
			}
	
			if ($(".request-model__terms " + boxId).hasClass("box__select--open")) {
				$(".request-model__terms " + boxId).removeClass("box__select--open");
				$(".request-model__terms " + boxId).addClass("box__select--close");
			}
			else if ($(".request-model__terms " + boxId).hasClass("box__select--close")){
				
				$(".request-model__terms " + boxId).removeClass("box__select--close");
				$(".request-model__terms " + boxId).addClass("box__select--open");
				
				if(buttonId == 'optionButton') {
					
					var prodType = $("#prodType").val();
					var period = $("#period").val();
					var priceType = $("#priceType").val();
					
					// 옵션 버튼 선택된 값에 맞게 초기화
					$(".box__option ul li button").closest('.box__option ul').find('li').removeClass('on');
					$("[data-prodtype=" + prodType + "]").addClass('on');
					$("[data-month=" + period + "]").addClass('on');
					$("[data-pricetype=" + priceType + "]").addClass('on');
				}
				else if (buttonId == 'lineupButton') {
					var trimsCode = $('#trimsCode').val();
					$('input[name=radio_01]:input[value=' + trimsCode + ']').prop('checked',true);
				}
			}
			setSimpleRentLeaseFirstAmount();
		});
	}
	// Location 브랜드/세그먼트/모델 선택
	$(document).on("click", ".location button", function() {
		var title = "모델 선택";
		var work = $(this).attr("work");
		var navigatorUrl = '';
		
		if (work == "brand") {			
			brand = $(this).attr("brand");
			
			if ($("#autodanawa_gridC .category .brandBox").html()) {
				openAutoTab('brand');
				return;
			}
			else if (gnb == 'newcar' && lnb == 'estimate') {
				if ($("#layerPopup").data('brand')) {
					brand = $("#layerPopup").data('brand');
				}
				
				getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=brand&Type=buy&Brand='+brand, 'layerPopup .g-layer__cont');
				openLayerPopup('popup', '브랜드 선택');
				return;
			}
			else if (gnb == 'leaserent' && lnb == 'priceCompare') {
				if ($("#layerPopup").data('brand')) {
					brand = $("#layerPopup").data('brand');
				}
				
				getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=brand&Type=buy&Brand='+brand+'&refer=leaserentSimpleEstimate', 'layerPopup .g-layer__cont');
				openLayerPopup('dim', '브랜드 선택');
				return;
			}
			else {

			}
		}
		else if (work == "segment") {
			brand = $(".location button[work='brand']").attr("brand");
			segment = $(this).attr("segment");
			
			getHttprequest('/service/navigatorNewcar.php?Work=segment&Type='+gnb+'&Brand=' + brand+"&Segment="+segment, 'layerPopup .g-layer__cont');
			openLayerPopup('dim', '모델 선택');
		}
		else if (work == "series") {
			brand = $(".location button[work='brand']").attr("brand");
			getHttprequest('/service/navigatorNewcar.php?Work=series&Type='+gnb+'&Brand=' + brand, 'layerPopup .g-layer__cont');
			openLayerPopup('dim', '모델 선택');
		}
		else if (work == "sales" || work == "model") {
			brand = $(".location button[work='brand']").attr("brand");
			
			if (gnb == "auto") {
				getHttprequest('/service/navigatorNewcar.php?Work=model&Type=sales&Brand=' + brand+"&refer=sales&tab="+$("#autodanawa_gridC .gridLeft .tabs li.on").attr("tab"), 'layerPopup .g-layer__cont');
				openLayerPopup('dim', '모델 선택');
			} else if (gnb=="leaserent" && lnb == 'priceCompare') {
				getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=model&Type=estimate&Brand=' + brand + '&refer=leaserentSimpleEstimate', 'layerPopup .g-layer__cont');
				openLayerPopup('dim', '모델 선택');
			}
		}
		
	});

	// 2311 신차 검색 파인더 더보기 버튼
	$(document).on("click", "#newcarFinder .box__brandmore .button__more", function() {
		$("#newcarFinder .box__brandmore .button__more").text('접기');
		$("#newcarFinder .row.brand .itembox").addClass('open');
		$("#newcarFinder .box__brandmore .button__more").addClass('open');	
	});
	
	// 2311 신차 검색 파인더 접기 버튼
	$(document).on("click", "#newcarFinder .box__brandmore .button__more.open", function() {
		$("#newcarFinder .box__brandmore .button__more.open").text('더보기');
		$("#newcarFinder .row.brand .itembox.open").removeClass('open');
		$("#newcarFinder .box__brandmore .button__more.open").removeClass('open');	
	});
	
	// 2311 신차 판매 조건 /실적 파인더 더보기 버튼
	$(document).on("click", "#finder_newcar .box__brandmore .button__more", function() {
		$("#finder_newcar .box__brandmore .button__more").text('접기');
		$("#finder_newcar .brand .main").addClass('open');
		$("#finder_newcar .box__brandmore .button__more").addClass('open');	
	});
	
	// 2311 신차 판매 조건 /실적 파인더 접기 버튼
	$(document).on("click", "#finder_newcar .box__brandmore .button__more.open", function() {
		$("#finder_newcar .box__brandmore .button__more.open").text('더보기');
		$("#finder_newcar .brand .main").removeClass('open');
		$("#finder_newcar .box__brandmore .button__more.open").removeClass('open');	
	});

	// 2204 파인더 개선
	$(document).on("click","#layerPopup .classify__tab li",function(){
		var work = $(this).data("work");
		var brand = $("#layerPopup").data('brand');

		if (work == "segment") {
			getHttprequest('/service/navigatorNewcar.php?Work=segment&Type='+gnb+'&Brand=' + brand + "&tab="+tab, 'layerPopup .g-layer__cont');
		}
		else if (work == "series") {
			getHttprequest('/service/navigatorNewcar.php?Work=series&Type='+gnb+'&Brand=' + brand + "&tab="+tab, 'layerPopup .g-layer__cont');
		}
		else if (work == "sales") {
			getHttprequest('/service/navigatorNewcar.php?Work=model&Type=sales&Brand=' + brand+"&refer=sales" + "&tab="+tab, 'layerPopup .g-layer__cont');
		}
		
		openLayerPopup('dim', '모델 선택');
		return;
		
	});
	
	// 2204 파인더 개선
	$(document).on("click","#layerPopup .classify__list li:not('.dis')",function(){
		var brand = $("#layerPopup").data('brand');
		var work = $("#layerPopup .classify__list").data('work');
		var series = $(this).data("series");
		var segment = $(this).data("segment");
		
		if (work == 'series') {
			if (series) {
				getHttprequest('/service/navigatorNewcar.php?Work=model&Type='+gnb+'&Brand='+brand+"&Series="+series + "&tab="+tab, 'layerPopup .g-layer__cont');
				openLayerPopup('dim', '모델 선택');
				return;
			}
		} else if (work == 'segment') {
			getHttprequest('/service/navigatorNewcar.php?Work=model&Type='+gnb+'&Brand=' + brand+'&Segment=' + segment + "&tab="+tab, 'layerPopup .g-layer__cont');
			openLayerPopup('dim', '모델 선택');
			return;
		}
		
	});

	// 모델비교하기 > 세부모델변경
	$(document).on("click","#popup_data .lineupList a",function(){
		model = $(this).attr("model");
		lineup = $(this).attr("lineup");
		box = estmAct;

		if (gnb=="compare") {
			getHttprequest('/service/navigator.php?Work=trims&Type=compare&Model='+model+'&Lineup='+lineup, 'popup_data');

			var code = $("#Photo_"+box).attr("code");
			var model = code.substring(3,7);
			var lineup = code.substring(7,12);
			var trims = code.substring(12);
			
			$("#popup_data button[trims='"+trims+"']").parent().addClass("on");
			
			openPopup("세부모델 선택",520,'');
		}
	});
	
	// 모델비교하기 > 세부모델변경
	$(document).on("click","#popup_data .navigator button",function(event){
		var work = $(this).attr("work");

		if (gnb == "compare") {
			if (work == "lineup") {
				var model = $(this).attr("model");
				
				lineup = $(this).attr("lineup");
				navigatorUrl = '/service/navigator.php?Work=lineup&Type=compare&Model='+model+'&Lineup='+lineup;
				getHttprequest(navigatorUrl, "popup_data");
				
				if (lineup) {
					$("#popup_data button[lineup='"+lineup+"']").parent().addClass("on");
				}
				
				openPopup("세부모델 변경", 540, '');
			}
		}
	});
	
	// 모델비교하기 > 트림 선택
	$(document).on("click","#popup_data .trimsList button",function(){
		code = $(this).attr("trims");
		
		if (gnb == "compare") {
			var box = estmAct;
			
			$("#autodanawa_popup .close").click();
			
			getCompData(box,code);
			arrangeCompBox();
		}
	});
	
	// 백과 LNB (브랜드)
	$(document).on("click","#autodanawa_gridC ul.category .brandList li",function(){
		brand = $(this).data("brand");
		
		location = "/auto/?Work=brand&Brand="+brand;
	});
	
	// 백과 LNB (세그먼트)
	$(document).on("click","#autodanawa_gridC ul.category .segmentList li", function() {
		brand = $(".location button[work='brand']").attr("brand");
		segment = $(this).data("segment");
		
		if (!$(this).hasClass('dis')) {
			location = "/auto/?Work=segment&Brand="+brand+"&Segment="+segment;
		}
	});
	
	// 백과 LNB (모델)
	$(document).on("click","#autodanawa_gridC ul.category .modelList li", function() {
		model = $(this).data("model");
		location = "./?Work=model&Model="+model;
	});
	
	// 신차 파인더 검색 실행 
	$(document).on("click","#finder_newcar .brandList li", function() {
		if($(this).hasClass("on")) {
			$(this).removeClass("on");
		}
		else {
			$(this).addClass("on");
			
			var brandCode = $(this).data("brand");
			var brandName = $(this).find("span").text();
			
			// UXLOG 로깅
			sendUXLOG("P17004",{"option":"렌트리스리스트_검색옵션_브랜드", "brand":brandCode, "brandName":brandName});
		}
		finderNewcar();
	});
	
	// 신차 파인더 전체선택
	$(document).on("click","#finder_newcar .main input[type='checkbox']", function() {
		var cls = $(this).parent().parent().attr("class");
		
		if ($(this).is(":checked")) {
			$("#finder_newcar .main ."+cls+" li").addClass("on");
			
			var country = $('label[for='+this.id+']').text();
			
			sendUXLOG("P17004",{"option":"렌트리스리스트_검색옵션_국가", "country":country});
		}
		else {
			$("#finder_newcar .main ."+cls+" li").removeClass("on");
		}
		
		finderNewcar();
	});	
	
	/* 신차 색상선택 */
	$(document).on("mouseover",".modelColor button", function() {
		colr = $(this).attr("color");
		titl = $(this).find("span").text();
		phot = $(this).closest("div .photo").attr("photo");
		
		$(".modelColor .this").text(titl);
		
		$(".modelColor button").each(function() {
			$(this).removeClass("on");
		});
		
		$(this).addClass("on");
		$(".modelSummary .photo img").attr("src","//autoimg.danawa.com/photo/"+phot+"/color_"+colr.substring(1)+"_360.png");
	});

	/* 신차 파인더 차종 UXLOG 로깅 */
	$(document).on("click","#finder_newcar #classifyFinder input[type='checkbox']", function() {
		if ($(this).is(":checked")) {
			var classify = $('label[for="'+this.id+'"]').text();
			sendUXLOG("P17004",{"option":"렌트리스리스트_검색옵션_차종", "classify":classify});
		}
		finderNewcar();
	});

	
	/* 렌트리스 연료 체크 */
	$(document).on("click","#finder_newcar .fueltype li", function() {
		if ($(this).children('input').is(':checked')) {
			$(this).children('input').prop('checked', false);
		}
		else {
			$(this).children('input').prop('checked', true);
		}

		finderNewcar();
	});
	
	/* 렌트리스 정렬 체크 */
	$(document).on("click","#rentleaseSortType li", function() {
		if(!$(this).hasClass('select')) {
			$(this).closest('ul').find('li').removeClass('select');
			$(this).addClass('select');
			
			finderNewcar();
		}
	});
	
	/* 렌트리스 검색 키워드 체크 */
	$(document).on("keydown", "#leaserentSearchKeyword", function(key) {
		if(key.keyCode == 13) {
			$("#leaserentSearchedKeyword").val($("#leaserentInputSearchKeyword").val());
			finderNewcar();
		}
	});
	$(document).on("click", "#leaserentSearchButton", function() {
		$("#leaserentSearchedKeyword").val($("#leaserentInputSearchKeyword").val());
		finderNewcar();
	});
	
	/* 렌트리스 punit 개수 선택 체크 */
	$(document).on("change", "#leaserentListCount", function() {
		finderNewcar();
	});
	
	/* 렌트리스 최저금액 선택 체크 */
	$(document).on("click", "#leaserentPriceRangeBtn", function() {
		$("#leaserentSelectedMinPrice").val($("#leaserentRangeMinPrice option:selected").val());
		$("#leaserentSelectedMaxPrice").val($("#leaserentRangeMaxPrice option:selected").val());
		finderNewcar();
	});

	/* 신차 파인더 검색 실행 */		
	// 20190523 mjmjmjmj91@danawa.com 렌트리스 개편 > 검색조건 클릭 시 수행 추가		
	$(document).on("click",".row_rent li, .row_period li, .row_pay li",function(){		
		var btnElement = $(this).parent().find('li');		
		btnElement.removeClass('select');		
		$(this).addClass('select');

		// UXLOG 로깅
		var nUxid = "";
		
		if(lnb == "leaserentSearch") {
			var optionValue = $(this).data('value');
			nUxid = "P17004";
			
			if($(this).parent().parent().parent().hasClass("row_period") == true) {
				sendUXLOG(nUxid,{"option":"렌트리스리스트_검색옵션_이용기간", "month":optionValue});
			}
			else {
				if(optionValue == 3) optionValue = "보증금30%"
				else if(optionValue == 2) optionValue = "선납금 30%"
				else optionValue = "0%";
				
				sendUXLOG(nUxid,{"option":"렌트리스리스트_검색옵션_결제종류", "paytype":optionValue});
			}
		} else if(lnb == "priceCompare") {
			var optionValue = "";
			nUxid = "P17005";
			
			if($(this).parent().parent().parent().hasClass("row_rent") == true) { // 렌트리스 선택
				optionValue = $(this).data('prodtype');
				sendUXLOG(nUxid,{"option":"렌트리스상품블로그_검색옵션_렌트리스", "prodtype":optionValue});
			}
			else if($(this).parent().parent().parent().hasClass("row_period") == true) { // 이용기간 선택
				optionValue = $(this).data('month');
				sendUXLOG(nUxid,{"option":"렌트리스상품블로그_검색옵션_이용기간", "month":optionValue});
			}
			else { // 보증금*선납금 선택
				optionValue = $(this).data('pricetype');
				
				if(optionValue == 3) optionValue = "보증금30%"
				else if(optionValue == 2) optionValue = "선납금 30%"
				else optionValue = "0%";
				
				sendUXLOG(nUxid,{"option":"렌트리스상품블로그_검색옵션_결제종류", "paytype":optionValue});
			}
		} else if(lnb == "mediumTermSearch") {
			optionValue = $(this).data('value')+'개월';
			
			sendGA('이용기간',optionValue);
		}
				
		finderNewcar();		
	});		
			
	// 20190523 mjmjmjmj91@danawa.com 렌트리스 개편 > 리스트 내 레이어 바깥 클릭 시 off		
	$(document).mousedown(function(e) {		
		var container = $(".mib_layer"); //레이어
		
		if (container.has(e.target).length === 0 && e.target.parentNode.id.indexOf('trimView') != false) {
			if (container.parent().hasClass('on')) {
				var currentLayerId = $(".mib_layer:visible").attr("id").replace('layer', '');
				
				$('div#trimView').each(function() {
					if($(this).attr('name') == currentLayerId) {
						$(this).find('button').focus();
					}
				});
				
				$(".btn_wrap").removeClass('on');		
			}		
		}		
	});
	
	// 시판중인 모델 on/off
	$(document).on("click","div.updownBar button, div.updownBar h4", function() {		
		var btnElement = $(this).parent().find('button');
		
		// 신차 구매상담 모델선택시 추가버튼 사라짐 방지조건 
		if (btnElement.hasClass('btnPutChoice')) {
			return false;
		}
		
		if (btnElement.hasClass("on")) {
			btnElement.removeClass("on");
			btnElement.addClass("off");
			btnElement.next().removeClass("on");
			btnElement.next().addClass("off");
		}
		else {
			btnElement.removeClass("off");
			btnElement.addClass("on");
			btnElement.next().removeClass("off");
			btnElement.next().addClass("on");
		}
	});
	
	// 팝업창 라인업/트림 on/off
	$(document).on("click",".sales.updownBar h4",function(){
		if($(this).hasClass("on")){
			$(this).removeClass("on");
			$(this).next().removeClass("on");
			$(this).next().addClass("off");
		}else{
			$(this).addClass("on");
			$(this).next().removeClass("off");
			$(this).next().addClass("on");
		}
	});

	// 라인업 on/off
	$(document).on("click",".selectBar h3 button",function(e){
		$(this).parent().addClass("on");
		var subject = $(this).attr("subject")+" 선택";
		$("#help_data").html($(".listSelect").html());
		openHelp(subject,500,'.buttonSelect' , 40);
	});
	
	// 라인업 on/off
	$(document).on("click", '#buttonSelect', function(){
		$("#layerPopup .g-layer__cont").empty().html($("#listSelect").html().replace(/\"lineup_/gi,"\"popuplineup_"))
		openLayerPopup('popup', '라인업변경');

		$("#popup"+$("input[id^='lineup_']:checked").attr('id')).attr('checked', 'checked');
		sendGA('라인업/트림 변경', '라인업/트림 변경')
		return false;
	});
	
	// 견적 랭킹 개월수 변경
	$(document).on("change", ".estmRankDate", function(){
		var days = $(this).val();
		getHttprequest("/service/ajax_estmRank.php?Days=" + days, "estmRankBox");
	});
	
	
	//비교하기
	$(document).on("click", "input[name='compItemCk']" ,function(){
		var count = 0;
		if($(this).is(":checked")) {
			var count =	$('#compareCont').find("li").length+1;
		} else {
			var count =	$('#compareCont').find("li").length-1;
		}
		
		var temp = $(this).attr("value");
		var code = temp.split("_");  //code[0] 타입(record, tirms , newcar) code[1] 분류값
		
		//트림비교인경우는 따로
		if(code[0] == 'trims') {
			var name = $(this).attr("trimName");
			var nameContent = "<div class='nameT'>"+$(this).attr("trimNameT")+"</div>";		
			var img = "<div class='photo'><img onerror='imageError(this,\"model_200_100.png\")' src='//autoimg.danawa.com/photo/"+$(this).attr("model")+"/"+$(this).attr("photo")+"/lineup_200.png' alt='" + name +"'></div>";
		} else {
			var name = $(this).attr("title"); //이름
			var nameContent ='';
			if(code[1].length >= 4) {
				var img = "<div class='photo'><img onerror='imageError(this,\"model_200_100.png\")' src='//autoimg.danawa.com/photo/"+code[1]+"/model_200.png'' alt='" + name +"'></div>";
			} else {
				var img = "<div class='logo'><img onerror='imageError(this,\"model_200_100.png\")' src='//autoimg.danawa.com/photo/brand/"+code[1]+"_90.png'' alt='" + name +"'></div>";
			}
		}	
		
		//실적비교인경우 분기
		if(code[0] == 'record') {
			var index = 5;

			$("#compareSubmit").attr('val',"record");
			$("#compareSubmit").html("실적 비교");
		} else {
			var index = 10;

			$("#compareSubmit").attr('val',"model");
			$("#compareSubmit").html("모델 비교");
		}
		//선택
		if(count >index) {
			alert("비교는 "+index+"개까지만 가능합니다. ");
			$(this).attr("checked",false);
			
		} else if(count <= 0) {
			$("#compareCont").html('');
			$("#autodanawa_compare").hide();
			
		} else {
			$("#compareCont").attr("type",code[0]);
			
			if($(this).is(":checked")) {
				var content = "<li class='li' val='"+ code[1] +"'>"+
								img +
								"<div class='nameL'><label><input type='checkbox' name='compboxCk' value='"+temp+"' checked=''>"+ name +"</label></div>"+ nameContent +
								"<button type='button' class='compareDel' val='"+code[1]+"'><span class='screen_behind'>삭제</span></button>"+
								"</li>";
				
				$("#compareCont").append(content);
				$("."+temp).attr("checked",true);
			} else {
				$("#compareCont li[val='"+code[1]+"']").remove();
				$("."+temp).attr("checked",false);
			}
			
		
			$("#autodanawa_compare").show();
		}
	});

	//비교 삭제하기
	$(document).on("click", '#compareCont button.compareDel', function(){
		$(this).parent().remove();
		var type = $("#compareCont").attr("type");
		var code = $(this).attr("val");
		$("input[value='"+type+"_"+code+"']").attr("checked",false);

		if($("input[name='compItemCk']:checked").length <= 0) {
			$("#autodanawa_compare").hide();
		}
	});

	//비교 전체삭제
	$(document).on("click", '#compareWholeDel', function() {
		$("#compareCont").html('');
		$("#autodanawa_compare").hide();
		$("input").attr("checked",false);
	});
	
	$("#compareClose").toggle(function(){
		$("#autodanawa_compare .main").hide();
		$("#compareClose span").text("펼치기");
		$("#compareClose").addClass("open");
	},function(){
		$("#autodanawa_compare .main").show();
		$("#compareClose span").text("접기");
		$("#compareClose").removeClass("open");
	});

	
	//비교 클릭
	$(document).on("click", "#compareSubmit", function() {
		if($("#compareCont input[name='compboxCk']:checked").length > 0){
			
			var type = $(this).attr("val");
			var temp ='';
			var carCompare ='';
			
			$("#compareCont input[name='compboxCk']:checked").each(function(){
				temp = $(this).attr("value").split("_");
				if(type == 'record') {
					carCompare += temp[1] + ',';
				}else if(type =='model') {
					carCompare += temp[1] + '@';
				}
			})
			if(type == 'record') {
				var separation = $("input:checkbox[name='compItemCk']:checked").attr("value").split("_"); //레코드인경우 모델인지 브랜드인지 구분
				var month = '';
				if($("#selMonth option:selected").length > 0) {
					month = $("#selMonth option:selected").val()+"-"+$("#selDay option:selected").val()+"-00";	
				}
				else {
					var settingDate  = new Date();
					settingDate.getFullYear();
					settingDate.getMonth();
					month = settingDate.getFullYear() + '-' + settingDate.getMonth() + '-00';
				}
				
				if (separation[1].length == 3) {
					getHttprequest("/service/ajax_recordCompare.php?type=brand&brand="+carCompare + "&month=" + month,'popup_data');
				}
				else if(separation[1].length == 4) {
					getHttprequest("/service/ajax_recordCompare.php?type=model&model="+carCompare + "&month=" + month,'popup_data');					
				}
				
				openPopup("판매 실적 비교", 840, '');
			}else if(type =='model') {
				sendGA('모델비교','비교 페이지 이동')
				
				window.open("/compare/?Codes=" + carCompare);
			}
		}
	});
	
	// 사양/제원 표 접고 펼치기 (셀렉터변경 id로)
	$(document).on("click",".spreadTable",function(){});
	
	// 히스토리 더보기
    $(".show-more").click(function () {
        if($(this).parent().find(".explain").hasClass('more')){
        	$(this).text('펼치기');
        }else{
        	$(this).text('접기');
        }
        $(".brandSummary .explain").toggleClass('more');
    });
    
    // 견적으로 이동하기
    $(document).on("click",".goEstimate",function(){
    	var model = $(this).prev().attr("model");
    	var trims = $(this).prev().attr("code");
    	var itms = $(this).prev().attr("itms");
    	
    	sendGA('견적 다시 내기', trims);
    	window.open("/buy/?Work=estimate&Model="+model+"&Trims="+trims+"&Conf="+itms, "_blank");
	});
    
    // 견적으로 이동하기
    $(document).on("click",".newEstimate",function(){
    	var model = $(this).prev().attr("model");
    	var trims = $(this).prev().attr("code");
    	var itms = $(this).prev().attr("itms");
    	window.open("/buy/?Work=estimate&Model="+model+"&Trims="+trims+"&Conf="+itms, "_blank");
	});

    $(document).on("click", ".printBtn", function(){
		var W=document.documentElement.clientWidth; if(!W){W=document.body.clientWidth;}
		var H=document.documentElement.clientHeight; if(!H){H=document.body.clientHeight;}
		
		var features = "menubar=yes,toolbar=yes,location=no,directories=no,status=no,scrollbars=yes,resizable=yes,width=" + W + ",height=" + H + ",left=0,top=0";
		var PrintPage = window.open("about:blank","tmp_print",features);
		PrintPage.document.open();
		PrintPage.document.write("<!DOCTYPE html><html lang='ko'><head><title></title>");
		PrintPage.document.write("<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />");
		PrintPage.document.write("<link rel=\"stylesheet\" type=\"text/css\" href=\""+webUrl+"/style/common.css\" />");
		PrintPage.document.write("<link rel=\"stylesheet\" type=\"text/css\" href=\""+webUrl+"/style/auto.css\" />");
		PrintPage.document.write("<style>.pagePrint{border-top:1px solid #666;border-left:1px solid #666} .pagePrint thead th,.pagePrint thead td{background:#eee;font-weight:bold;text-align:center} .pagePrint th,.pagePrint td{padding:3px 5px;border-bottom:1px solid #666;border-right:1px solid #666;font-size:11px} .pagePrint .index td,.pagePrint .index2 td{padding:0;border:0} .goEstimate{display:none} .popup_title_model{border-bottom:0} .model_data_head.fixed{position:relative;overflow-x:visible;} .model_data_head.fixed .row ul > li.title{position:absolute;left:0} .model_data_body{margin-top:0 !important;overflow-x:visible}");
		PrintPage.document.write(" @media print{.pagePrint{border-top:1px solid #666;border-left:1px solid #666} .pagePrint thead th,.pagePrint thead td{background:#eee;font-weight:bold;text-align:center} .pagePrint th,.pagePrint td{padding:3px 5px;border-bottom:1px solid #666;border-right:1px solid #666;font-size:11px} .pagePrint .index td,.pagePrint .index2 td{padding:0;border:0} .goEstimate{display:none}}</style>");
		PrintPage.document.write("</head>");
		PrintPage.document.write("<body>" + $(".popup_title_model").clone().wrapAll("<div/>").parent().html() + " " + $("#printTable").clone().wrapAll("<div/>").parent().html() + "</body></html>");
		PrintPage.document.close();
	});
    
    //2019.04.23 mjmjmjmj91@danawa.com 정보제공동의 확인버튼
	$("#provide").on("click", function(){
	 	if (!$("#provide").hasClass("on")) {
	 		$("#provide").addClass("on");
	 	}
	 	else {
	 		$("#provide").removeClass("on");
	 	}
	});

	$("#collection").on("click", function(){
	 	if (!$("#collection").hasClass("on")) {
	 		$("#collection").addClass("on");
	 	}
	 	else {
	 		$("#collection").removeClass("on");
	 	}
	});
    
    if (gnb == 'home') {
    	
    	/* 탭 조절 설정 */
    	tabIntObj = new Array();	// 주기 객체
    	tabIntSet = new Array();	// 주기 설정

    	tabIntSet['home_banner'] = 5000;

    	$(window).load(function(){
    		
    		tabRotateControl('home_banner', Math.floor((Math.random() * 4) + 1));
        	tabRotateStart('home_banner');

        	// 중고차 핫이슈 매물 랜덤노출
        	if ($(".home_usedcar ul li").length > 4) {
        		var aShowLi = [];
        		
        		while (aShowLi.length < 4) {
        		    var randomnumber = Math.ceil(Math.random() * ($(".home_usedcar ul li").length-1));
        		    
        		    if (aShowLi.indexOf(randomnumber) > -1) continue;
        		    
        		    aShowLi[aShowLi.length] = randomnumber;

        		    $(".home_usedcar ul li:eq("+randomnumber+")").removeClass("off");
        		}

        		
        		$(".home_usedcar").removeClass("off");
        		$(".home_usedcar ul li.off").remove();
        	}
        	
    		
    		// 커뮤니티,뉴스 10개이상 노출
    		$(".sideUl .sideList li").show();

    		$(".home_request .request_btn.rent").click(function() {
				openAutoTab('brandEstimateForLeaserent');
    	    });
    	});
    	
    	// 마우스 over
    	$(document).on("mouseenter", ".homeTheme .topic button", function() {
	    	var setTheme = $(this).parent().parent().parent().parent().attr("themeSet");
	    	
	    	if (!$(this).parent().hasClass("on")) {
	    		var them = $(this).parent().attr("theme");
	    		
	    		themeMainChange(setTheme,them);
	    	}
	    });

    	// 탭 포커스
    	$(document).on("focus", ".homeTheme .topic button", function() {
    	    var setTheme = $(this).parent().parent().parent().parent().attr("themeSet");
    	    
    	    if (!$(this).parent().hasClass("on")) {
    	    	var them = $(this).parent().attr("theme");
    	    	
    	    	themeMainChange(setTheme,them);
    	    }
    	});
    	
    	// 마우스 over
    	$(document).on(
    		"mouseenter",
    		".home_banner",
    		function ()
    		{
    	      	var thms = $(this).attr("id");
    	      	
    	      	tabRotateStop(thms)
    	    }
    	);

    	// 마우스 out
    	$(document).on(
    		"mouseleave",
    		".home_banner",
    		function ()
    		{
    	      	var thms = $(this).attr("id");
    	      	
    	      	tabRotateStart(thms);
    	    }
    	);
    	
    	//이전 다음 // 뉴스에도 동일한 것 사용함
    	$(document).on(
    		"click",
    		"#homeSlider button[name='hsArrow']",
    		function ()
    		{
    	    	var type = $(this).attr('val');
    	    	var cPage = $(this).siblings(".page").find('button.on').attr('page');
    	    	var maxPage = $(this).siblings(".page").find('button[name=cPage]').length;
    	    	var changePage;
    	    	
    	    	$(this).siblings(".page").find('button[name=cPage]').removeClass('on');
    	    	$(this).parent().find('.theme .cont:eq('+ cPage +')').removeClass('on');
    	    	
    	    	if (type == "next") {
    	    		changePage = parseInt(cPage) + 1;
    	    		
    	    		if (changePage + 1 > maxPage) {
    	    			changePage = 0;
    	    		}
    	    	}
    	    	else if (type == 'prev') {
    	    		changePage = parseInt(cPage) - 1;
    	    		
    	    		if (changePage - 1 > 0) {
    	    			changePage = maxPage;
    	    		}
    	    	}
    	    	
    	    	$(this).siblings(".page").find('button[name=cPage]:eq('+ changePage +')').addClass('on');
    	    	$(this).parent().find('.theme .cont:eq('+ changePage +')').addClass('on');
    	    }
    	);

    	$(document).on(
    		"click",
    		"#homeSlider .page button[name='cPage']",
    		function ()
    		{
    	    	var cPage = $(this).attr('page');;
    	    	
    	    	$(this).siblings("button[name='cPage']").removeClass('on');
    	    	$(this).parent().parent().find('.theme .cont').removeClass('on');
    	    	
    	    	$(this).addClass('on');
    	    	$(this).parent().parent().find('.theme .cont:eq('+ cPage +')').addClass('on');
    	    }
    	);
    	
		$('#crazyDaysNever').toggle(
	    	function ()
	    	{
	    		$(this).attr('val' , 'true');
	    		$("#crazyDaysNever .check").removeClass("off");
	    	},
	    	function ()
	    	{
	    		$(this).attr('val' , 'false');
	    		$("#crazyDaysNever .check").addClass("off");
	    	}
	    );
	    
	    //이전 다음 // 금주의 차 사용
	    $(document).on(
	    	"click",
	    	".home_slider button[name='hsArrow']",
	    	function ()
	    	{
	        	var type = $(this).attr('val');
	        	var cPage = $(this).siblings(".page").find('button.on').attr('page');
	        	var maxPage = $(this).siblings(".page").find('button[name=cPage]').length;
	        	var changePage = 0;
	        	
	        	$(this).siblings(".page").find('button[name=cPage]').removeClass('on');
	        	$(this).parent().find('.slide > li:eq('+ cPage +')').removeClass('on');
	        	
	        	if (type == "next") {
	        		changePage = parseInt(cPage) + 1;
	        		
	        		if (changePage + 1 > maxPage) {
	        			changePage = 0;
	        		}
	        	}
	        	else if (type == 'prev') {
	        		changePage = parseInt(cPage) - 1;
	        		
	        		if (changePage < 0) {
	        			changePage = maxPage - 1;
	        		}
	        	}
	        
	        	$(this).siblings(".page").find('button[name=cPage]:eq('+ changePage +')').addClass('on');
	        	$(this).parent().find('.slide > li:eq('+ changePage +')').addClass('on');
	        	
	        	$("img.lazyload").lazyload();
	        }
	    );
	    
	    $(document).on(
	    	"click",
	    	".home_slider .page button[name='cPage']",
	    	function ()
	    	{
	        	var cPage = $(this).attr('page');
	        	
	        	$(this).siblings("button[name='cPage']").removeClass('on');
	        	$(this).parent().parent().find('.slide > li').removeClass('on');
	        	
	        	$(this).addClass('on');
	        	$(this).parent().parent().find('.slide > li:eq('+ cPage +')').addClass('on');
	        	
	        	$("img.lazyload").lazyload();
	        }
	    );
    	
    	$(document).on(
			'click',
			'#crazyDaysClose',
			function ()
			{
		    	var check = $("#crazyDaysNever").attr('val');
		    
		    	if (check == 'true') {
		    		$.cookie('crazyDaysEvent', '1', {expires:1, path:'/', "domain":".auto.danawa.com"});
		    	}
		    	
		    	$("#event_crazy").addClass("off");
		    }
		);
	    
	    // 삭제 필요
	    if($("#homeHotissue .mc_item").length >= 9) {
	    	$("#autoHotissueSwipe").show();
	    }
	    
	    // 오늘의 핫이슈 왼쪽 오른쪽 버튼 이벤트
	    $(document).on('click', "#autoHotissueSwipe #btnPrev, #btnNext", function() {
	    	var numTagSetting = '';
	    	
	    	if($(this).get(0).id == "btnPrev") {
	    		numTagSetting = '<em class="current"><span class="blind">현재</span>1</em><span class="blind">전체</span>/2';

				$('#homeHotissue #mc_list_top').css('display', 'block');
				$('#homeHotissue #mc_list_bottom').css('display', 'block');
				
				$('#homeHotissue #mc_list2_top').css('display', 'none');
				$('#homeHotissue #mc_list2_bottom').css('display', 'none');	    		
	    	} else if($(this).get(0).id == "btnNext") {
	    		numTagSetting = '<span class="blind">현재</span>1/<em class="current"><span class="blind">전체</span>2</em>';

				$('#homeHotissue #mc_list_top').css('display', 'none');
				$('#homeHotissue #mc_list_bottom').css('display', 'none');
				
				$('#homeHotissue #mc_list2_top').css('display', 'block');
				$('#homeHotissue #mc_list2_bottom').css('display', 'block');	    		
	    	} else {}
	    	
	    	$('#homeHotissue #autoHotissueSwipeNum').html(numTagSetting);
	    });
	    
	    // 헤더 메뉴 GA
	    $(document).on('click', "#gnbMenu .gnb__list .item", function() {
	    	sendGAExcpt('GNB',$(this).first().text(),'');
	    });
	    
	    // 헤더 서브메뉴 GA
	    $(document).on('click', "#gnbMenu .gnb__list .snb__item, #gnbMenu .gnb__list .gnb__banner", function() {
	    	if($(this).hasClass("gnb__banner")) {
	    		sendGAExcpt('GNB',$(this).closest(".gnb__col").find("span.blind").first().text(),'배너');
	    	} else {
	    		sendGAExcpt('GNB',$(this).closest(".gnb__col").find("span.blind").first().text(),$(this).text());
	    	}
	    });
	    
	    // 오늘의 핫이슈 GA
	    $(document).on('click', "#homeHotissue .mc_list", function() {
	    	if($(this).attr('id') == 'mc_list_top' || $(this).attr('id') == 'mc_list_bottom') {
	    		sendGA('오늘의 핫이슈','1P');
	    	} else {
	    		sendGA('오늘의 핫이슈','2P');
	    	}
	    });
	    
	    $(document).on('click', ".home_hotissue .contents .large", function() {
	    	sendGA('오늘의 뉴스','배너');
	    });
	    
	    $(document).on('click', ".home_hotissue .contents .type_txt", function() {
	    	sendGA('오늘의 뉴스','기사');
	    });
	    
	    $(document).on('click', ".home_weekcar", function() {
	    	sendGA('금주의 차','');
	    });
	    
	    $(document).on('click', ".home_puredrive .more, .home_puredrive li>a", function() {
	    	sendGA('퓨어드라이브','');
	    });
	    
	    $(document).on('click', ".home_usedcar .more, .home_usedcar li>a", function() {
	    	sendGA('중고차','');
	    });
	    
	    $(document).on('click', ".home_news .more, .home_news li>a", function() {
	    	if($(this).closest("div").parent().find(".title").text().indexOf("시승") != -1) {
	    		sendGA('시승기','');
	    	} else {
	    		sendGA('기획/칼럼','');
	    	}
	    });
	    
	    $(document).on('click', ".domesticBrandRecord li>a", function() {
	    	sendGA('국산 판매실적','');
	    });
	    
	    $(document).on('click', ".exportBrandRecord li>a", function() {
	    	sendGA('수입 판매실적','');
	    });
	    
	    $(document).on('click', ".home_movie li>a", function() {
	    	sendGA('신차동영상','');
	    });
	    
	    $(document).on('click', ".home_gallery li>a", function() {
	    	sendGA('갤러리','');
	    });
	    
	    $(document).on('click', ".home_catalog li>a", function() {
	    	sendGA('카탈로그','');
	    });
	    
	    $(document).on('click', ".home_compare a", function() {
	    	sendGA('하단가로배너','');
	    });
	    
	    $(document).on('click', ".home_model li>a", function() {
	    	if($(this).closest("div").parent().find(".title").text().indexOf("국산차") != -1) {
	    		sendGA('국산차견적요청','');
	    	} else {
	    		sendGA('수입차견적요청','');
	    	}
	    });
	    
	    // side GA
	    $(document).on('click', ".newsList div[name=twoKinds]", function() {
	    	if($("ul[name=tabFocus] li").eq(0).hasClass("on")) {
	    		sendGA('뉴스','인기글');
	    	} else {
	    		sendGA('뉴스','최신글');
	    	}
	    });
    }
    // 백과 스크립트 통합  2018.03.28
    else if (gnb == 'auto') {
    	
    	// 판매조건 서브 모델 클릭
		$('.recordTable button[name="sub_model_sel"]').toggle(function(){
			$(this).addClass('open');
			$('.model_' + $(this).attr('model')).addClass('open');
		},function(){
			$(this).removeClass('open');
			$('.model_' + $(this).attr('model')).removeClass('open');
		});
		
		// 월/기간 선택 활성/비활성
		$(document).on("click","#monthPeriodDiv input:radio[name='rdoMonthPeriod']", function(){
			$("#monthPeriodDiv").find("select, option, input:button").prop("disabled", "disabled");
			$(this).parent().parent().find("*").prop("disabled", "");
			$(".select").toggleClass( "disabled" )
		});
		
		//모델 그래프
		$(document).on('click', '.recordTable button[name="viewGraph"]', function(){
			var brand = $(this).attr("brand");
			var month = '';
			if($("#selMonth option:selected").length > 0) {
				month = $("#selMonth option:selected").val()+"-"+$("#selDay option:selected").val()+"-00";
			}else {
				
				var d = new Date();
				var y = m =  '';
				
				y = d.getFullYear();
				m = d.getMonth() + 1;
				
				if (m < 10) {
					if (m == 1) {
						y = y-1;
						m = 12;
					}
					else {
						m = '0'+(m-1);
					}
				}
				month = y + "-" + m + "-00";
			} 
			
			getHttprequest("/service/ajax_modelSales.php?model="+ $(this).attr("val") + '&brand=' + brand + "&month=" + month, 'popup_data');
			openPopup("판매량 : " + $(this).parent().parent().find('.title').text(), 780, '');
		});
    	
    	if (lnb == 'brand') {
    		// 차종별 라인업 이미지 표시
    		$("#brandSegment .timeline tbody td.name a").hover(
    				// mouseover
    				function(){
    					var offset = $(this).offset();
    					$(this).attr('code');
    					$(".image").css({
    						"position":"absolute",
    						"left":offset.left-200,
    						"top":offset.top-40,
    						"z-index":999
    					}).attr("src", "//autoimg.danawa.com/photo/"+$(this).attr('code')+"/model_200.png").attr("alt", $(this).text()).show();    
    					
    				}, 
    				// mouseleave
    				function(){
    					$("#brandSegment .image").hide();
    				}
    		);
    		
    		// 판매조건 탭 (금월 / 전월)
        	$('.tabHead.sales .list li button').live('click', function () {
        		$('.tabHead.sales .list li').removeClass('on');
        		$(this).parent().addClass('on');
        	
        		if ($(this).attr('id') == 'current') {
        			$('.currentMonth').removeClass('off');
        			$('.lastMonth').addClass('off');
        		}
        		else {
        			$('.currentMonth').addClass('off');
        			$('.lastMonth').removeClass('off');
        		}
        	});
    	}
    	else if (lnb == 'model' || lnb == 'modelPopup') {    		
    		var name = $(".location button[work='model']").html();
    		var brandNm = $(".location button[work='brand']").html();
    		var model = $(".location button[work='model']").attr("model");
    		
    		var viewModel = model + ":" + brandNm + ' ' + name + "@";
    		
    		var aleadyExist = false;
    		
    		if($.cookie('myviewModel')) {
    			var myviewModel = $.cookie('myviewModel').split("@");
    			
    			for(var a =0; a < 11; a++) {
    				if(myviewModel[a]) {
    					var myarr = myviewModel[a].split(":");
    					
    					if(myarr[0] != model){
    						viewModel += myviewModel[a] + "@";
    					} else {
    						aleadyExist = true;
    					}
    				}
    			}
    			
    			if(aleadyExist == true && myviewModel[11]){
    				var lastmyarr = myviewModel[11].split(":");
    				
    				if(lastmyarr[0] != model){
    					viewModel += myviewModel[11] + "@";
    				}
    			}
    		}
    		
    		$.cookie('myviewModel', viewModel, {expires:14, path:'/', "domain":".auto.danawa.com"});
    		
    		// tab
    		if (tab == 'main') {    			
    			$(document).ready(function(){
    				// 관심모델 표시
    				var model = $(".location li:eq(4) button").attr('model');
    				
    				$.ajax({
    					type:"GET",
    					url : "/service/interest_save.php",
    					dataType : "text",
    					data : "Type=confirm&Model="+model+"&no="+$.cookie('dasysMSeq')+"&site="+$.cookie('AccessSite'),
    					contentType : "",
    					error : function(response, error) {
    						alert("다시 시도해주세요");
    					},
    					success : function(data) {
    						if(data =='be'){
    							$("button[name=interestSave]").addClass('on');
    						}
    					}
    				});
    			})
    			
    			// 관심저장
    			$(document).on("click", '#interestSave', function(){
    				if($.cookie('dasysMSeq')) {
    					var cn=$(this).attr("carname");
    					var br=$(this).attr("brand");
    					var mo=$(this).attr("model");
    					
    					$.ajax({
    						type:"GET",
    						url : "/service/interest_save.php",
    						dataType : "text",
    						data : "Type=save&Brand="+br+"&Model="+mo+"&Carname="+cn+"&no="+$.cookie('dasysMSeq')+"&site="+$.cookie('AccessSite'),
    						contentType : "",
    						error : function(response, error) {
    							alert("다시 시도해주세요");
    						},
    						success : function(data) {
    							var num = 	parseInt($("#interestNum").html());
    							
    							if(data == 'delete') {
    								alert("관심저장 삭제");
    								
    								if(num > 0) {
    									$("#interestNum").html(num - 1);
    								}
    								
    								$("#interestSave").removeClass('on');
    							}
    							else if(data =='insert') {
    								alert("관심저장 추가");
    								
    								$("#interestNum").html(num + 1);
    								$("#interestSave").addClass('on');
    							}
    							else {
    								alert("다시 시도해주세요");
    							}
    						}
    					});
    				}
    				else {
    					$("#popup_data").html("<div class='popup_login'><h3>로그인이 필요한 서비스 입니다.</h3><div class='desc'>별도의 회원가입 없이 여러분이 갖고 계신 계정(아이디)로 로그인하여 더욱 편리하게 이용하세요.</div>"+
    							"<div class='link'><buttom name='socialLogin'><img src='//autoimg.danawa.com/html/images/icon/symbol_danawa_login2.png'></buttom>"+
    							"<buttom name='socialLogin'><img src='//autoimg.danawa.com/html/images/icon/symbol_naver_login2.png'></buttom>"+
    							"<buttom name='socialLogin'><img src='//autoimg.danawa.com/html/images/icon/symbol_kakao_login2.png'></buttom>"+
    							"<buttom name='socialLogin'><img src='//autoimg.danawa.com/html/images/icon/symbol_facebook_login2.png'></buttom>"+
    					"<buttom name='socialLogin'><img src='//autoimg.danawa.com/html/images/icon/symbol_twitter_login2.png'></buttom></div></div>");
    					
    					openPopup("다나와 자동차 로그인 안내", 600, '');
    				}    				
    			});
    			
    			$(document).on("click", ".container_modelprice .button_updown", function(){
    				$(this).toggleClass("on");
    				$(this).parent().next(".price_list").children("ul").toggleClass("on");
    				
    				// URL 변경하기
    				var chageURL = location.origin+location.pathname;
    				
    				if ($(this).hasClass('on') && $(this).data('lineup')) {

    					if (location.search.indexOf('Lineup=') != -1) {
    						
    						var paramArray = location.search.split("&");
    						for ( var i in paramArray) {

        						if (paramArray[i].split("=")[0] == 'Lineup') {
        							
        							chageURL += "Lineup="+$(this).data('lineup')+"&";
        						}
        						else {
        							chageURL += paramArray[i]+"&";
        						}
    						}
    						
    						chageURL = chageURL.slice(0, -1);
    					}
    					else {
    						chageURL = location.href + "&Lineup=" + $(this).data('lineup');
    					}

    					window.history.replaceState("백과", "종합정보", chageURL);
    				}
    			});
    			
    			$(document).on("click", ".container_modelprice .price_tab button", function(){
    				$(".container_modelprice .price_tab button").removeClass("on");
    				$(this).addClass("on");
    				
    				var list = $(this).attr("value");
    				
    				$(".container_modelprice .price_contents").removeClass("on");
    				$(".container_modelprice .price_contents[data-list='"+list+"']").addClass("on");
    			});
    			
    			/** 모델 특장점 레이어 밖 영역 클릭시, 닫기 **/
    			$(document).click(function(e){
    				/** 모델 특장점 레이어가 open되어 있는 경우만 **/
    				if($(e.target).parents("#modelNoticePopup").length == 0 && $(e.target).parents("#LayerPopupNoticePosition").length == 0) {
    					if($(e.target).get(0).id != 'modelNoticePopup') {
							if($('#LayerPopupNotice').is(':visible')) {
	    						$("#LayerPopupNotice #LayerPopupNoticePosition .btn-close").trigger("click");
							}
    					}
    				}
    			});
    			
    		}
    		else if (tab == 'catalog') {    			
    			if($(".typeV").length > 0) {    				
    				var hh = $("#galleryMain").height() - 39;
    				
    				$(".typeV .thumb .list").height(hh);
    			}
    		}
    		else if(tab == "price" || tab == "spec" || tab == "item"){
    			var msie6 = $.browser == 'msie' && $.browser.version < 7;
    			
				var $modelInfo = $("#modelinfo");
				var $modelInfoLeft = $modelInfo.find(".compare__left");
				var $modelInfoRight = $modelInfo.find(".compare__right");
				var columnWidth = 160;

				if (bIsMobile) { 
					columnWidth = 130;
				}
				
				$(document).ready(function(){
					var leftHeight = 0;
					var rightHeignt = 0;

					// 폭 맞춤
					if (($modelInfo.find(".modelinfo-compare").width()-$modelInfoLeft.width()) / $modelInfoRight.find(".compare__header th").length > columnWidth) {
						if (lnb == 'modelPopup' ) {
							$modelInfoRight.find(".compare__header, .compare__body, .compare__price").css("width", $(window).width()-$modelInfoLeft.width());
						}
						else {
							if (columnWidth < ($modelInfo.find(".modelinfo-compare").width() - $modelInfoLeft.width())) {
								$modelInfoRight.find(".compare__header, .compare__body, .compare__price").css("width", $modelInfo.find(".modelinfo-compare").width()-$modelInfoLeft.width());
							}
							else {
								$modelInfoRight.find(".compare__header, .compare__body, .compare__price").css("width", ($modelInfo.find(".modelinfo-compare").width()-$modelInfoLeft.width()));
								$modelInfo.find(".btn_spread").addClass('hide');
							}
						}
					}

					// 높이맞춤 (타이틀)
					if ($modelInfoRight.find(".compare__header th").height() > $modelInfoLeft.find(".compare__header th").height()) {
						$modelInfoLeft.find(".compare__header th").height($modelInfoRight.find(".compare__header th").height());
					}
					else {
						$modelInfoRight.find(".compare__header th").height($modelInfoLeft.find(".compare__header th").height());
					}

					// 높이 맞춤 (본문)
					$.each($modelInfoLeft.find(".compare__body tbody tr"), function(index, item){
						
						leftHeight = $(this).height();
						rightHeignt = $modelInfoRight.find(".compare__body tbody tr:eq("+index+")").height();
						
						if ($modelInfoLeft.find(".compare__body tbody tr").length == $modelInfoRight.find(".compare__body tbody tr").length) {
							
		    				if (leftHeight > rightHeignt) {
		    					$modelInfoRight.find(".compare__body tbody tr:eq("+index+")").height(leftHeight)
		    					$(this).height(leftHeight)
		    				}
		    				else {
		    					$(this).height($modelInfoRight.find(".compare__body tbody tr:eq("+index+")").height())
		    					$modelInfoRight.find(".compare__body tbody tr:eq("+index+")").height(rightHeignt)
		    				}
						}
						else {
							$(this).height(leftHeight)
						}
					});
					
					// 높이 맞춤 (가격)
					$.each($modelInfoLeft.find(".compare__price tbody tr"), function(index, item){
						
						leftHeight = $(this).height();
						rightHeignt = $modelInfoRight.find(".compare__price tbody tr:eq("+index+")").height();
						
						if ($modelInfoLeft.find(".compare__price tbody tr").length == $modelInfoRight.find(".compare__price tbody tr").length) {
							
		    				if (leftHeight > rightHeignt) {
		    					$modelInfoRight.find(".compare__price tbody tr:eq("+index+")").height(leftHeight)
		    					$(this).height(leftHeight)
		    				}
		    				else {
		    					$(this).height($modelInfoRight.find(".compare__price tbody tr:eq("+index+")").height())
		    					$modelInfoRight.find(".compare__price tbody tr:eq("+index+")").height(rightHeignt)
		    				}
						}
						else {
							$(this).height(leftHeight)
						}
					});
					
					// 팝업창 크기 폭, 높이 맞춤
					if (lnb == 'modelPopup') {
						var modelInfoLeftTitleHeight = '';
						var modelInfoLeftBodyHeight = new Array();
						var modelInfoRightBodyHeight = new Array();
						
						var modelInfoLeftCompareHeight = new Array();
						var modelInfoRightCompareHeight = new Array();
						
						// 기본 높이 저장 (타이틀)
						modelInfoLeftTitleHeight = $modelInfoLeft.find(".compare__header th").height();
						
						// 기본 높이 저장 (본문)
						$.each($modelInfoLeft.find(".compare__body tbody tr"), function(index, item){
							modelInfoLeftBodyHeight[index] = $(this).height();
							modelInfoRightBodyHeight[index] = $modelInfoRight.find(".compare__body tbody tr:eq("+index+")").height();
						});
						
						$.each($modelInfoLeft.find(".compare__price tbody tr"), function(index, item){
							modelInfoLeftCompareHeight[index] = $(this).height();
							modelInfoRightCompareHeight[index] = $modelInfoRight.find(".compare__price tbody tr:eq("+index+")").height();
						});

						$(window).resize(function() {
							var resizeLeftHeight = 0;
							var resizeRightHeight = 0;
							// 높이 초기화 (타이틀)
							$modelInfoLeft.find(".compare__header th").height(modelInfoLeftTitleHeight);
							
							// 높이 초기화 (본문)
//							if(tab != 'trimCompare') {
							$.each($modelInfoLeft.find(".compare__body tbody tr"), function(index, item){
								$modelInfoRight.find(".compare__body tbody tr:eq("+index+")").height(modelInfoRightBodyHeight[index])
								$(this).height(modelInfoLeftBodyHeight[index])
							});	
							
							$.each($modelInfoLeft.find(".compare__price tbody tr"), function(index, item){
								$modelInfoRight.find(".compare__price tbody tr:eq("+index+")").height(modelInfoRightCompareHeight[index])
								$(this).height(modelInfoLeftCompareHeight[index])
							});	
//							}
							
							// 폭 맞춤
							$modelInfoRight.find(".compare__header, .compare__body, .compare__price").css("width", $(window).width()-$modelInfoLeft.width());
							if(tab == 'spec') {
								if($modelInfoRight.find(".compare__header").width() < $modelInfoRight.find(".compare__price").width()) {
									$modelInfoRight.find(".compare__header, .compare__body, .compare__price").css("width", $modelInfoRight.find(".compare__price").width());
								}	
							}
						
							// 높이맞춤 (타이틀)
							if ($modelInfoRight.find(".compare__header th").height() > $modelInfoLeft.find(".compare__header th").height()) {

								$modelInfoLeft.find(".compare__header th").height($modelInfoRight.find(".compare__header th").height());
							}
							else {

								$modelInfoRight.find(".compare__header th").height($modelInfoLeft.find(".compare__header th").height());
							}
						
							// 높이 맞춤 (본문)
							if(tab != 'item' || tab != 'spec') {
								$.each($modelInfoLeft.find(".compare__body tbody tr"), function(index, item){
									resizeLeftHeight = $(this).height();
									resizeRightHeight = $modelInfoRight.find(".compare__body tbody tr:eq("+index+")").height();
									
									if ($modelInfoLeft.find(".compare__body tbody tr").length == $modelInfoRight.find(".compare__body tbody tr").length) {
					    				if (resizeLeftHeight > resizeRightHeight) {
					    					$modelInfoRight.find(".compare__body tbody tr:eq("+index+")").height(resizeLeftHeight)
					    					$(this).height(resizeLeftHeight)
					    				}
					    				else {
					    					$(this).height($modelInfoRight.find(".compare__body tbody tr:eq("+index+")").height())
					    					$modelInfoRight.find(".compare__body tbody tr:eq("+index+")").height(rightHeignt)
					    				}
									}
									else {	
										$(this).height(resizeLeftHeight)
									}
								});	
								
								$.each($modelInfoLeft.find(".compare__price tbody tr"), function(index, item){
									resizeLeftHeight = $(this).height();
									resizeRightHeight = $modelInfoRight.find(".compare__price tbody tr:eq("+index+")").height();
									
									if ($modelInfoLeft.find(".compare__price tbody tr").length == $modelInfoRight.find(".compare__price tbody tr").length) {
					    				if (resizeLeftHeight > resizeRightHeight) {
					    					$modelInfoRight.find(".compare__price tbody tr:eq("+index+")").height(resizeLeftHeight)
					    					$(this).height(resizeLeftHeight)
					    				}
					    				else {
					    					$(this).height($modelInfoRight.find(".compare__price tbody tr:eq("+index+")").height())
					    					$modelInfoRight.find(".compare__price tbody tr:eq("+index+")").height(rightHeignt)
					    				}
									}
									else {	
										$(this).height(resizeLeftHeight)
									}
								});	
							}

							if(tab == 'item' || tab == 'spec') {
								$(".rightTr").each(function(index, item) {
									if($(this).height() <= $(".leftTr:eq("+index+")").height()) {
										$(this).height($(".leftTr:eq("+index+")").height());
									} else {
										$(".leftTr:eq("+index+")").height($(this).height());
									}
								});
							}
						});
					}
					
					$(".group").each(function(index, item) {
						var emptycheck = true;
						$(".compare__right").find(".groupType_" + index).children("td").each(function(subIndex, subItem) {
							if(!(subItem.textContent.replace(/ /g, '').replace(/\n/g, "") == '')) {
								emptycheck = false;
								return false;
							}
						});
						
						if(emptycheck) {
							$(".groupType_" + index).remove();
						}
					});

					$("tr[id^='compareRight_']").each(function(trIndex, trItem) {
						var trEmptyCheck = true;
						$(this).children("td").each(function(tdIndex, tdItem) {
							if(tdItem.textContent.replace(/ /g, '').replace(/\n/g, "") != '') {
								trEmptyCheck = false;
								return false;
							}
						});
						
						if(trEmptyCheck) {
							var removeIdNum = $(this).get(0).id.replace('compareRight_', '');
							$("#compareRight_" + removeIdNum).remove();
							$("#compareLeft_" + removeIdNum).remove();
						}
					});
					
					if(tab == 'spec') {
						autoTrimDataArray.forEach(function(item) {
							maintainCostChange(item);
						});
					}
					
					if(tab == 'item' || tab == 'spec') {
						$(".rightTr").each(function(index, item) {
							if($(this).height() <= $(".leftTr:eq("+index+")").height()) {
								$(this).height($(".leftTr:eq("+index+")").height());
							} else {
								$(".leftTr:eq("+index+")").height($(this).height());
							}
						});
						
						if(tab == 'spec') {
							if($modelInfoRight.find(".compare__header").width() < $modelInfoRight.find(".compare__price").width()) {
								$modelInfoRight.find(".compare__header, .compare__body, .compare__price").css("width", $modelInfoRight.find(".compare__price").width());
							}				
						}
					}
				});

				// 가격표, 레이어창 > 접기/펼치기
				$(document).on('click', "#modelinfo .btn-toggle, #layerPopup .btn-toggle", function (){
					if ($(this).closest(".article-box").hasClass('article-box--open')) {
						$(this).closest(".article-box").removeClass('article-box--open')
						$(this).closest(".article-box").addClass('article-box--close')
					}
					else {
						$(this).closest(".article-box").addClass('article-box--open')
						$(this).closest(".article-box").removeClass('article-box--close')
					}
					
					sendGA('라인업/트림 변경', '라인업 펼치기');
				});

				// 레이어창 > 트림변경
				$(document).on("click","[id ^= 'popuplineup_']",function(){
					var type = '';

					if (lnb == 'modelPopup') {
						
						type = $modelInfo.find(".tab-list__item--on").data('type');
						
						if (!type) {
							type = 'price';
						}
						
						sendGA('라인업/트림 변경', '트림 선택');
						location.href = "/auto/modelPopup.php?Type="+type+"&Lineup="+$(this).data('lineup');
					}
					else {
						type = tab;
						
						if (!type) {
							type = 'price';
						}
						
						location.href = "/auto/?Work=model&Model="+$(this).data('model')+"&Lineup="+$(this).data('lineup')+"&Tab="+type;
					}
				});
				
				// 가격표,사양/옵션,제원 탭고정
				if ($modelInfo.find(".tab-list").length && !msie6) {
					
					$(window).scroll(function (event) {

						var scrollTop = $(this).scrollTop();

						if (scrollTop > $modelInfo.find(".tab-list").offset().top) {
							$modelInfo.find(".tab-list").addClass('modelinfo-tab--fixed');
						}
						else if (scrollTop < $modelInfo.find(".modelinfo-tab").offset().top) {
							$modelInfo.find(".tab-list").removeClass('modelinfo-tab--fixed');
						}
					});
				}

				// 타이틀 탭고정
				if ($modelInfo.find(".modelinfo-compare").length && !msie6) {
					
					$(window).add($modelInfo.find(".compare__right")).scroll(function (event) {

						var scrollTop = $(this).scrollTop();
						var scrollLeft = $("html").scrollLeft();
						var compareWidth = $(".compare__left").width();
						
						if (gnb == 'auto') {
							if (lnb == 'modelPopup') {
								scrollTop = $("html").scrollTop();
								compareWidth = $modelInfo.find(".group").position().left;
							}
							else {
								if ($modelInfo.find(".modelinfo-compare").hasClass('compare--spread')) {
									scrollLeft = scrollLeft-$("#autodanawa_content .gridWide").offset().left;
								}
								else {
									scrollLeft = 0;
									compareWidth = -75;
									if(tab == 'item' || tab == 'spec') {
										compareWidth = 0;
									}
								}
							}
						}

						$topFindClassName ='modelinfo-compare';
						if(lnb == 'modelPopup' && tab == 'item') {
							$topFindClassName = 'modelinfo-tab';
						}

						// Y제어
						if (scrollTop > $modelInfo.find("." + $topFindClassName).offset().top) {
							$modelInfo.find(".modelinfo-compare").addClass('compare--fixed').find(".compare__header").css("top", $("#modelinfo .tab-list").height())
							
							if ($modelInfo.find(".tab-list").length) {
		    					$modelInfo.find(".modelinfo-compare .compare__header").css("top", $modelInfo.find(".tab-list").height())
							}
						}
						else if (scrollTop < $modelInfo.find("." + $topFindClassName).offset().top) {
							$modelInfo.find(".modelinfo-compare").removeClass('compare--fixed');
							
							$modelInfo.find(".compare__left .compare__header").css("left", -scrollLeft);
							$modelInfo.find(".compare__right .compare__header").css("left", (-scrollLeft+compareWidth));
						}
						
						// X제어
						if ($modelInfo.find(".modelinfo-compare").hasClass('compare--fixed')) {
							$modelInfo.find(".compare__left .compare__header").css("left", -scrollLeft);
							$modelInfo.find(".compare__right .compare__header").css("left", (-scrollLeft+compareWidth));
						}
					});
				}

				// 펼처보기
				$(document).on("click", "#modelinfo .modelinfo-compare .btn_spread", function(){
					
					if ($(this).hasClass('on')) {
						$(this).removeClass('on');
						$(this).text('펼처보기').parent().removeClass('compare--spread')
						$("#autodanawa_right").removeClass('off')
					}
					else {
						$(this).addClass('on');
						$(this).text('접어보기').parent().addClass('compare--spread')
						$("#autodanawa_right").addClass('off')
					}
					
				});
				
				// 타이틀 > 좌우변경
				$(document).on("click", "#modelinfo .modelinfo-compare .btn-move", function(){
					
					var index = $(".btn-move").index(this);

					if (index > 0) {
		    			$.each($modelInfoRight.find("tr"), function(i, item){
		    				$(this).find("th:eq("+index+")").after($(this).find("th:eq("+(index-1)+")"));
		    				$(this).find("td:eq("+index+")").after($(this).find("td:eq("+(index-1)+")"));
		    			});
		    			
		    			sendGA($modelInfo.find(".tab-list__item--on").text()+' 위치전환', index);
					}
				});
				
				/** 이벤트 추가 **/
				$("span[id^='specitem_']").on('click', function() {
					var targetId = $(this).get(0).id;
					var itemId = targetId.replace('spec', '');
					var targetSeqArr = targetId.split('_');
					
					if(targetSeqArr.length >= 3) {
						if($(this).hasClass('trim_icon_checked')) {
							$("." + targetId).removeClass('trim_icon_checked');
							$("#" + itemId).attr('checked', false);
						} else {
							$("." + targetId).addClass('trim_icon_checked');
							$("#" + itemId).attr('checked', true);
							
						}	
						
						var optionPrice = $("label[for='"+ itemId +"']").text().replace(/\,/g, '');
						var selectItemPrice = $('#selectItemPrice_' + targetSeqArr[2]).text().replace(/\,/g, '');
						if(selectItemPrice == '-') {
							selectItemPrice = 0;
						}
						
						var selectItemCalc = 0;
						if($('#' + targetId).hasClass('trim_icon_checked')) {
							selectItemCalc = number_format(Number(selectItemPrice) + Number(optionPrice));
						} else {
							selectItemCalc = number_format(Number(selectItemPrice) - Number(optionPrice));
						}
						if(selectItemCalc == 0) {
							selectItemCalc = '-';
						} else {
							selectItemCalc = '<span class="price_default">'+ selectItemCalc +'</span>';
						}
						$('#selectItemPrice_' + targetSeqArr[2]).html(selectItemCalc);
						
						
						var totalItemPrice = $('#totalItemPrice_' + targetSeqArr[2]).text().replace(/\,/g, '');
						var totalItemCalc = 0;
						if($('#' + targetId).hasClass('trim_icon_checked')) {
							totalItemCalc = number_format(Number(totalItemPrice) + Number(optionPrice));
						} else {
							totalItemCalc = number_format(Number(totalItemPrice) - Number(optionPrice));
						}
						$('#totalItemPrice_' + targetSeqArr[2]).html(totalItemCalc);
					}
				});
				
				
				// 통합가격표>선택품목 옵션 선택
				$("input:checkbox[id^='item_']").on("click", function(){
					var $targetId = $(this).get(0).id;
					var $targetSeqArr = $targetId.split('_');
					
					ebox = "I"+$targetSeqArr[2]; // 세로그룹을 위한 트림코드로 지정
					var itms = $(this).attr("code");
    				var ckd = $(this).is(":checked");

					if($targetSeqArr.length >= 3) {
						if($(this).val()) {
							items_check(itms,ckd); // 묶음기능(중복 제거, 의존 추가)
						}
						
						var optionPrice = 0; // 체크된 옵션가격
						var selectItemPrice = 0; // 선택품목 합계
						var totalItemPrice = Number($('#price_default_' + $targetSeqArr[2]).text().replace(/\,/g, '')); // 총합계
						
						// 트림 선택옵션별 체크 확인
						$("input:checkbox[id$='"+$targetSeqArr[2]+"']").each(function(index,item){
							optionPrice = $("label[for='"+ item.id +"']").text().replace(/\,/g, '');
							
							if($("input:checkbox[id='"+item.id+"']").is(":checked")){
								$('.spec' + item.id).addClass('trim_icon_checked'); // 관련 사양 체크
								
								selectItemPrice += Number(optionPrice); // 선택품목 총합 계산
								totalItemPrice += Number(optionPrice); // 전체 총합 계산
							}
							else {
								$('.spec' + item.id).removeClass('trim_icon_checked'); // 관련 사양 체크 해제
							}
						});
						
						if(selectItemPrice == 0) {
							selectItemPrice = '-';
						} else {
							selectItemPrice = '<span class="price_default">'+ number_format(selectItemPrice) +'</span>';
						}
						
						// 선택품목 합계, 총합계 값 셋팅
						$('#selectItemPrice_' + $targetSeqArr[2]).html(selectItemPrice);
						$('#totalItemPrice_' + $targetSeqArr[2]).html(number_format(totalItemPrice));
					}
				});
				
				$("a[id^='estimateSubmit_']").on("click", function(event){
					
					var model = $('.modelinfo-compare')[0].id.replace('model_', '');
					var trimNo = $(this).get(0).id.replace('estimateSubmit_', '');
					var itms = '';
					
					$(".trim_icon_checked").each(function(event) {
						if($(this).get(0).id.indexOf('_' + trimNo) > 0) {
							var selectItemId = $(this).get(0).id.replace('spec', '');
							var trimAddOption = $('#' + selectItemId).parents('tr').get(0).id.replace('trimAddOptionSeq_', '');
							if(itms == '') {
								itms += trimAddOption;
							} else {
								itms += ',' + trimAddOption;
							}
						}
					});
			    	
			    	sendGA('견적 다시 내기', trimNo);
			    	window.open("/buy/?Work=estimate&Model="+model+"&Trims="+trimNo+"&Conf="+itms, "_blank");
					
				});

				$("select[id^='eSelFreeKind']").on("change", function(){
					var selectId = $(this).get(0).id.replace('eSelFreeKind', '');
					maintainCostChange(selectId);
				});
				
				$("select[id^='eSelMant']").on("change", function(){
					var trimNo = 0;
					if($(this).get(0).id.indexOf('eSelMantYear') > -1) {
						trimNo = $(this).get(0).id.replace('eSelMantYear', '');
					} else if($(this).get(0).id.indexOf('eSelMantMile') > -1) {
						trimNo = $(this).get(0).id.replace('eSelMantMile', '');
					}
					maintainCostChange(trimNo);
				});
				
    		}
    		else if(tab == "goods" || tab == "itemImg"){    			
    			var cTop = 502;
    			var autoFocus = true;
    			
    			// 하우스 배너 유무에 따라 조정..
    			$(window).scroll(function (event) {
    				var scrollY = $(this).scrollTop() + 36;
    				
    				if(autoFocus){
    					$.each($(".contFocus > div"), function(index, item){
    						var objectTop = $(item).offset().top - 30;
    						
    						if(scrollY > objectTop && scrollY < (objectTop + $(item).height())) {
    							var target = $(item).find('h3').attr('id');
    							
    							$("#tabFocus li button").parent().removeClass("on");
    							$("#tabFocus li button[tab='"+target+"']").parent().addClass("on");
    						}
    					});
    				}
    				
    				if(scrollY>cTop){
    					$(".tabFocus").addClass("fixed");
    					$(".contFocus").addClass("fixed");
    				}
    				else{
    					$(".tabFocus").removeClass("fixed");
    					$(".contFocus").removeClass("fixed");
    				}
    			});
    			
    			$(document).on("click",".tabFocus li button",function(){	/* 포커스 탭 이동 */
    				$(".tabFocus li").removeClass("on");
    				$(this).parent().addClass("on");
    				
    				var TabLi = $(this).attr("tab");
    				
    				if($("#"+TabLi).length > 0) {
    					autoFocus = false;
    					
    					var tgTop = $("#"+TabLi).offset().top-60;
    					
    					$('html, body').animate({ scrollTop: tgTop }, 300, function(){
    						autoFocus = true;
    					});
    				}
    			});    			
    		}
    		else if (tab == 'image') {    			
    			// 사양이미지 그룹리스트 선택
    			$("#selGroupList").on("change", function(){
    				$("#itemImgBox .newcar_image_contents").addClass("off");
    				$("#groupList_"+$(this).val()).removeClass("off");    				
    				$("#itemImgTabList_"+$(this).val()+" li button:eq(0)").trigger("click");
    			})
    			
    			// 사양이미지 탭 선택
    			$(document).on("click","#itemImgBox .list li button",function(){
    				$("#itemImgBox .list li").removeClass('on');
    				$(this).parent().addClass('on');    				
    				$(".specImageBox .specImageSection ").addClass('off');
    				
    				var TabLi = $(this).attr('tab');
    				
    				$(".specImageBox .specImageSection[tab='"+ TabLi +"']").removeClass('off');  
    			});
    		}
    	}
    	else if (lnb == 'record') {    		
    		var TabLi = '';
    		
    		if ($("#recordTab li.on").length) {
    			TabLi = $("#recordTab li.on").attr('id');
    			
    			$("#recordTab li").removeClass("on");
    			$("#recordTab #" + TabLi).addClass("on");
    		}

    		//탭 클릭
    		$(document).on('click', '#recordTab li', function() {
    			var TabLi;
    			var month = $("#selMonth option:selected").val() + "-" + $("#selDay option:selected").val() + "-00";
    			
    			($(this).index() =='0') ? TabLi = 'Top10' : ($(this).index() =='1') ? TabLi='Grand': TabLi='Model' ;
    			
    			location.href = '/' + gnb + '/?Work=' + lnb + '&Tab=' + TabLi + '&Month=' + month;
    		});    		
    	}
    }
    // 리스렌트 통합
    else if (gnb == 'leaserent') {    	

    	if (lnb == 'leaserentSearch' || lnb == 'special') {
    		window.onload = function(){
    			if(window.location.hash && $(window.location.hash).length) {
    				$(window.location.hash).addClass("on");
    			}
    		}
    		
    		//location.pathname
    		$(document).on('click', "#searchLeaseOrder input[name='monthLR']", function(){
    			location.href = $("#scriptPeriodUrl").val()+"&Period="+ $(this).attr("value");
    		});

    		//모델 선택
    		$(document).on("change", "#searchLeaseOrder select", function(){
    			$(".leaserent_list li").removeClass("on");

    			if($("#anchor"+$(this).val()).length){
    				location.hash = "#anchor" + $(this).val();
    				$("#anchor"+$(this).val()).addClass("on");
    			}
    		});
    	}
    	
    	if (lnb == 'leaserentSearch' || lnb == 'priceCompare' || lnb == 'directMallBuyCounseling' || lnb == 'leaserentDealDetail') {
    		// 전화상담 > 시도선택
    		$(document).on("change", "#write_form #sido", function () {
    			var sidoCode = $(this).val();
    			var sidoName = $("#sido option:selected").html();

    			$.get(
    					"../service/ajax_auto_sigunguSelect.php",
    					{
    					    Sido:sidoCode,
    					    Type:"name"
    					},
    					function (data, status) {
    						if (status == "success") {
    							$("#write_form #sigungu").html(data.replace("전지역", "시/군/구")).parent().find('label').addClass('hide').find('.placeholder').text('시/군/구');
    							
    							if($("#write_form #sigungu").data('actionlabel') != "") {
    								$("#write_form #sigungu").val($("#write_form #sigungu").data('actionlabel'));
    							}
    							
    							sendGA('블로그_전화상담 견적요청', '시도');
    						}
    					}
    				);
    		});

    		$(document).on("change", "#write_form #sigungu", function () {
    			sendGA('블로그_전화상담 견적요청', '시군구');
    		});

    		// 전화상담 > 상담내용
    		$(document).on("keyup", "#write_form #requestContents", function(){
    			if ($(this).val().length == 0) {
    				$("#requestContents").parent(".textareabox").find('label').removeClass('hide');
    			}
    			else {
    				$("#requestContents").parent(".textareabox").find('label').addClass('hide');
    			}
    		})
    		
    		// 견적 추가문의 선택시 제공동의 문구 수정
    		$(document).on('click', "#write_form div[id^='addRequestList_']", function() {
    			if($("input[name=comapnyCode]").val() != "danawa") {
					var sellerName = $("#sellerName").val();
					var otherHoldingPeriod = "6개월";
					var check = true;
					
    				var addRequestCompanyCode = '';
    				var danawaCheck = false;
    				$("input[id^=r-addesti_]:checked").each(function(i, e){
    					check = false;
    					sellerName += ", " + $(this).val();

    					if($(this).val() == "(주)오토홀딩스") {
    						otherHoldingPeriod += " (직영몰 계약 시 계약 만료일까지)";
    						sellerName += ", " + "(주)마이카오토";
    					}
    					
    					var currentTargetId = $(this).get(0).id;
    					var idArray = currentTargetId.split('_');
    					if(idArray.length == 3) {
    						if(idArray[1] == 'danawa') {
    							danawaCheck = true;
    						}
    					}
    				});
    				
    				if ($("input[id^=r-addesti_]:checked").length != 5) {
    					$("#write_form #checkAddRequestTop5").attr('checked', false);
    				}
    				
    				$("#otherSeller").html(sellerName);
    				$(".txtHoldingPeriod").html(otherHoldingPeriod);
    				
    				if(danawaCheck) {
    					$("#otherAgreeSamsung").show();
    					$("#otherAgreeStarAuto").show();
    				} else {
    					$("#otherAgreeSamsung").hide();
    					$("#otherAgreeStarAuto").hide();    					
    				}
				}
    		});
    		
    		// 전화상담 > 동의
    		$(document).on('click', "#write_form dt .btn-toggle", function() {
    			var $selectAgree = $(this).closest("dl");
    			if ($selectAgree.hasClass("g-agree--open")) {
    				$selectAgree.removeClass("g-agree--open");
    				$selectAgree.addClass("g-agree--close");
    			}
    			else {
    				$selectAgree.removeClass("g-agree--close");
    				$selectAgree.addClass("g-agree--open");
    			}
    		});
    		
    		// 견적요청 필수값 체크
    		$(document).on("change", "#write_form input[name='name'], " +
    				"#write_form input[name='validatedPhoneNumber'], " +
    				"#write_form #agreeCheck1, " +
    				"#write_form #agreeCheck2, " +
    				"#write_form #userPhone2, " +
    				"#write_form #sigungu ", function(){	  
    			if ($("#write_form input[name='name']").val() &&
					($("#write_form input[name='validatedPhoneNumber']").val() || $("#write_form #userPhone2").val())
					&& $("#write_form #agreeCheck1").is(":checked") 
					&& $("#write_form #agreeCheck2").is(":checked") 
					&& $("#write_form #sigungu").val()) {
    				$("#rentLeaseSubmit").addClass('on');
    	    	} else {
    	    		$("#rentLeaseSubmit").removeClass('on');
    	    	}
    	    });
    	    
    		// 재확인 요청 레이어 숨김처리
    		$(document).on("click", ".reconfirmClose", function() {
    			$("#reconfirmLayerPopup").css('display', 'none');
    		});
    		// 재확인 후 견적 요청
    		$(document).on("click", "#reconfirmCompletion", function() {
    			// 다중 버튼 클릭시, 한번만 실행되도록 체크
    			if(doubleSubmitCheck()) {
    				return;
    			}
    			
	 			var url = webUrl+"/action/ssl.leaserent.request.action.php";
				
				if (bIsReal) {
					url = "https://auto.danawa.com/action/ssl.leaserent.request.action.php";
    			}
				
				//전환스크립트 호출전
				sendGA('렌트/리스_호출전','');
				if($('#lastServerNum').length > 0) {
					if($('#lastServerNum').val() > 0) {
						eval('try{ _trk_clickTrace( \'EVT\', \'렌트_리스_호출전_' + $('#lastServerNum').val() + '\' ); }catch(_e){ }');
					}
				}

				if (gnb == 'home') {
					naverScript(1, 10000000000000);
				}

				var sPordList = "";
				$('#write_form').ajaxForm({
					url: url,
					enctype: "multipart/form-data",
					type: 'POST',
					async: false,
					dataType : 'json',
					success: function(data){
						if (data.code == "1" && bIsReal) {
							// 전환분석 스크립트
							if($("#write_form input[name='comapnyCode']").val() == 'danawaDeals') {
								naverScript(1, 1);
								
								var brandCode = $("#write_form input[name='nBrandCode']").val();
								var modelCode = $("#write_form input[name='nModelCode']").val();
								if(DmpScriptModule) {
									DmpScriptModule.actionUrl(webUrl+'/occasion/2103_danawaHotdealScript.php?trk_pnc='+brandCode+""+modelCode);
								}
							} else {
								naverScript(1, 1);
									
								if(DmpScriptModule) {
									DmpScriptModule.actionUrl(webUrl+'/occasion/1906_rentLeaseScript.php?trk_pnc='+$("#rentLeaseEstimateBrand").attr('brand')+""+$("#model").val());
								}
							}
							
							//gtag 이벤트 스니펫 추가
							gtag('event', 'conversion', {'send_to': 'AW-952650720/rSVuCOfA08EYEOCXocYD'});
							
							//전환스크립트 호출후
							sendGA('렌트/리스_호출완료',$("#write_form input[name='comapnyCode']").val());
							
							/** 추가 견적 요청에 따른 전환 스크립트 **/
							if($("input[id^=r-addesti_]:checked").length > 0) {
								$("input[id^=r-addesti_]:checked").each(function(e){
									var addCompanyInfo = $(this).get(0).id.replace('r-addesti_', '').split("_")[0];
									var addCompanyDanawaPrice = $("#addRequestList_" + addCompanyInfo).find(".price .num").text().replace(/[^\d]+/g, "");
									
									
									if(addCompanyInfo == 'danawa') {

									} else {
										naverScript(1, 1);
										
										if(DmpScriptModule) {
											DmpScriptModule.actionUrl(webUrl+'/occasion/1906_rentLeaseScript.php?trk_pnc='+$("#rentLeaseEstimateBrand").attr('brand')+""+$("#model").val());
										}
									}
									
									if (gnb == 'home') {
										naverScript(1, 10000000000000);
									}
									
									//gtag 이벤트 스니펫 추가
									gtag('event', 'conversion', {'send_to': 'AW-952650720/rSVuCOfA08EYEOCXocYD'});
									
									//전환스크립트 호출후
									sendGA('렌트/리스_호출완료',$("#write_form input[name='comapnyCode']").val());
								});
							}
							/** //추가 견적 요청에 따른 전환 스크립트 **/
							
							alert(data.message);
						} else {
							alert(data.message);
						}
					},
					complete: function () {
						window.location.reload(true);
					}
				});
				
				$("#write_form").submit();
				return false;
    		});
    		
    		// 전화상담 > 견적요청
    		$(document).on("click", "#rentLeaseSubmit.on", function() {

    			var vaildMsg = trk_pnc = "";
    			var tranName = $("#write_form input[name='name']").val().replace(/[^가-힣a-zA-Z]/gi, "");
    			
    			if ($("#rentLeaseSubmit").hasClass('disabled')) {
					vaildMsg = '견적 요청중입니다.';
    			}
    			else {
    				$("#rentLeaseSubmit").addClass('disabled');
    			}
    			
    			if($("#write_form input[name='comapnyCode']").val() == 'danawa') {
    				var phoneNumber = $('#userPhone1').val() + $('#userPhone2').val();
    				var testPhoneNumber = phoneNumber.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3");
    				$("#write_form input[name='validatedPhoneNumber']").val(testPhoneNumber);
    			}
    			
    			if ($("#write_form input[name='name']").val() == "") vaildMsg = "이름을 반드시 입력해 주세요.";
    			else if ($("#write_form input[name='name']").val().length > 0 && (tranName.length < 2 || $("#write_form input[name='name']").val() != tranName)) vaildMsg = "이름을 바르게 입력했는지 다시 확인해주세요.";
    			else if ($("#write_form input[name='validatedPhoneNumber']").val() == "") vaildMsg = "휴대전화번호를 반드시 입력해 주세요.";
    			else if ($("#write_form input[name='validatedPhoneNumber']").val().length < 10) vaildMsg = "휴대전화번호를 바르게 입력했는지 다시 확인해주세요.";
    			else if (($("#write_form select[name='sido']").val() == "") || ($("#write_form select[name='sigungu']").val() == "")) vaildMsg = "지역을 선택해주세요.";
    			else if (!$("#write_form #agreeCheck1").is(":checked") || !$("#write_form #agreeCheck2").is(":checked")) vaildMsg = "개인정보 수집 및 제3자 제공에 동의해야 견적 요청이 가능합니다.";
    			
    	        if (vaildMsg != "") {
    	        	$("#rentLeaseSubmit").removeClass('disabled');
    		        alert(vaildMsg);
    		        return false;
    	        }
    		 	
    		 	if (1 && vaildMsg == "") {
    		 		$("#rentLeaseSubmit").removeClass('disabled');
    				$("#reconfirmLayerPopup").css('display', 'block');
    				
    				$("#reconfirmLocal").text($("#write_form select[name='sido']").val() + ' ' + $("#write_form select[name='sigungu']").val());
    				$("#reconfirmName").text($("#write_form input[name='name']").val());
    				
    				$("#reconfirmPhoneNum").text($("#write_form input[name='validatedPhoneNumber']").val());
    				
    				$("#write_form input[name='optionSeqs']").val("");
    				var optionSeqs = "";
    				$("#Optn_1 .eChkItemList input:checked").each(function(e){
    					var optionSeq = $(this).attr('code');
    					var optionName = $("label[for='"+ $(this).get(0).id +"']").text();
    					if(e == 0) {
    						optionSeqs += optionSeq +":" + optionName;
    					} else {
    						optionSeqs += "@" + optionSeq +":" + optionName;
    					}					
    				});
    				$("#write_form input[name='optionSeqs']").val(optionSeqs);
    				
    				var addRequestCompanyCode = '';
    				var addRequestCompanyName = $("#sellerName").val();
    				$("input[id^=r-addesti_]:checked").each(function(e){
    					if(e == 0) {
    						addRequestCompanyCode += $(this).get(0).id.replace('r-addesti_', '');
    					} else {
    						addRequestCompanyCode += "," + $(this).get(0).id.replace('r-addesti_', '');
    					}
    					
						var codeArray = $(this).get(0).id.replace('r-addesti_', '').split("_");
						if(codeArray[0] != 'danawa') {
							addRequestCompanyName += ", " + $(this).val();
						}
    				});
    				$("#write_form input[name='addRequestCompanyCode']").val(addRequestCompanyCode);
    				$("#write_form input[name='addRequestCompanyName']").val(addRequestCompanyName);
    			}
    			return false;
    			
    		});
    		
    		// 직영몰 추가
    		if (1) {

    			// 상담시간 선택효과
    			$(document).on('click', "#write_form ul.request-consult__time li:not('.disabled')", function(){
    				$("#write_form ul.request-consult__time li").removeClass('on');
    				$(this).addClass('on');
    				
    				$("#write_form #dateInput").val($("#write_form .request-consult__day li.on").data('date')+" "+$("#write_form .request-consult__time li.on").text());
    			});
    			
    			// 상담날자 선택효과
    			$(document).on('click', "#write_form ul.request-consult__day li:not('.disabled')", function(){
    				$("#write_form ul.request-consult__day li").removeClass('on');
    				$(this).addClass('on');
    				
    				var selectedDate = $(this).data('date');
    				
    				$.ajax({
						url: webUrl + '/service/ajax_leaserent_estimate.php',
						type: 'POST',
						dataType: 'json',
						data:{
							processKind: 'checkCounseling',
							date: selectedDate
						},
						async: false,
						error: function() {},
						success: function(data) {
							var liElement = '';
							var disabledCSS = '';
							var aTimeList = ['10', '11', '13', '14', '15', '16', '17', '18', '19'];

							for ( var i in aTimeList) {
								if (data[selectedDate +" "+aTimeList[i]+":00:00"] == -1) { 
									disabledCSS = 'disabled hide';
								} else if (data[selectedDate +" "+aTimeList[i]+":00:00"] >= 50) {
									disabledCSS = 'disabled';
								} else {
									disabledCSS = '';
								}
								
								liElement += '<li class="consult_list '+disabledCSS+'"><a href="javascript:void(0)" class="consult_btn">'+aTimeList[i]+':00</a></li>';
							}
							
							$("#write_form .request-consult__time").empty().append(liElement).find("li:not('.disabled'):eq(0)").click();
						}
					});
    			});
    			
    			// 옵션상세 접기,펼치기
    			$(document).on("click", "#Optn_1 .btn-toggle", function(){
    				if($(this).hasClass('close')) {
    					$(this).removeClass('close');
    					$(this).closest('.choice-toggle').removeClass('choice-toggle--close')
    					$(this).closest('.choice-toggle').addClass('choice-toggle--open')
    				}
    				else {
    					$(this).closest('.choice-toggle').addClass('choice-toggle--close')
    					$(this).closest('.choice-toggle').removeClass('choice-toggle--open')
    					$(this).addClass('close');
    				}
    			});
    			
    			// 옵션 열기/닫기
    			$(document).on("click", "#Optn_1 .choice-more__btn", function(){
    				if($(this).parent().hasClass('choice-more--close')){
    		        	$(this).find(".txt").text('닫기');
    		        	$(this).parent().removeClass('choice-more--close').addClass('choice-more--open');

    		        	$('#Optn_1 div.choice-toggle.choice-toggle--close').removeClass('off');
    		        }else{
    		        	$(this).find(".txt").text('더보기');
    		        	$(this).parent().removeClass('choice-more--open').addClass('choice-more--close');
    		        	
    		        	$.each($('#Optn_1 div.choice-toggle.choice-toggle--close'), function(index, element){
    		        		if (index > 4) {
    		        			$(this).addClass('off');
    		        		}
    		        	});
    		        }
    			});

    			/*  =옵션 선택 : 견적  */
    			$(document).on("click","#Optn_1 .eChkItemList input",function(){

    				var itms = $(this).attr("code");
    				var ckd = $(this).is(":checked");

    				items_check(itms,ckd);	// 중복 제거, 의존 추가
    				//calculate("itms",itms);

    				var optionPriceSum = 0;
    				
    				if ($("#Optn_1 .eChkItemList input:checked").length) {
    					$("#Optn_1 .eChkItemList input:checked").each(function(){
    						var cmpVal = dnw_deChar($(this).val()).split("`");
    						var cmpVal2 = cmpVal[1].split(":");

    						optionPriceSum += (cmpVal2[0]*1);
    					});
    				}

    				if (optionPriceSum) {
    					$.ajax({
    						url: webUrl + '/service/ajax_leaserent_estimate.php',
    						type: 'POST',
    						dataType: 'json',
    						data:{
    							processKind: 'alliancePrice',
    							brandCode: $("#brandCode").val(),
    							trimsCode: $("#trimsCode").val(),
    							period: $("#period").val(),
    							prodType: $("#prodType").val(),
    							priceType: $("#priceType").val(),
    							oprtionPrice: optionPriceSum,
    						},
    						async: false,
    						error: function() {},
    						success: function(data) {
    							if (data && data[0]) {
    								$("#leaserentAfterMonthPrice").removeClass('off');
    								$("#leaserentAfterMonthPrice .num").text(number_format(data[0]['월납입금']))
    								//number_animate(data[0]['월납입금'], "#leaserentAfterMonthPrice .num");
    								
    								if (data[0]['월납입금'] -  number_only($("#leaserentMonthPrice .num").text()) > 0) {
    									$("#leaserentAfterMonthPrice .option_price").text("(+"+number_format(data[0]['월납입금'] -  number_only($("#leaserentMonthPrice .num").text()))+")")
    								}
    								else {
    									$("#leaserentAfterMonthPrice .option_price").text("("+number_format(data[0]['월납입금'] -  number_only($("#leaserentMonthPrice .num").text()))+")")
    								}
    								
    								$("#monthPaymentWithOptions").val(data[0]['월납입금']);
    							}
    							else {
    								alert('통신 실패로 금액을 수신받지 못하였습니다.\n잠시 후 다시 시도하거나 상담시 문의해주세요');
    								$("#Optn_1 .eChkItemList input:checked").prop('checked', false).prop('disabled', true);
    							}
    						}
    					});
    				}
    				else {
    					$("#leaserentAfterMonthPrice").addClass('off');
    				}
    			});
    		}
    		
    		/** 견적 추가문의 더보기 버튼 이벤트 **/
    		$(document).on("click",".request-addesti__wrap #addRequestMoreBtn",function(){
    			$("div[id^='addRequestList_']").removeClass('off');
    			$(this).css('display', 'none');
    		});

    		/** 인증번호 발송 이벤트 **/
    		$(document).on("click","#certifyRequestItem #certifyRequestBtn",function(event) {
    			event.preventDefault();

    			if($(this).hasClass("certify-request__btn--disable") === true) {
    				$(this).removeClass("certify-request__btn--disable");
    				$(this).text("인증요청");
    				$("#r-text_02").parents('div').removeClass("inputbox--disable");
    				$("#r-text_02").val("");
    				$("#certifySuccessItem").hide();
    				$("#certifyNumberItemText").hide();
    				$("#certifyTime").text("3:00");
    				$("#r-text_02").attr("disabled", false);
    				
					/** 전화번호 값 저장 **/
					$("#validatedPhoneNumber").val("");
					$("#validatedPhoneNumber").trigger("change");
    				
    			} else {
        			var userName = $(".request-personal #userName").val();
        			var phoneNumber = $(".request-personal #r-text_02").val();

        			if($.trim(userName) == "") {
        				$(".request-personal #userName").val("");
        				$(".request-personal #userName").focus();
        				return false;
        			} else if(phoneNumber == "") {
        				$(".request-personal #r-text_02").focus();
        				return false;
        			}

        			$.ajax({
        				type:"POST",
        				url : webUrl + "/service/ajax_sendSms.php",
        				data: {
            				processKind: 'easyCertification',
            				name : $(".request-personal #userName").val(),
            				phoneNumber : $("#r-text_02").val(),
            				serviceType : 1
            			},
        				dataType : "json",
        				error : function(request, status, error) {
        					alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
        				},
        				success: function (data) {
        					if(data.result) {
        						alert(data.message);
        						
        						if(data.tempRandNum > 0) {
        							alert(data.tempRandNum);
        						}
        						$("#certifyPhoneNumber").val(phoneNumber);
        						clearInterval(certificationObj);
        						certificationTime = 180;
        						certificationMin = "";
        						certificationSec = "";
        						
        						$("#certifyNumber").val("");
        						$("#certifyNumberItem").show();
        						$("#certifyNumberItemText").show();
        						$("#certifyTimeout").hide();
        						
        						certificationObj = setInterval(certificationTimeout, 1000);
        						
        						$(document).on("click","#layerPopup .btn-close", function(){
        							clearInterval(certificationObj);
        						});
        					} else {
        						alert(data.message);
        						return false;
        					}
        				}
        			});
    			}
    		});
    		
    		/** 인증번호 확인 이벤트 **/
			$(document).on("click", "#certifyCheckBtn", function(e) {
				
				var userName = $(".request-personal #userName").val();
				var phoneNumber = $("#certifyPhoneNumber").val();
				var certifyNumber = $("#certifyNumber").val();
				
				/** 입력 유효성 체크 **/
    			if($.trim(userName) == "") {
    				$(".request-personal #userName").val("");
    				$(".request-personal #userName").focus();
    				return false;
    			} else if(phoneNumber == "") {
    				$(".request-personal #r-text_02").focus();
    				return false;
    			}

    			$.ajax({
    				type:"POST",
    				url : webUrl + "/service/ajax_sendSms.php",
    				data: {
        				processKind: 'certificationNumberChk',
        				userName : userName,
        				phoneNumber : phoneNumber,
        				certifyNumber : certifyNumber,
        				serviceType : 1
    				},
    				dataType : "json",
    				error : function(request, status, error) {
    					alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
    				},
    				success: function (data) {
    					if(data.result) {
    						clearInterval(certificationObj);
    						$("#certifyNumberItem").hide();
    						$("#certifySuccessItem").show();
    						$("#r-text_02").parents('div').addClass('inputbox--disable');
    						$("#certifyRequestBtn").addClass('certify-request__btn--disable');
    						$("#certifyRequestBtn").text('번호변경');
    						$("#r-text_02").attr("disabled", true);
    						
    						/** 전화번호 값 저장 **/
    						$("#validatedPhoneNumber").val(phoneNumber.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"));
    						$("#validatedPhoneNumber").trigger("change");
    						
    						if(phoneNumber.length == 11) {
    							phoneNumber = phoneNumber.substring(0,3) + "****" + phoneNumber.substring(phoneNumber.length-4, phoneNumber.length);
    						} else {
    							phoneNumber = phoneNumber.substring(0,3) + "***" + phoneNumber.substring(phoneNumber.length-4, phoneNumber.length);
    						}
    						$("#r-text_02").val(phoneNumber);
    						
    						var date = new Date();
    						date.setTime(date.getTime() + (180 * 1000)); //3분
    						$.cookie('leaserentCertifiy', data.leaserentCertifiy, { expires: 1 });
    						$.cookie('leaserentCertifiyNum', data.leaserentCertifiyNum, { expires: 1 });
    						$.cookie('leaserentCertifiyName', data.leaserentCertifiyName, { expires: 1 });
    					} else {
    						alert(data.message);
    					}
    				}
    			});
			});
    	}
    	
    	if (lnb == 'leaserentSearch') {
    		//2019.06.17 mjmjmjmj91@danawa.com 렌트리스 개편 : 세부모델
			$(document).on('click', '[id^="trimView"]', function(){
    			/* 모델  */
    			var model = $(this).attr('name');		
        		/* 트림  */		
        		var trim = $(this).attr('data-trim');		
        		/* 이용기간 */		
        		var monthTerm = '';		
        		/*보증금/선납금 */		
        		var priceType = '';		
        		/* 렌트리스 구분 */		
        		var prodType = '';	
        		
        		if ($('#layer'+model).parent().hasClass('on')) {
        			$('#layer'+model).parent().removeClass('on');
        		}
        		else {
        			$('.mib_layer').parent().removeClass('on');
	        		$(".row_period li").each(function(){		
	        			if($(this).hasClass("select")){		
	        				monthTerm = $(this).attr('data-value');		
	        			}		
	        		});		
	        		$(".row_pay li").each(function(){		
	        			if($(this).hasClass("select")){		
	        				priceType = $(this).attr('data-value');		
	        			}		
	        		});		
	        		$(".row_rent li").each(function(){		
	        			if($(this).hasClass("select")){		
	        				prodType = $(this).attr('data-value');		
	        			}		
	        		});		
	    					
	    			$.ajax({		
						type:"GET",		
						url : "/service/ajax_leaserent_productList.php",		
						dataType : "json",		
						data : {		
							"viewType" : 'pcList',		
							"model" : model,		
							"trim" : trim,		
							"monthTerm" : monthTerm,		
							"prodType" : prodType,		
							"priceType" : priceType		
						},		
						error : function(request, status, error) {		
							alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);		
						},		
						success : function(data) {		
							$('#layer'+model).html(data);
							$('#layer'+model).parent().addClass('on');
						}		
					});
        		}
    		});		
        			
        	// 세부모델 라인업 펼침처리		
        	$(document).on('click', ".mlc_main dt", function(){		
        		if ($(this).parent().hasClass("on")) {		
        			$(this).parent().removeClass("on");		
        		}		
        		else {		
        			$(this).parent().addClass("on");		
        		}		
        	});
    	}
    	else if (lnb == 'priceCompare') {

    		// 상품필터
    		$(document).on('click', "#rentLeaseWrap .rs_option ul li a", function(){
    			$(this).closest('ul').find('li').removeClass('select');
    			$(this).closest('li').addClass('select');
    			
    			// 더보기 비활성화
    			$('.mib_wrap').removeClass('on');

    			$("#prodType").val($("#rentLeaseWrap .rs_option .row_rent li.select").data('prodtype'));
    			$("#month").val($("#rentLeaseWrap .rs_option .row_period li.select").data('month'));
    			$("#priceType").val($("#rentLeaseWrap .rs_option .row_pay li.select").data('pricetype'));
				
    			$.ajax({
    				type:"GET",
    				url : "/service/ajax_leaserent_productList.php",
    				dataType : "json",
    				data : {
    					"viewType" : 'pcBlog',
    					"model" : $("#model").val(),
    					"trim" : $("#trims").val(),
    					"monthTerm" : $("#month").val(),
    					"prodType" : $("#prodType").val(),
    					"priceType" : $("#priceType").val()
    				},
    				beforeSend:function(){
    		    		$(".rent_blog_wrap .cover").addClass('on')
    			    },
    				error : function(request, status, error) {
    					console.log("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
    				},
    				success : function(data) {
    					$('#rentLeaseWrap .mib_wrap').html(data);
    				},
    				complete : function() {
    					$(".rent_blog_wrap .cover").removeClass("on");
    	        		rentLeaseSearchAjax();
    	        		
						var mlcsAmount = $("input:radio[name='carModel[]']:checked").parent().siblings('.mlcs_title').children('.mlcs_amount').attr('data-value');
    	    			mlcsAmount = (mlcsAmount && mlcsAmount != '') ? mlcsAmount.replace(/,/gi,"") : '0';
    	    			
    	    			if ($("#priceType").val() == 3 || $("#priceType").val() == 2) {
    	    				$("#rentLeaseWrap .rs_option .price .num").text(addComma(Math.ceil(mlcsAmount * 0.3)+""));
    	    			}
    	    			else {
    	    				$("#rentLeaseWrap .rs_option .price .num").text("0");
    	    			}
    			    }
    			});
    		});

    		// 세부모델 선택
    		$(document).on('click', "#rentLeaseWrap .ml_con .mlcs_contents", function(){
    			
    			$("#rentLeaseWrap .ml_con .mlcs_contents input").attr('checked', false);
    			$("#rentLeaseWrap .ml_con .mlcs_contents").removeClass('on')

    			$("#trims").val($(this).find('input').attr('checked', true).val())
    			$(this).addClass('on');
    			
    			$('#trimName').text($(this).find('label').text());
    			$('#lineupName').text($(this).parent().parent().parent().parent().find('dt').text());
    			
				var mlcsAmount = $(this).children('.mlcs_title').children('.mlcs_amount').attr('data-value');
    			mlcsAmount = (mlcsAmount && mlcsAmount != '') ? mlcsAmount.replace(/,/gi,"") : '0';
    			
    			if ($("#priceType").val() == 3 || $("#priceType").val() == 2) {
    				$("#rentLeaseWrap .rs_option .price .num").text(addComma(Math.ceil(mlcsAmount * 0.3)+""));
    			}
    			else {
    				$("#rentLeaseWrap .rs_option .price .num").text(0);
    			}
    			
    			sendUXLOG("P17005",{"option":"렌트리스상품블로그_검색옵션_세부모델", "trimCode":$(this).find('input').attr('checked', true).val(), "trimName":$(this).closest('li').find('label').text(), "trimPrice":mlcsAmount, "trimMonthPrice":$(this).closest('li').find('.mlcs_price').text()});

    			rentLeaseSearchAjax();
    		});

    		// 세부모델 더보기
    		$(document).on('click', "#rentLeaseWrap .mlc_more .mlcm_btn", function(){
    			if ($("#rentLeaseWrap .mib_wrap").hasClass('on')) {
    				$("#rentLeaseWrap .mib_wrap").removeClass('on')
    				$("#rentLeaseWrap .mlcm_btn span.txt").html('더보기');
    			}
    			else { 
    				$("#rentLeaseWrap .mib_wrap").addClass('on')
    				$("#rentLeaseWrap .mlcm_btn span.txt").html('닫기');
    			}
    		});

    		// 가격비교상품 정렬
    		$(document).on('click', "#searchLeaseOrder li button", function(){
    			$(this).closest('ul').find('button').removeClass('select');
    			$(this).addClass('select')

    			$("#order").val($("#searchLeaseOrder li button.select").data('order'));
    			rentLeaseSearchAjax();
    		});
    		
    		// 리스트 상단 스크롤 고정(조건표시)
        	var msie6 = $.browser == 'msie' && $.browser.version < 7;
			var searchLeaseOrderOffset = $('#searchLeaseOrder').offset();
			
			if (!msie6) {
				$(window).scroll(function (event) {
					var scrollY = $(document).scrollTop();
					
					if (scrollY > searchLeaseOrderOffset.top) {
						$('.indexHead').addClass('fixed');
					}
					else {
						$('.indexHead').removeClass('fixed');
					}
				});
			}
			
			setTimeout(function(){$('#rentLeaserResult .tooltip_layer, #rentLeaserResult .directmall_layer').removeClass('show');}, 3500);
			
			// 전화상담 > 토스트 팝업창 닫기
    		$(document).on('click', ".tooltip_layer .btn_tt_close", function(){
    			$(".tooltip_layer").removeClass("show");
    		});
    		
    		// 전화상담 > 업체정보 레이어
    		$(document).on('click', ".layer_company_info .btn-close, a.link__firm", function(){
    			var companyHeadText = $(this).parent().parent().parent().parent().parent().find('div.reh_title .title').text();
				
    			if(companyHeadText == '다이렉트 견적') {
    				var layerContents = "";
        			var companyInfo = $(this).parent().find('input');
        			var companyImage = $(this).find('div.box__logo img').attr('src');
        			
        			layerContents  = "<div class='box__direct-info'>" +
					        			"<div class='box__company'>" +
						                    "<div class='box__name'>" +
						                        "<div class='box__logo'><img src='" + companyImage + "' alt='"+ companyInfo.eq(0).val() + "' aria-hidden='true' class='image'></div>" +
						                        "<div class='text__firm'>"+ companyInfo.eq(0).val() + "</div>" +
						                    "</div>" +
						                    "<div class='box__info'>" +
						                        "<div class='box__row'>" +
						                            "<div class='text__title'>고객센터번호</div>" +
						                            "<div class='text__cont'>"+ companyInfo.eq(1).val() + "</div>" +
						                        "</div>" +
						                        "<div class='box__row'>" +
						                            "<div class='text__title'>회사 주소</div>" +
						                            "<div class='text__cont'>"+ companyInfo.eq(2).val() + "</div>" +
						                        "</div>" +
						                        "<div class='box__row'>" +
						                            "<div class='text__title'>대표자명</div>" +
						                            "<div class='text__cont'>"+ companyInfo.eq(3).val() + "</div>" +
						                        "</div>" +
						                    "</div>" +
						                "</div>" +
					                "</div>";
        			
        			$("#layerPopup .g-layer__cont").empty().html(layerContents);
        			openLayerPopup('popup', '입점 업체 정보');
    			} else {
	    			var $selecCompany = $(this).closest(".left").find(".layer_company_info");
	    			
	    			if ($selecCompany.css("display") == "none") {
	    				$selecCompany.css("display", "block");
	    				 
	    				var companyAdminCode = $selecCompany.data('companyadmin');
	    				var trimCode = $('#trims').val();
	    				
	    				$.ajax({
	        				type:"post",
	        				url : "/service/ajax_leaserent_companyReviewList.php",
	        				data: "nAdminCode=" + companyAdminCode + '&nTrimCode=' + trimCode,
	        				dataType : "html",
	        				error : function(request, status, error) {
	        					alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
	        				},
	        				success: function (data) {
	        					$selecCompany.find(".box__table").html(data);
	        				}
	        			});
	    			}
	    			else {
	    				$selecCompany.css("display", "none");
	    			}
    			}
    		});
    		
    		$(document).on('click', "#getAutoCompanyReviewPage", function(){
    			var nPage = $(this).data('page');
    			var trimCode = $('#trims').val();
				var companyAdminCode = $(this).data('addparam');
				$('div.layer_company_info').find("[data-companyadmin='" + companyAdminCode + "']").find(".box__table").html('');
				
				$.ajax({
    				type:"post",
    				url : "/service/ajax_leaserent_companyReviewList.php",
    				data: "nAdminCode=" + companyAdminCode + '&nPage=' + nPage + '&nTrimCode=' + trimCode,
    				dataType : "html",
    				error : function(request, status, error) {
    					alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
    				},
    				success: function (data) {
//    					$('div.layer_company_info').find("[data-companyadmin='" + companyAdminCode + "']").find(".box__table").html(data);
    					
    					$('div.layer_company_info').each(function() {
    						if($(this).data('companyadmin') == companyAdminCode) {
    							$(this).find(".box__table").html(data);
    						}
    					});
    				}
    			});
    		});

    		// 전화상담 > 업체정보 레이어 외부 클릭 닫기
    		$(document).mouseup(function (e){
    			if(!$('.ri_img_title .left img').is(e.target) && $('.layer_company_info').has(e.target).length == 0 || $(e.target).hasClass('g-layer__dimm')) {
    				$(".layer_company_info").css("display", "none");
        		}
    		});
    		
    		// 전화상담 > 색상선택(외장)
    		$(document).on("click", "#write_form #requestExteriorColorList button", function() {    			
				var choiceChk = false;

				if($(this).hasClass("request-color--choice") === false) {
					choiceChk = true;
				}
				choiceChk = true;
    			var selectedColor = '';
    			var selectedRgbColor = '';

    			if ($(this).hasClass("request-color--choice")) {
    				$(this).removeClass("request-color--choice");
    			} else {
    				$("#write_form #requestExteriorColorList button").removeClass('request-color--choice')
    				$(this).addClass("request-color--choice");
    			}

    			$("#write_form #requestExteriorColorList .request-color__choice").empty();
    			
    			if ($("#requestExteriorColorList .request-color--choice").length) {
    				$("#requestExteriorColorList .request-color--choice").each(function(idx, element){
    					selectedColor += ", " + $(element).text();
    					selectedRgbColor += "," + rgb2hex($(element).css('background-color'));
    					$("#requestExteriorColorList .request-color__choice").append("<span class='txt'>"+$(element).text()+"</span>");
    				});
    			}
    			
    			if (selectedColor.length > 1) {
    				selectedColor = selectedColor.substr(1, selectedColor.length);
    			}
    			if(selectedRgbColor.length > 1) {
    				selectedRgbColor = selectedRgbColor.substr(1, selectedRgbColor.length);
    			}

    			$("#write_form input[name='carcolor']").val(selectedColor);
    			$("#write_form input[name='carRgbColor']").val(selectedRgbColor);
    			
				$("#requestInteriorColorList button").removeClass('request-color--disable');
				$("#requestInteriorColorList button").removeAttr('disabled');
				
				$("#requestExteriorColorList button").removeClass('request-color--disable');
				$("#requestExteriorColorList button").removeAttr('disabled');
    			if(choiceChk) {
        			var colorGroupArray = [];
    				
    				$(".request-color--choice").each(function() {
    					var colorGroup = $(this).attr("group");
    					if(colorGroup != "") {
        					if(colorGroup.indexOf(",") > -1) {
        						var tempArray = colorGroup.split(",");
        						tempArray.forEach(function(item){
        							colorGroupArray.push(item);
        						});
        					} else {
        						colorGroupArray.push($(this).attr("group"));
        					}
    					}
    				});
    				
    				colorGroupArray.forEach(function(item){
    					$("#requestExteriorColorList button").each(function () {
    						if($(this).hasClass("request-color--choice") === false) {
    							if($(this).attr("group").indexOf(item) > -1) {
    								$(this).addClass('request-color--disable');
    								$(this).attr('disabled', 'disabled');								
    							} 
    						}
    					});
    					
    					$("#requestInteriorColorList button").each(function () {
    						if($(this).hasClass("request-color--choice") === false) {
    							if($(this).attr("group").indexOf(item) > -1) {
    								$(this).addClass('request-color--disable');
    								$(this).attr('disabled', 'disabled');								
    							}							
    						}
    					});
    				});
    			}
    		});
    		
    		// 전화상담 > 색상선택(내장)
    		$(document).on("click", "#write_form #requestInteriorColorList button", function() {
				var choiceChk = false;
				if($(this).hasClass("request-color--choice") === false) {
					choiceChk = true;
				}
    			choiceChk = true;
    			var selectedColor = '';
    			var selectedRgbColor = '';
    			if ($(this).hasClass("request-color--choice")) {
    				$(this).removeClass("request-color--choice");
    			}
    			else {
    				$("#write_form #requestInteriorColorList button").removeClass('request-color--choice')
    				$(this).addClass("request-color--choice");
    			}
    			
    			$("#write_form #requestInteriorColorList .request-color__choice").empty();
    			
    			if ($("#requestInteriorColorList .request-color--choice").length) {
    				$("#requestInteriorColorList .request-color--choice").each(function(idx, element){
    					selectedColor += ", " + $(element).text();
    					selectedRgbColor += "," + rgb2hex($(element).css('background-color'));
    					if($(this).hasClass('request-color--twotone')) {
    						selectedRgbColor += ":" + rgb2hex($(this).find('span.color').css('background-color'));
    					}
    					$("#requestInteriorColorList .request-color__choice").append("<span class='txt'>"+$(element).text()+"</span>");
    				});
    			}
    			   			
    			if (selectedColor.length > 1) {
    				selectedColor = selectedColor.substr(1, selectedColor.length);
    			}
    			if(selectedRgbColor.length > 1) {
    				selectedRgbColor = selectedRgbColor.substr(1, selectedRgbColor.length);
    			}
    			
    			$("#write_form input[name='carInteriorColor']").val(selectedColor);
    			$("#write_form input[name='carRgbInteriorColor']").val(selectedRgbColor);
    			
				$("#requestInteriorColorList button").removeClass('request-color--disable');
				$("#requestInteriorColorList button").removeAttr('disabled');
				
				$("#requestExteriorColorList button").removeClass('request-color--disable');
				$("#requestExteriorColorList button").removeAttr('disabled');
    			if(choiceChk) {
        			var colorGroupArray = [];
    				
    				$(".request-color--choice").each(function() {
    					var colorGroup = $(this).attr("group");
    					if(colorGroup != "") {
        					if(colorGroup.indexOf(",") > -1) {
        						var tempArray = colorGroup.split(",");
        						tempArray.forEach(function(item){
        							colorGroupArray.push(item);
        						});
        					} else {
        						colorGroupArray.push($(this).attr("group"));
        					}    						
    					}
    				});
    				
    				colorGroupArray.forEach(function(item){
    					$("#requestExteriorColorList button").each(function () {
    						if($(this).hasClass("request-color--choice") === false) {
    							if($(this).attr("group").indexOf(item) > -1) {
    								$(this).addClass('request-color--disable');
    								$(this).attr('disabled', 'disabled');								
    							} 
    						}
    					});
    					
    					$("#requestInteriorColorList button").each(function () {
    						if($(this).hasClass("request-color--choice") === false) {
    							if($(this).attr("group").indexOf(item) > -1) {
    								$(this).addClass('request-color--disable');
    								$(this).attr('disabled', 'disabled');								
    							}							
    						}
    					});
    				});
    			}
    		});
    	}
    	else if (lnb == 'leaserentSimpleEstimate') {}
    	
    	else if (lnb == 'directMallBuyCounseling' || lnb == 'leaserentDealDetail') {
    		
    		//개인 정보 이름 데이터 삭제 버튼 노출 비노출 처리
    		$(document).on("keyup", "#write_form #userName", function(){
    			if ($(this).val().length == 0) {
    				$("#userName").parent('.inputbox').find('a').addClass('hide');
    			}
    			else {
    				$("#userName").parent('.inputbox').find('a').removeClass('hide');
    			}
    		});
    		
    		//개인 정보 이름 데이터 삭제
    		$(document).on("click", "#write_form #userNameDelete", function(){
    			$("#write_form #userName").val("");
    			$("#userName").parent('.inputbox').find('a').addClass('hide');
    			
    		});
    		
    		//개인 정보 전화번호 데이터 삭제 버튼 노출 비노출 처리
    		$(document).on("keyup", "#write_form #r-text_02", function(){
    			if ($(this).val().length == 0) {
    				$("#r-text_02").parent('.inputbox').find('a').addClass('hide');
    			}
    			else {
    				$("#r-text_02").parent('.inputbox').find('a').removeClass('hide');
    			}
    		});
    		
    		//개인 정보 전화번호 데이터 삭제
    		$(document).on("click", "#write_form #userPhoneDelete", function(){
    			$("#write_form #r-text_02").val("");
    			$("#r-text_02").parent('.inputbox').find('a').addClass('hide');
    			
    		});
    		
    		/** 비밀번호 체크 확인 프로세스 **/ 
    		$("#directMallPasswordCheck").click(function(event) {
    			event.preventDefault();
    			var param = {
    				boardNo : $("#directMallBoardNo").val(),
					inputPassword : $("#directMallInputPassword").val(),
					type : 'passwordCheck'
    			}
    			
    			$.ajax({
    				type:"GET",
    				url : "/service/ajax_leaserent_directMall.php",
    				data: param,
    				dataType : "json",
    				error : function(request, status, error) {
    					alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
    				},
    				success: function (data) {
    					if (data.code == 1) {
    						window.location.href = "/leaserent/?Work=directMallBuyCounseling&Tab=detail&no=" + $("#directMallBoardNo").val() + "&password=" + $("#directMallInputPassword").val();
    					}
    					else {
    						alert("비밀번호가 일치하지 않습니다.");
    					}
    				}
    			});
    		});
    		
    		/** 직영몰 수정 레이어 라인언 리스트 구성 **/
    		$(document).on('click', "#directMallModifyLineup", function(event){
    			event.preventDefault();
    			
    			if($("#directMallSelectBox").hasClass('selectbox-open')) {
    				$("#directMallSelectBox").removeClass('selectbox-open');
    				$("#directMallModifyTrimList").css('display', 'none');
    				return false;
    			}
    			
    			/* 모델  */
    			var model = $("#modelCode").val();
        		/* 트림  */		
        		var trim = $("#trimsCode").val();
        		/* 이용기간 */		
        		var monthTerm = $("#period").val();	
        		/*보증금/선납금 */		
        		var priceType = $("#priceType").val();	
        		/* 렌트리스 구분 */		
        		var prodType = $("#prodType").val();
      		
    			$.ajax({		
					type:"GET",		
					url : "/service/ajax_leaserent_productList.php",		
					dataType : "json",		
					data : {		
						"viewType" : 'directPcBlog',		
						"model" : model,		
						"trim" : trim,		
						"monthTerm" : monthTerm,		
						"prodType" : prodType,		
						"priceType" : priceType		
					},		
					error : function(request, status, error) {		
						alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);		
					},		
					success : function(data) {
						data = data.replace("<div class='mlc_more'><button class='mlcm_btn'></button></div>", "");
						$("#directMallModifyTrimList").html(data);
						$("#directMallModifyTrimList").css('display', 'block');
						$("#directMallSelectBox").addClass('selectbox-open');
						
						var trim = $("#trimsCode").val();
						$("cm" + trim).prop('checked', true);
						$("cm" + trim).focus();
					}		
				});
    		});
    		
    		// 전화상담 > 색상선택(외장)
    		$(document).on("click", "#write_form #requestExteriorColorList button", function() {
				var choiceChk = false;

				if($(this).hasClass("request-color--choice") === false) {
					choiceChk = true;
				}
				choiceChk = true;
    			var selectedColor = '';
    			var selectedRgbColor = '';

    			if ($(this).hasClass("request-color--choice")) {
    				$(this).removeClass("request-color--choice");
    			} else {
    				$("#write_form #requestExteriorColorList button").removeClass('request-color--choice')
    				$(this).addClass("request-color--choice");
    			}

    			$("#write_form #requestExteriorColorList .request-color__choice").empty();
    			
    			if ($("#requestExteriorColorList .request-color--choice").length) {
    				$("#requestExteriorColorList .request-color--choice").each(function(idx, element){
    					selectedColor += ", " + $(element).text();
    					selectedRgbColor += "," + rgb2hex($(element).css('background-color'));
    					$("#requestExteriorColorList .request-color__choice").append("<span class='txt'>"+$(element).text()+"</span>");
    				});
    			}
    			
    			if (selectedColor.length > 1) {
    				selectedColor = selectedColor.substr(1, selectedColor.length);
    			}
    			if(selectedRgbColor.length > 1) {
    				selectedRgbColor = selectedRgbColor.substr(1, selectedRgbColor.length);
    			}

    			$("#write_form input[name='carcolor']").val(selectedColor);
    			$("#write_form input[name='carRgbColor']").val(selectedRgbColor);
    			
				$("#requestInteriorColorList button").removeClass('request-color--disable');
				$("#requestInteriorColorList button").removeAttr('disabled');
				
				$("#requestExteriorColorList button").removeClass('request-color--disable');
				$("#requestExteriorColorList button").removeAttr('disabled');
    			if(choiceChk) {
        			var colorGroupArray = [];
    				
    				$(".request-color--choice").each(function() {
    					var colorGroup = $(this).attr("group");
    					if(colorGroup != "") {
        					if(colorGroup.indexOf(",") > -1) {
        						var tempArray = colorGroup.split(",");
        						tempArray.forEach(function(item){
        							colorGroupArray.push(item);
        						});
        					} else {
        						colorGroupArray.push($(this).attr("group"));
        					}
    					}
    				});
    				
    				colorGroupArray.forEach(function(item){
    					$("#requestExteriorColorList button").each(function () {
    						if($(this).hasClass("request-color--choice") === false) {
    							if($(this).attr("group").indexOf(item) > -1) {
    								$(this).addClass('request-color--disable');
    								$(this).attr('disabled', 'disabled');								
    							} 
    						}
    					});
    					
    					$("#requestInteriorColorList button").each(function () {
    						if($(this).hasClass("request-color--choice") === false) {
    							if($(this).attr("group").indexOf(item) > -1) {
    								$(this).addClass('request-color--disable');
    								$(this).attr('disabled', 'disabled');								
    							}							
    						}
    					});
    				});
    			}
    		});
    		
    		// 전화상담 > 색상선택(내장)
    		$(document).on("click", "#write_form #requestInteriorColorList button", function() {
				var choiceChk = false;
				if($(this).hasClass("request-color--choice") === false) {
					choiceChk = true;
				}
    			choiceChk = true;
    			var selectedColor = '';
    			var selectedRgbColor = '';
    			if ($(this).hasClass("request-color--choice")) {
    				$(this).removeClass("request-color--choice");
    			}
    			else {
    				$("#write_form #requestInteriorColorList button").removeClass('request-color--choice')
    				$(this).addClass("request-color--choice");
    			}
    			
    			$("#write_form #requestInteriorColorList .request-color__choice").empty();
    			
    			if ($("#requestInteriorColorList .request-color--choice").length) {
    				$("#requestInteriorColorList .request-color--choice").each(function(idx, element){
    					selectedColor += ", " + $(element).text();
    					selectedRgbColor += "," + rgb2hex($(element).css('background-color'));
    					if($(this).hasClass('request-color--twotone')) {
    						selectedRgbColor += ":" + rgb2hex($(this).find('span.color').css('background-color'));
    					}
    					$("#requestInteriorColorList .request-color__choice").append("<span class='txt'>"+$(element).text()+"</span>");
    				});
    			}
    			   			
    			if (selectedColor.length > 1) {
    				selectedColor = selectedColor.substr(1, selectedColor.length);
    			}
    			if(selectedRgbColor.length > 1) {
    				selectedRgbColor = selectedRgbColor.substr(1, selectedRgbColor.length);
    			}
    			
    			$("#write_form input[name='carInteriorColor']").val(selectedColor);
    			$("#write_form input[name='carRgbInteriorColor']").val(selectedRgbColor);
    			
				$("#requestInteriorColorList button").removeClass('request-color--disable');
				$("#requestInteriorColorList button").removeAttr('disabled');
				
				$("#requestExteriorColorList button").removeClass('request-color--disable');
				$("#requestExteriorColorList button").removeAttr('disabled');
    			if(choiceChk) {
        			var colorGroupArray = [];
    				
    				$(".request-color--choice").each(function() {
    					var colorGroup = $(this).attr("group");
    					if(colorGroup != "") {
        					if(colorGroup.indexOf(",") > -1) {
        						var tempArray = colorGroup.split(",");
        						tempArray.forEach(function(item){
        							colorGroupArray.push(item);
        						});
        					} else {
        						colorGroupArray.push($(this).attr("group"));
        					}    						
    					}
    				});
    				
    				colorGroupArray.forEach(function(item){
    					$("#requestExteriorColorList button").each(function () {
    						if($(this).hasClass("request-color--choice") === false) {
    							if($(this).attr("group").indexOf(item) > -1) {
    								$(this).addClass('request-color--disable');
    								$(this).attr('disabled', 'disabled');								
    							} 
    						}
    					});
    					
    					$("#requestInteriorColorList button").each(function () {
    						if($(this).hasClass("request-color--choice") === false) {
    							if($(this).attr("group").indexOf(item) > -1) {
    								$(this).addClass('request-color--disable');
    								$(this).attr('disabled', 'disabled');								
    							}							
    						}
    					});
    				});
    			}
    		});
    		
    		$(document).on("click", ".row_pay li, .row_period li, .row_rent li", function() {    			
    			var model = $("#modelCode").val();
    			var trim = $("#trimsCode").val();
    			var prodType = $("#write_form .rs_option .row_rent li.select").data('prodtype');
    			var monthTerm = $("#write_form .rs_option .row_period li.select").data('month');
    			var priceType = $("#write_form .rs_option .row_pay li.select").data('pricetype');
    			
    			$("#write_form #prodType").val(prodType);
    			$("#write_form #period").val(monthTerm);
    			$("#write_form #priceType").val(priceType);
    			
    			$.ajax({		
					type:"GET",		
					url : "/service/ajax_leaserent_directMall.php",		
					dataType : "json",		
					data : {		
						"type" : 'leaseRentProduct',		
						"model" : model,
						"trim" : trim,
						"monthTerm" : monthTerm,		
						"prodType" : prodType,		
						"priceType" : priceType		
					},		
					error : function(request, status, error) {		
						alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);		
					},		
					success : function(data) {
						$("#leaserentMonthPrice span").text(number_format(data.leaseRentData[0].nMonthPayment));
						$("#write_form #requestNo").val(data.leaseRentData[0].sCompanyProductCode);
						// 옵션에 따른 가격 재 설정
	    				$("#Optn_1 .eChkItemList input:checked").each(function(e){
	    					$(this).prop('checked', true);
	    					$(this).trigger('click');
	    					$(this).prop('checked', true);
	    				});
					}		
				});
    		});

    		$(document).on("change", 'input[name="carModel[]"]', function() {    					
    			var model = $("#modelCode").val();
    			var trim = $(this).val();
    			var prodType = $("#write_form .rs_option .row_rent li.select").data('prodtype');
    			var monthTerm = $("#write_form .rs_option .row_period li.select").data('month');
    			var priceType = $("#write_form .rs_option .row_pay li.select").data('pricetype');
    			
    			$("#trimsCode").val(trim);
    			
    			$.ajax({		
					type:"GET",		
					url : "/service/ajax_leaserent_directMall.php",		
					dataType : "json",		
					data : {		
						"type" : 'leaseRentProductWithTrims',		
						"model" : model,
						"trim" : trim,
						"monthTerm" : monthTerm,		
						"prodType" : prodType,		
						"priceType" : priceType		
					},		
					error : function(request, status, error) {		
						alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);		
					},		
					success : function(data) {
						$("#leaserentMonthPrice span").text(number_format(data.leaseRentData[0].nMonthPayment));
						$("#directMallTrimPrice").text(number_format(data.trimsData[0]['trimPrice']*0.3));
						$("#write_form .directmall_txt").html("고객님이 선택하신 차량은<br>" + data.trimsData[0]['sRentLeaseDueDayText']);
						
						$("#write_form #requestNo").val(data.leaseRentData[0].sCompanyProductCode);
						$("#write_form #monthPaymentWithOptions").val('');
						$("#directMallSelectBox").removeClass('selectbox-open');
						
						var ebox = "1";
						var emod = 'leaserent';
						var estmDataAuto = new Array();
						var estmOptionRank = new Array();
						var valCode = new Array();					
						var selectTrims = "T" + $("#trimsCode").val();

						if ($("#trimsCode").val() && data.estmDataAuto[selectTrims] != undefined) {
							var optionTypeList = {'undefined':'미지정', '1':'기본옵션/패키지', '2':'튜닝/액세서리'}
							var txt = "";
							var addBtn = "";
							var helpDiv = "";
							var toggleBtn = "";
							var moreBtn = moreOnOff = "";
							var moreCheckIndex = 0;
							var optionDetail = new Array();
							
							valCode.brnd = $("#brandCode").val();
							valCode.modl = $("#modelCode").val();
							//valCode.line = $("#lineupCode").val();
							valCode.trms = $("#trimsCode").val();
							
							//트림 정보 불러오기 
							dnw_array2(data.estmDataAuto[selectTrims], "setTrms");
							
							if(setTrms.name) {
								var nameArray = setTrms.name.split('`');
								$("#directMallModifyLineup").text(nameArray[2] + " " + nameArray[3] + " " + nameArray[5]);
								$("#write_form #requestAllLineupTrimsTitle").val('_' + nameArray[2] + " " + nameArray[3] + "_(" + nameArray[4] + ")_" + nameArray[5] + "_" + nameArray[6].replace('/T', ''));
							}
							
							$("#directMallModifyTrimList").css('display', 'none');
							$("#leaserentAfterMonthPrice").addClass('off');
							
							//옵션 리스트 생성
							if (setTrms.options) {
								var tmp = setTrms.options.split("!");
								var trimCode = valCode.trms
								var modelCode = valCode.trms
								var optionTypeText = '';
								$.each(tmp, function(index, val){
									var optionInfo = val.split("`");
									var optionAddInfo = '';
									var toggleOnOff = 'close';

									if (moreCheckIndex > 3 && moreBtn == '') {
										moreOnOff = 'off';
										
										moreBtn = "<div class='choice-more choice-more--close '>\
														<a href='javascript:void(0)' class='choice-more__btn sendGA' data-actionlabel='옵션 액세서리 더보기`"+modelCode+"'><span class='txt'>더보기</span></a>\
													</div>";
									}
									
									moreCheckIndex++;
									
									//옵션 상세
									var optionDetail = new Array();

									if (setTrms.optionDeatil) {
										var temp = setTrms.optionDeatil.split("!");
										
										$.each(temp, function(index, val){
											var temp2 = val.split("`");
											
											if(optionDetail["O"+temp2[0]]) {
												optionDetail["O"+temp2[0]] += '#' + temp2[1];
											}
											else {
												optionDetail["O"+temp2[0]] = temp2[1];				
											}
										});
									}

									if(emod == 'compare') {
									}
									else {
										if(optionDetail[optionInfo[0]]) {
											addBtn = "<a href='javascript:void(0);' class='sendGA g-btn__info eFincPopup' kind='option' val='"+ optionInfo[0] +"' data-actionlabel='옵션 상세정보`"+trimCode+"'>상세정보 보기</a>";
											
										}
										else {
											addBtn = "";
											helpDiv = "";
										}
										
										if(optionDetail["O"+optionInfo[0]]) {
											
											toggleBtn = "<div class='choice-toggle__btn'><a href='javascript:void(0)' class='btn-toggle "+toggleOnOff+"'><span class='blind'>접기</span></a></div>";
											
											var detailTemp = optionDetail["O"+optionInfo[0]].split("#");
											var detailTxt = '';
											
											$.each(detailTemp, function(optionDetailKey, optionDetailVal){
												var optionExplainTxt = "";
												var optionPhotoTxt = "";
												var optionDetailVal = optionDetailVal.replace('&amp;', '&').split(";");
												
												//설명
												if (optionDetailVal[2]) {
													optionExplainTxt = "<div class='exp'>"+ optionDetailVal[2] +"</div>";
												}
												
												//사진
												if (optionDetailVal[3]) {
													optionPhotoTxt = 
														"<div class='photo'>" +
														"<img src='"+ optionDetailVal[3] +"' alt='"+ optionDetailVal[1] +"' onerror='imageError(this, &quot;80_80.gif&quot;)'>" +
														"</div>";
												}
												
												var optionNumber = optionDetailKey + 1;
												
												detailTxt += 
													"<div class='infodetail__cont'>" +
													"<h4 class='title'>"+ optionNumber + ". " + optionDetailVal[1] +"</h4>" +
													optionPhotoTxt +
													optionExplainTxt +
													"</div>";
											});
											
											helpDiv = "<div class='choice-toggle__cont'>\
															"+detailTxt+"\
															<div class='infodetail__btn'>\
																<label for='popupItem_"+ ebox + optionInfo[0] +"' class='btn-check btn-check--option sendGA' data-actionlabel='옵션 펼쳐보기 내 선택`"+ optionInfo[1] +"'></label>\
															</div>\
															<div class='choice-toggle__close mobOnly'>\
																<a href='javascript:void(0)' class='btn-toggle-close sendGA' data-actionlabel='옵션 펼쳐보기 내 선택`영역 닫기'><span class='txt'>닫기</span></a>\
															</div>\
														</div>"
												
										}
										else {
											addBtn = "";
											helpDiv = "";
											toggleBtn = "";
										}
									}
									
									var value = '';
									
									if(optionInfo[3]) {
										value = dnw_enChar(optionInfo[0]+ "`" +optionInfo[2]+ ":" + optionInfo[3] + "`" + optionInfo[1]);					
									}
									else {
										value = dnw_enChar(optionInfo[0]+ "`" +optionInfo[2]+ "`" + optionInfo[1]);					
									}
									
									if(emod == 'compare') {					
									}
									else {
										var optionPrice = 0;
										
										if(Math.abs(optionInfo[2])>100){
											optionPrice = "<span class='txt'><span class='num'>"+number_format(optionInfo[2]/10000)+"</span>만 원</span>";
										}

										if (optionTypeText != optionInfo[4]) {
											
											if (optionTypeText != '') {
												txt += "</div></div>";
											}

											optionTypeText = optionInfo[4];
											
											txt += "<div class='article-box'>\
										                <div class='article-box__header'>\
										                    <h4 class='title'>"+optionTypeList[optionTypeText]+"</h4>\
										                </div>\
										                <div class='article-box__cont'>";
										}
										
										if (data.estmOptionRank != null && data.estmOptionRank["T"+trimCode+"O"+optionInfo[0]]) {
											optionAddInfo += "<span class='g-label-top'>TOP"+data.estmOptionRank["T"+trimCode+"O"+optionInfo[0]]+"</span>";
										}
										
										txt += "<div class='choice-toggle choice-toggle--"+toggleOnOff+ " " + moreOnOff + "'>\
													<input id='popupItem_"+ ebox + optionInfo[0] +"' title='옵션품목' name='option[]' value='"+ value +"' type='checkbox' data-overlap='"+ optionInfo[3] +"' code='"+ optionInfo[0] +"' "+$("#item_1"+optionInfo[0]).attr('checked')+">\
													<div class='choice-toggle__header sendGA' data-actionlabel='옵션 펼쳐보기`"+optionInfo[1]+"'>\
														<label for='popupItem_"+ ebox + optionInfo[0] +"'>"+optionInfo[1]+"</label>\
														<div class='choice__check'><span class='icon_check'></span></div>\
														<div class='choice__wrap'>\
															<div class='choice__cell choice__info'><span class='txt'>"+optionInfo[1]+"</span>"+addBtn+optionAddInfo+"</div>\
															<div class='choice__cell choice__price'>"+optionPrice+"</div>\
														</div>\
														"+toggleBtn+"\
													</div>\
													"+helpDiv+"\
									            </div>";
									}
								});
								
								if (moreBtn) {
									txt += moreBtn;
								}
								txt += "</div></div>";
								
					    		$("#Optn_"+ebox+" .eChkItemList").html(txt);
							}
							else {
								$("#Optn_"+ebox).addClass('hide');
							}
						}
						else {
							$("#Optn_"+ebox).addClass('hide');
						}
					}		
				});
    		});
    		
    		$("a[id^='directMallListButton']").click(function(event){
    			event.preventDefault();
    			window.location.href = "/leaserent/?Work=directMallBuyCounseling";
    		});
    		
    		$("a[id^='directMallRemoveButton']").click(function(event){
    			event.preventDefault();
    			
    			if(confirm("신청을 취소 하시겠습니까?")) {
	    			var CRequestNo = $("#CRequestNo").val();
	    			var CBoardNo =$("#CBoardNo").val();
	    			$.ajax({		
						type:"POST",		
						url : "/service/ajax_leaserent_directMall.php",		
						dataType : "json",		
						data : {		
							"type" : 'directMallRequestDelete',		
							"CRequestNo" : CRequestNo,
							"CBoardNo" : CBoardNo
						},		
						error : function(request, status, error) {		
							alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);		
						},
						success: function (data) {
							if(data.code > 0) {
								alert(data.message);
								window.location.reload(true);							
							} else {
								alert(data.message);
								window.location.reload(true);
							}
						}
	    			});
    			}
    		});
    	}
    	else if(lnb == "mediumTermSearch") {
    		
    		$(document).on("keyup","#requestContents", function() {
		        $('#requestContentsCnt').html("("+$(this).val().length+" / 300)");
		 
		        if($(this).val().length > 300) {
		            $(this).val($(this).val().substring(0, 300));
		            $('#requestContentsCnt').html("(300 / 300)");
		        }
		    });

    		// 세부모델
			$(document).on('click', "#showDetailModel", function(){
				var detailModelUrl = webUrl+"/service/ajax_mediumrent_detailModel.php";
				var modelCode = $(this).data('model');
				
				// 세부모델 보기
				if($(this).children(".btn_detail").hasClass("btn_detail_close") == false) {
					$.ajax({ 
						type: 'POST', 
						url: detailModelUrl, 
						data:{
							brandCode: $(this).data('brand'),
							modelCode: $(this).data('model'),
							period: $(this).data('month'),
							prodType: $(this).data('prodtype'),
							brandName: $(this).data('brandname'),
							modelName: $(this).data('modelname'),
						},
						dataType : 'html', 
						success: function(data) {
		    				$("#monthPrice_"+modelCode).after(data);
						}
					});
					
					$(this).children(".btn_detail").addClass("btn_detail_close");
    				$(this).children(".btn_detail").text("세부모델닫기");
				} else { // 세부모델 닫기
					$("#detail_"+modelCode).remove();
					
					$(this).children(".btn_detail").removeClass("btn_detail_close");
    				$(this).children(".btn_detail").text("세부모델보기 +"+$(this).data("count"));
				}
			});
    		
    		// 상담신청 레이어 열기
    		$(document).on("click","a[id^='openRequestLayer_']",function(){
    			var popupTitle = '다나와자동차 렌트리스 상담신청';
    			
    			$.ajax({ 
    				type: 'POST', 
    				url: 'mediumTermEstimate.php', 
    				data : {		
						"nBrandCode" : $(this).data("brandcode"),		
						"nModelCode" : $(this).data("modelcode"),
						"nLineupCode" : $(this).data("lineupcode"),
						"nTrimsCode" : $(this).data("trimscode"),
						"nPeriod" : $(this).data("period"),		
						"sProdType" : $(this).data("prodtype"),
						"sBrandName" : $(this).data("brandname"),
						"sModelName" : $(this).data("modelname"),
						"sLineupName" : $(this).data("lineupname"),
						"sTrimsName" : $(this).data("trimsname"),
						"nYear" : $(this).data("year"),
						"nMinPrice" : $(this).data("minprice"),
						"nMaxPrice" : $(this).data("maxprice")
					},
    				dataType : 'html', 
    				success: function(data) {
    					$("#layerPopup .g-layer__cont").empty().html(data);
    					$("#layerPopup .g-layer__wrap").draggable({disabled:true})

    					openLayerPopup('dim', popupTitle);
    				},complete : function() {
    					$("#autodanawa_popup .bg").css("height",$(document).height()*(1.1));
    			    }
    			});
    		});
    		
    		// 전화상담 > 상담내용
    		$(document).on("keyup", "#requestContents", function(){
    			if ($(this).val().length == 0) {
    				$("#requestContents").parent(".textareabox").find('label').removeClass('hide');
    			}
    			else {
    				$("#requestContents").parent(".textareabox").find('label').addClass('hide');
    			}
    		});
    		
    		/** 인증번호 발송 이벤트 **/
    		$(document).on("click","#certifyRequestItem #certifyRequestBtn",function(event) {
    			event.preventDefault();

    			if($(this).hasClass("certify-request__btn--disable") === true) {
    				$(this).removeClass("certify-request__btn--disable");
    				$(this).text("인증요청");
    				$("#r-text_02").parents('div').removeClass("inputbox--disable");
    				$("#r-text_02").val("");
    				$("#certifySuccessItem").hide();
    				$("#certifyNumberItemText").hide();
    				$("#certifyTime").text("3:00");
    				$("#r-text_02").attr("disabled", false);
    				
					/** 전화번호 값 저장 **/
					$("#validatedPhoneNumber").val("");
					$("#validatedPhoneNumber").trigger("change");
    				
    			} else {
        			var userName = $(".request-personal #userName").val();
        			var phoneNumber = $(".request-personal #r-text_02").val();

        			if($.trim(userName) == "") {
        				$(".request-personal #userName").val("");
        				$(".request-personal #userName").focus();
        				return false;
        			} else if(phoneNumber == "") {
        				$(".request-personal #r-text_02").focus();
        				return false;
        			}

        			$.ajax({
        				type:"POST",
        				url : webUrl+"/service/ajax_sendSms.php",
        				data: {
            				processKind: 'easyCertification',
            				name : $(".request-personal #userName").val(),
            				phoneNumber : $("#r-text_02").val(),
            				serviceType : 2
            			},
        				dataType : "json",
        				error : function(request, status, error) {
        					alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
        				},
        				success: function (data) {
        					if(data.result) {
        						alert(data.message);
        						
        						if(data.tempRandNum > 0) {
        							alert(data.tempRandNum);
        						}
        						$("#certifyPhoneNumber").val(phoneNumber);
        						clearInterval(certificationObj);
        						certificationTime = 180;
        						certificationMin = "";
        						certificationSec = "";
        						
        						$("#certifyNumber").val("");
        						$("#certifyNumberItem").show();
        						$("#certifyNumberItemText").show();
        						$("#certifyTimeout").hide();
        						
        						certificationObj = setInterval(certificationTimeout, 1000);
        						
        						$(document).on("click","#layerPopup .btn-close", function(){
        							clearInterval(certificationObj);
        						});
        					} else {
        						alert(data.message);
        						return false;
        					}
        				}
        			});
    			}
    		});
    		
    		/** 인증번호 확인 이벤트 **/
			$(document).on("click", "#certifyCheckBtn", function(e) {
				
				var userName = $(".request-personal #userName").val();
				var phoneNumber = $("#certifyPhoneNumber").val();
				var certifyNumber = $("#certifyNumber").val();
				
				/** 입력 유효성 체크 **/
    			if($.trim(userName) == "") {
    				$(".request-personal #userName").val("");
    				$(".request-personal #userName").focus();
    				return false;
    			} else if(phoneNumber == "") {
    				$(".request-personal #r-text_02").focus();
    				return false;
    			}

    			$.ajax({
    				type:"POST",
    				url : webUrl+"/service/ajax_sendSms.php",
    				data: {
        				processKind: 'certificationNumberChk',
        				userName : userName,
        				phoneNumber : phoneNumber,
        				certifyNumber : certifyNumber,
        				serviceType : 2
    				},
    				dataType : "json",
    				error : function(request, status, error) {
    					alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
    				},
    				success: function (data) {
    					if(data.result) {
    						clearInterval(certificationObj);
    						$("#certifyNumberItem").hide();
    						$("#certifySuccessItem").show();
    						$("#r-text_02").parents('div').addClass('inputbox--disable');
    						$("#certifyRequestBtn").addClass('certify-request__btn--disable');
    						$("#certifyRequestBtn").text('번호변경');
    						$("#r-text_02").attr("disabled", true);
    						
    						/** 전화번호 값 저장 **/
    						$("#validatedPhoneNumber").val(phoneNumber.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"));
    						$("#validatedPhoneNumber").trigger("change");
    						
    						if(phoneNumber.length == 11) {
    							phoneNumber = phoneNumber.substring(0,3) + "****" + phoneNumber.substring(phoneNumber.length-4, phoneNumber.length);
    						} else {
    							phoneNumber = phoneNumber.substring(0,3) + "***" + phoneNumber.substring(phoneNumber.length-4, phoneNumber.length);
    						}
    						$("#r-text_02").val(phoneNumber);
    						
    						var date = new Date();
    						date.setTime(date.getTime() + (180 * 1000)); //3분
    						$.cookie('mediumTermCertifiy', data.leaserentCertifiy, { expires: 1 });
    						$.cookie('mediumTermCertifiyNum', data.leaserentCertifiyNum, { expires: 1 });
    						$.cookie('mediumTermCertifiyName', data.leaserentCertifiyName, { expires: 1 });
    					} else {
    						alert(data.message);
    					}
    				}
    			});
			});
			
    		// 전화상담 > 시도선택
    		$(document).on("change", "#sido", function () {
    			var sidoCode = $(this).val();
    			var sidoName = $("#sido option:selected").html();

    			$.get(
    					"../service/ajax_auto_sigunguSelect.php",
    					{
    					    Sido:sidoCode,
    					    Type:"name"
    					},
    					function (data, status) {
    						if (status == "success") {
    							$("#sigungu").html(data.replace("전지역", "시/군/구")).parent().find('label').addClass('hide').find('.placeholder').text('시/군/구');
    							
    							if ($("#requestPersonal input[name='name']").val() &&
    									($("#requestPersonal input[name='validatedPhoneNumber']").val())
    									&& $("#requestAgree #agreeCheck1").is(":checked") 
    									&& $("#requestAgree #agreeCheck2").is(":checked") 
    									&& $("#requestPersonal #sigungu").val()) {
    				    				$("#mediumTermRequestSubmit").addClass('on');
    				    	    	} else {
    				    	    		$("#mediumTermRequestSubmit").removeClass('on');
    				    	    	}
    							/*if($("#requestForm #sigungu").data('actionlabel') != "") {
    								$("#requestForm #sigungu").val($("#requestForm #sigungu").data('actionlabel'));
    							}
    							
    							sendGA('블로그_전화상담 견적요청', '시도');*/
    						}
    					}
    				);
    		});
    		
    		// 전화상담 > 동의
    		$(document).on('click', "#requestAgree .btn-toggle", function() {
    			var $selectAgree = $(this).closest("dl");
    			if ($selectAgree.hasClass("g-agree--open")) {
    				$selectAgree.removeClass("g-agree--open");
    				$selectAgree.addClass("g-agree--close");
    			}
    			else {
    				$selectAgree.removeClass("g-agree--close");
    				$selectAgree.addClass("g-agree--open");
    			}
    		});
    		
    		// 상담신청완료 버튼 활성화 체크
    		$(document).on("change", "#requestPersonal input[name='name'], " +
    				"#requestPersonal input[name='validatedPhoneNumber'], " +
    				"#requestAgree #agreeCheck1, " +
    				"#requestAgree #agreeCheck2, " +
    				"#requestPersonal #sigungu ", function(){
    			if ($("#requestPersonal input[name='name']").val() &&
					($("#requestPersonal input[name='validatedPhoneNumber']").val())
					&& $("#requestAgree #agreeCheck1").is(":checked") 
					&& $("#requestAgree #agreeCheck2").is(":checked") 
					&& $("#requestPersonal #sigungu").val()) {
    				$("#mediumTermRequestSubmit").addClass('on');
    	    	} else {
    	    		$("#mediumTermRequestSubmit").removeClass('on');
    	    	}
    	    });
    		
    		// 전화상담 > 견적요청
    		$(document).on("click", "#mediumTermRequestSubmit.on", function() {
	
    			var vaildMsg = "";
    			var tranName = $("#requestPersonal input[name='name']").val().replace(/[^가-힣a-zA-Z]/gi, "");
    			
    			$("#mediumTermRequestSubmit").removeClass('on');
    			    			
    			// 유효성 검사
    			if ($("#requestPersonal input[name='name']").val() == "") vaildMsg = "이름을 반드시 입력해 주세요.";
    			else if ($("#requestPersonal input[name='name']").val().length > 0 && (tranName.length < 2 || $("#write_form input[name='name']").val() != tranName)) vaildMsg = "이름을 바르게 입력했는지 다시 확인해주세요.";
    			else if ($("#requestPersonal input[name='validatedPhoneNumber']").val() == "") vaildMsg = "휴대전화번호를 반드시 입력해 주세요.";
    			else if ($("#requestPersonal input[name='validatedPhoneNumber']").val().length < 10) vaildMsg = "휴대전화번호를 바르게 입력했는지 다시 확인해주세요.";
    			else if (($("#requestPersonal select[name='sido']").val() == "") || ($("#requestPersonal select[name='sigungu']").val() == "")) vaildMsg = "지역을 선택해주세요.";
    			else if (!$("#requestAgree #agreeCheck1").is(":checked") || !$("#requestAgree #agreeCheck2").is(":checked")) vaildMsg = "개인정보 수집 및 제3자 제공에 동의해야 견적 요청이 가능합니다.";
    			
    	        if (vaildMsg != "") {
    	        	$("#mediumTermRequestSubmit").addClass('on');
    		        alert(vaildMsg);
    		        return false;
    	        }
    		 	
    	        // 상담신청
    		 	if (1 && vaildMsg == "") {
    		 		var url = webUrl+"/action/ssl.mediumrent.request.action.php";
    				
    				if (bIsReal) {
    					url = "https://auto.danawa.com/action/ssl.mediumrent.request.action.php";
        			}
    				
    				if($("#write_form #adReceiveCheck").is(":checked")) {
    					$("#write_form #adReceiveCheck").val("Y");
    				} else {
    					$("#write_form #adReceiveCheck").val("N");
    				}
    				
    				// 견적요청 선택옵션값 셋팅
    				var optionTemp = "";
    				if($("#write_form #option1").is(":checked")) {
    					optionTemp += $("#write_form #option1").next("label").text();
    				}
    				
    				if($("#write_form #option2").is(":checked")) {
    					if(optionTemp != "") optionTemp += ",";
    					optionTemp += $("#write_form #option2").next("label").text();
    				}
    				
    				if($("#write_form #option3").is(":checked")) {
    					if(optionTemp != "") optionTemp += ",";
    					optionTemp += $("#write_form #option3").next("label").text();
    				}
    				
    				$("#write_form input[name='sOption']").val(optionTemp);
    				
    				$('#write_form').ajaxForm({
    					url: url,
    					enctype: "multipart/form-data",
    					type: 'POST',
    					async: false,
    					dataType : 'json',
    					error: function (request,status,error) {
							console.log("code = "+ request.status + " message = " + request.responseText + " error = " + error);
						},
    					success: function(data){
    						if(bIsReal) {
        						naverScript(1, 100000000);
        						
    							if(DmpScriptModule) {
    								DmpScriptModule.actionUrl(webUrl+'/occasion/2110_mediumTermRentLeaseScript.php?trk_pnc='+$("#write_form input[name='nBrandCode']").val()+""+$("#write_form input[name='nModelCode']").val());
    							}
        						
        						sendGA("상담신청완료",$("#write_form input[name='sModelName']").val());
    						}
    						alert(data.message);
    					},
    					complete: function () {
    						$("#mediumTermRequestSubmit").addClass('on');
						    						window.location.reload(true);
    					}
    				});
    				
    				$("#write_form").submit();
    				return false;
    			}
    		});
    	}
    	
    	// 용어사전 .eButtonHelp 2205 임시 추가 KYH
        $(document).on("click",".buttonHelp, .eButtonHelp",function(){
    		getHttprequest("/dictionary/dictionary.php?Dterm="+$(this).attr("val"), "layerPopup .g-layer__cont");
    		openLayerPopup('popup', '용어사전');
    		
    		//용어사전 팝업시 웹 접근성 수정
			window.setTimeout(function(){
		        var target = $("#layerPopup:visible").attr("tabindex","-10").focus();
		    },500);
			
			return false;
    	});
    }
    // 신차 스크립트
    else if (gnb == 'newcar') {
    	$(document).ready(function(){
    		if($('main .banner a').length && $('main .banner a').index() > -1) {
    			$('main .banner a:eq('+ Math.floor(Math.random() * ($('main .banner a').index() + 1)) +')').show();
    		}
    	})
    	
    	// 검색 초기화..
		$(document).on("click",".button_reset",function(){
			$('#requestForm').children().find('input,select').each(function(idx, e){
				if (e.tagName) switch (e.tagName.toLowerCase()) {
		         case 'input':
		            switch (e.type) {
		               case "radio":
		               case "checkbox": e.checked = false; break;
		               case "button":
		               case "submit":
		               case "image": break;
		               default: e.value = ''; break;
		            }
		            break;
		         case 'select': e.selectedIndex = 0; break;
		         case 'textarea': e.innerHTML = ''; break;
		         default: clearChildren(e);
		      }
			});
		});
    	
    	$(document).on('click', '#clickInsure', function() {
			eval('try{ _trk_clickTrace( \'EVT\', \'자동차_삼성 보험 버튼_견적(웹)\' ); }catch(_e){ }');
		});
	
		$(document).on('click', '#directInsureCheck', function() {
			eval('try{ _trk_clickTrace( \'EVT\', \'자동차_삼성 보험 버튼_보험 안내(웹)\' ); }catch(_e){ }');
		});
    	
    	$(document).on('click', '#autoCashback #cash_cancel', function() {
    		$('#autoCashback input[type=text]').val('');
    		$('#autoCashback #phone1 option:eq(0)').attr('selected', 'selected');
    		$('#autoCashback #agreeCk').attr('checked', false);
    	});

    	$(document).on('click', '#autoCashback #cash_submit', function() {
    		var isValidation = true;

    		if (isValidation == true && $('#autoCashback #name').val().trim().length == 0) {
    			alert('이름을 입력해주세요.');
    			$('#autoCashback #name').focus();
    			isValidation = false;
    		}

    		if (isValidation == true && $('#autoCashback #phone2').val().trim().length == 0) {
    			alert('연락처를 입력해주세요.');
    			$('#autoCashback #phone2').focus();
    			isValidation = false;
    		}
    		else if (isValidation == true && $.isNumeric($('#autoCashback #phone2').val()) == false) {
    			alert('숫자만 입력 가능합니다.');
    			$('#phone2').focus().val('');
    			isValidation = false;
    		}

    		if (isValidation == true && $('#autoCashback #phone3').val().trim().length == 0) {
    			alert('연락처를 입력해주세요.');
    			$('#autoCashback #phone3').focus().val('');
    			isValidation = false;
    		}
    		else if (isValidation == true && $.isNumeric($('#autoCashback #phone3').val()) == false) {
    			alert('숫자만 입력 가능합니다.');
    			$('#autoCashback #phone3').focus().val('');
    			isValidation = false;
    		}

    		if (isValidation == true && $('#autoCashback #agreeCk').is(':checked') == false) {
    			alert('개인정보 수집 및 이용안내에 동의하셔야 합니다.');
    			$('#autoCashback #agreeCk').focus();
    			isValidation = false;
    		}

    		if (isValidation == true) {
    			document.autoCashback.submit();
    		}
    	});

    	//estmRankList
    	$(document).on('click', '.estmRankList span[name="newcarSales"]', function() {
    		getHttprequest("/theme/modelSales.php?model="+ $(this).attr('model') + '&brand=' + $(this).attr('brand'),'popup_data');
    		openPopup($(this).parent().parent().find('.title a').text() + ' 판매조건', 600, 'center');
    	});
    	
    	$("#popRequest .btn-confirm, #popRequest.g-layer, #popRequest .btn-close").on("click", function(e){
    		e.stopPropagation()
    		
    		if ($(e.target).hasClass('g-layer') || $(e.target).hasClass('g-layer__dimm') || $(e.target).hasClass('btn-confirm') || $(e.target).hasClass('btn-close')) {
    			$("#popRequest").addClass('off').removeClass('g-layer--dimm');
			}
    	});
    	
    	$("#buyCommentLogin").hover(
			function(){
	    		$('#commentLayer').show();
	    	},
	    	function(){
	    		$('#commentLayer').hide();
	    	}
	    );
    	
    	$(document).on("click", "#consultRequest", function(){
    		if($.cookie('dasysMSeq') && $.cookie("dasysNick")) {
    			if($.cookie("dasysMcut")) {
    				if($.cookie("dasysMcut").indexOf('B') > -1 || $.cookie("dasysMcut").indexOf('b') > -1){
    					alert("글쓰기가 제한된 이용자입니다.");
    				}
    			}
    			else {
    				if(lnb =='importedcar') {
    					window.location.href = "/buy/?Work=request&Tab=write&Action=add&useCall=1";
    				}
    				else {
    					window.location.href = $("#scriptWriteLink").val()
    				}
    			}
    		}
    		else if ($.cookie('dasysMSeq') && $.cookie("dasysNick")===null){
    			nickChangePopup();
    		}
    		else {
    			loginPopup();
    		}
    	});
    	
    	if (lnb == 'dealer') {
    		$(document).on("click", ".detailPopup", function () {
    			var key = $(this).attr("value");
    			
    			getHttprequest("/service/ajax_community_exp.php?no=" + key, 'popup_data');
    			openPopup("문의내용", 540, '.subj#' + key);
    		});

    		$(document).on("click", "#alert #chkAll", function () {
    			if ($(this).is(":checked")) {
    				$("input[name='sel_del']").prop("checked", "isChecked");
    			}
    			else {
    				$("input[name='sel_del']").prop("checked", "");
    			}
    		});

    		$(document).on("click", "#alert input[name='sel_del']", function () {
    			if ($("#alert input[name='sel_del']").length == $("#alert input[name='sel_del']:checked").length && $("#alert #chkAll").is(":checked") == false) {
    				$("#alert #chkAll").prop("checked", "isChecked");
    			}
    			else if ($("#alert input[name='sel_del']").length != $("#alert input[name='sel_del']:checked").length && $("#alert #chkAll").is(":checked") == true) {
    				$("#alert #chkAll").prop("checked", "");
    			}
    		});

    		$(document).on("click", "button[name='boardDel']", function () {
    			var delType = '';
    			var selList = new Array();
    			var doDelete = true;
    			var work = "inform,comment";

    			delType = $(this).attr("val");

    			if (delType == "choice") {
    				if ($("#alert input[name='sel_del']:checked").length > 0) {
    					$("#alert input[name='sel_del']:checked").each(function (index) {
    						selList[index] = $(this).attr("value");
    					});
    				}
    				else {
    					alert("삭제할 목록을 선택해주세요.");
    					doDelete = false;
    				}
    			}
    			else if (delType == "read") {
    				$("#alert input[name='sel_del']").each(function (index) {
    					if ($(this).parent().parent().find("span.ok").length > 0) {
    						selList[index] = $(this).attr("value");
    					}
    				});
    			}

    			if (doDelete == true && selList.length < 1) {
    				alert("삭제할 목록이 없습니다.");
    				doDelete = false;
    			}

    			if (doDelete == true) {
    				$.ajax({
    					type : "POST", //"POST", "GET" 
    					url : "../mypage/mypage_action.php", //Request URL 
    					dataType : "text", //전송받을 데이터의 타입 
    					timeout : 30000, //제한시간 지정  
    					data : {
    						work : work,
    						selList : selList,
    						delType : delType
    					}, 
    					contentType: "application/x-www-form-urlencoded; charset=UTF-8", 
    					error : function(request, status, error) {
    						alert("code : " + request.status + "\r\nmessage : " + request.reponseText); 
    					}, 
    					success : function(data) {
    						//통신 성공시 처리 
    						if (data == '1') {
    							var date = new Date();
    							
    							alert("삭제되었습니다.");
    							
    							$.cookie('InterestCount', '0', {expires:date, path:'/', "domain":"auto.danawa.com"});
    							$.cookie('InformCount', '0', {expires:date, path:'/', "domain":"auto.danawa.com"});
    							
    							location.reload();
    						}
    						else {
    							alert("다시시도해 주세요");
    						}
    					}
    				});
    			}
    		});

    		$(document).on("click", "#dealerTab li", function () {
    			if ($(this).hasClass("on") == false) {
    				$("#dealerTab li").removeClass("on");
    				$(this).addClass("on");
    				
    				if ($(this).attr("val") == "list") {
    					$("#list").addClass("on");
    					$("#alert").removeClass("on");
    				}
    				else {
    					$("#alert").addClass("on");
    					$("#list").removeClass("on");
    				}
    			}
    		});

    		// 미사용, 사용시 php변수 할당 필요
    		$(document).on("click", "#dealer input[name='selectComment']", function () {
    			var selectEstimate = '';

    			$(".requestList input[name='estimate']").each(function () {
    				if (this.checked) {
    					selectEstimate += "," + this.value;
    				}
    			});

    			selectEstimate = selectEstimate.substr(1);

    			getHttprequest("/service/ajax_register_comment.php?Key=" + selectEstimate + "&Gnb=<?=$gnb?>&Work=<?=$Work?>&Tab=detail", 'popup_data');
    			openPopup("댓글 등록", 680, "#dealer input[name='selectComment']");
    		});

    		// 미사용, 사용시 php변수 할당 필요
    		$(document).on("click", ".requestList button[name='rowComment']", function () {
    			var selectEstimate = $(this).val();

    			getHttprequest("/service/ajax_register_comment.php?Key=" + selectEstimate + "&Gnb=<?=$gnb?>&Work=<?=$Work?>&Tab=detail", 'popup_data');
    			openPopup("댓글 등록", 680, '.subj#' + selectEstimate);
    		});

    		$(document).on("click", "#dealer input[name='Brand']", function () {
    			if ($("#dealer input[name='Brand']:checked").length == 0) {
    				alert("최소 1개의 브랜드가 선택되어야 합니다.");
    				$(this).prop("checked", true);
    			}
    		});

    		$(document).on("click", "#dealer input[name='HeadText']", function () {
    			if ($("#dealer input[name='HeadText']:checked").length == 0) {
    				alert("최소 1개의 구입 방법이 선택되어야 합니다.");
    				$(this).prop("checked", true);
    			}
    		});

    		$(document).on("click", "#dealer input[type='checkbox'][name='Brand']", function () {
    			if ($("#dealer input[type='checkbox'][name='Brand']:checked").length == 1) {
    				$.get(
    						"../service/ajax_auto_model.php",
    						{
    						    Brand:$("#dealer input[type='checkbox'][name='Brand']:checked").val(),
    						    Type:2
    						},
    						function (data, status) {
    							if (status == "success") {
    								$("#dealer select[name='Model']").html(data);
    							}
    						}
    					);

    				$("#dealer select[name='Model']").attr("disabled", false);
    			}
    			else {
    				$("#dealer select[name='Model']").html("<option value=''>모델</option>");
    				$("#dealer select[name='Model']").attr("disabled", true);
    			}
    		});

    		$(document).on("change", "#dealer select[name='City']", function () {
    			var sidoCode = $(this).val();
    			var sidoName = $("#dealer select[name='City'] option:selected").html();

    			$.get(
    					"../service/ajax_auto_sigunguSelect.php",
    					{
    					    Sido:sidoCode,
    					    Type:"name"
    					},
    					function (data, status) {
    						if (status == "success") {
    							$("#dealer select[name='Area']").html(data);

    							if ($("#dealer select[name='City'] option:selected").val().length > 0) {
    								$("#dealer select[name='Area']").prop("disabled", false);
    							}
    							else {
    								$("#dealer select[name='Area']").prop("disabled", true);
    							}
    						}
    					}
    				);
    		});

    		$(document).on("click", "#dealer input[type='button']:not(input[name='selectComment'])", function () {
    			var checkedHeadtext = '';
    			
    			$("#dealer input[name='HeadText']").each(function () {
    				if (this.checked) {
    					if (checkedHeadtext.length > 0) {
    						checkedHeadtext += ',';
    					}
    					
    					checkedHeadtext += this.value;
    				}
    			});

    			$("#dealer input[name='AllHeadText']").val(checkedHeadtext);

    			if ($("#dealer input[name='HeadText']:checked").length > 1) {
    				$("#dealer input[name='HeadText']").attr("checked", false);
    			}

    			var checkedBrand = '';
    			
    			$("#dealer .selBrand").each(function () {
    				if (this.checked) {
    					if (checkedBrand.length > 0) {
    						checkedBrand += ',';
    					}
    					
    					checkedBrand += this.value;
    				}
    			});

    			$("#dealer input[name='Brand']").val(checkedBrand);

    			if (!$("#dealer select[name='City'] option:selected").val() && $("#dealer select[name='Area'] option:selected").val()) {
    				$("#dealer select[name='Area'] option:eq(0)").prop("selected", true);
    			}
    			
    			$("#dealer").submit();
    		});
    		
    		$(document).on('click', '#requestDelete', function () {});
    	}
    	else if (lnb == 'search') {    		
    		var brandSeq = $("#scriptBrandSeq").val()

    		$(window).load(function() {

    			// 브랜드 파라메터 유입
				if ($("#scriptBrandSeq").val() !='') {    				
					var addSearchResult = '';
    				var aBrandList = $("#scriptBrandSeq").val().split(",");
        			var tempArr = [];
        			var resultArr = [];
        			
        			$.each( aBrandList, function( key, value ) {
        				
        				if ($("#newcarFinder .brandSeq_"+value).length) {
        					//$("#newcarFinder .brandSeq_"+value).hasClass('checked', true);

        					addSearchResult = '<div class="item" id="brandSeq_'+value+'">'+$("#newcarFinder .brandSeq_"+value).find("span").text()+'<button type="button" class="btn_delete attributeDelete"><span class="screen_behind">삭제</span></button></div>';
        					$("#searchResult").append(addSearchResult);
        					$("#searchResult").show();
        				}
        			});
    			}

    			// 검색옵션 파라메터 유입 (친환경 유입)
    			if ($("#scriptAttributeList").val() !='') {    				
    				var aAttributeList = $("#scriptAttributeList").val().split(",");
        			var tempArr = [];
        			var resultArr = [];
        			
        			$.each( aAttributeList, function( key, value ) {
        				var arr = value.split("|");
        				$(".attributeDetailSeq_"+arr[1]).prop('checked', true);
        			});
    			}
    			
    			const queryString = window.location.search;
    			const urlParams = new URLSearchParams(queryString);
    			const page = urlParams.get('page');
    			
    			if (page != null) {
    				searchListAjax(page);
    			} else if ($("#scriptBrandSeq").val() != '' || $("#scriptAttributeList").val() !='') {
    				searchListAjax(1);
    			}
    			
    			drawADScript('newcarList');
    		});
    		
    		$(".brandSeq").prop('checked', false);
    		$(".segment").prop('checked', false);
    		$(".attributeDetailSeq").prop('checked', false);

    		$(document).on("click",".container_detailsearch .header .btn_viewall", function(){
    			$(".container_detailsearch .search_list .group").toggleClass("off");
    			$(".container_detailsearch .search_list .sub").toggleClass("off");
    			$(this).toggleClass("open");
    			
    			sendGA('검색옵션 전체보기','');
    		});

    		$(document).on('click', '.modelList a[name="modelDetailLink"]', function() {
    			var attributeList = [];
    			
    			$('#searchResult .item').each(function(index) {
    				var itemId = $(this).attr("id");
    				
    				// 속성값
    				if ( itemId.indexOf('attributeDetailSeq') != -1) {
    					attributeList.push($("."+itemId).val());
    				} 
    			});		

    			attributeList = encodeURIComponent(attributeList);
    			
    			var param = "&attributeList="+attributeList;  

    			window.open('/auto/?Work=model&Model='+$(this).attr('model')+param);
    			
    			return false;
    		});
    		
    		//판매조건보기
    		$(document).on('click', '.modelList a[name="newcarSales"]', function() {
    			sendGA('판매조건보기', $(this).attr('model'));
    			
    			getHttprequest("/theme/modelSales.php?model="+ $(this).attr('model') + '&brand=' + $(this).attr('brand'),'popup_data');
    			openPopup($(this).parent().parent().parent().find('.name').text() + ' 판매조건', 600, 'center');
    		});
    		
    		//관련뉴스
    		$(document).on('click', '.modelList a[name="newcarNews"]', function() {
    			sendGA('관련뉴스', $(this).attr('model'));
    			
    			window.open('/news/?Work=detail&no='+$(this).attr('no'));
    		});
    		
    		// 렌트/리스 매물보기
    		$(document).on('click', '.modelList a[name="newcarUsedcar"]', function() {
    			sendGA('렌트/리스 가격비교', $(this).attr('model'));
    			
    			window.open('/leaserent/?Work=priceCompare'+$(this).attr('param'));
    		});
    		
    		//옵션 접기/펼치기
    		$(document).on("click","#newcarFinder .btn_rowall", function(){
    			$(this).toggleClass("open");

    			$(this).closest("dl.row").find(".itembox").children("ul").toggleClass("open");
    		});
    		
    		//기본옵션,선택옵션 레이어
    		$(document).on("click", ".btn_result", function(){
    			var type = $(this).data("type");
    			var modelSeq = $(this).attr("model");
    			var attributeList = [];
    			
    			$('#searchResult .item').each(function(index) {
    				var itemId = $(this).attr("id");
    				
    				// 속성값
    				if ( itemId.indexOf('attributeDetailSeq') != -1) {
    					attributeList.push($("."+itemId).val());
    				}
    			});		

    			var optionCnt =$(this).find("span").text();
    			
    			if (optionCnt != 0) {
    				if(type == '') {
    					// 기본옵션 
    					$("#popup_option_result .list ul").removeClass();
    					
    					var ttl="선택된 사양이 기본으로 적용된 트림입니다.";
    					var params = "attributeList="+attributeList+"&modelSeq="+modelSeq+"&optionType=default";    		
    					var htmlStr = "";
    					
    					$.ajax({ 
    						type: 'POST', 
    						url: 'searchOptionAjax.php', 
    						data:params,
    						dataType : 'json', 
    						success: function(data) {
    							var prevIndex = 0;
    							
    							$.each(data, function(index, entry) {
    								$.each(data[index], function(index2, entry2) {
    									if (prevIndex != entry2.lineupSeq) {
    										htmlStr += '<dt>'+entry2.lineupName+' '+entry2.nameRef+' ('+entry2.dateStart+')</dt>';
    										htmlStr += '<dd>';
    										htmlStr += '<ul>';
    										prevIndex = entry2.lineupSeq;
    									}
    									
    									var hightrimPriceClass = '';
    									if(entry2.price != null && entry2.price != "") {
    										if(Number(entry2.price.replace(',', '')) >= 10000) {
    											var backPrcie = entry2.price.slice(-5);
    											var frontPrcie = entry2.price.replace(backPrcie, '');
    											
    											hightrimPriceClass = "<em class='num'>"+ frontPrcie +"</em>억 <em class='num'>" + backPrcie + "</em>만 원";
    										} else {
    											hightrimPriceClass = "<em class='num'>"+entry2.price+"</em>만 원";
    										}			
    									} 
    									
    									htmlStr += '<li>';
    									htmlStr += '<span class="name">'+entry2.trimName+'</span>';
    									htmlStr += '<span class="price" class="btn_estm">'+ hightrimPriceClass +'</span>';
    									htmlStr += '<a href="/newcar/?Work=estimate&Model='+entry2.modelSeq+'&Lineup='+entry2.lineupSeq+'&Trims='+entry2.trimSeq+'" target="_blank" class="btn_estm">견적</a>';
    									htmlStr += '</li>';
    									
    								});
    								
    								htmlStr += '</ul>';
    								htmlStr += '</dd>';
    							});
    		
    							$(".searchOptionResultList").html(htmlStr);
    							
    						},
    						complete : function() {
    					    }
    					});
    				}
    				else {
    					// 선택옵션
    					$("#popup_option_result .list ul").addClass(type);
    					
    					var ttl="선택된 사양을 옵션으로 추가할 수 있는 트림입니다.";    		
    					var params = "attributeList="+attributeList+"&modelSeq="+modelSeq+"&optionType=select";    		
    					var htmlStr = "";
    					
    					$.ajax({ 
    						type: 'POST', 
    						url: 'searchOptionAjax.php', 
    						data:params,
    						dataType : 'json', 
    						success: function(data) {
    							var prevIndex = 0;
    							
    							$.each(data, function(index, entry) {
    								$.each(data[index], function(index2, entry2) {
    									if (prevIndex != entry2.lineupSeq) {
    										htmlStr += '<dt>'+entry2.lineupName+' '+entry2.nameRef+' ('+entry2.dateStart+')</dt>';
    										htmlStr += '<dd>';
    										htmlStr += '<ul class="option">';
    										
    										prevIndex = entry2.lineupSeq;
    									}
    									
    									htmlStr += '<li>';
    									htmlStr += '<span class="name">'+entry2.trimName+'</span>';
    									htmlStr += '<span class="price"><em class="num">'+entry2.price+'</em>만원 <em class="num">+</em> <em class="num opt">'+entry2.optionPrice+'</em>만원</span>';
    									htmlStr += '<a href="/newcar/?Work=estimate&Model='+entry2.modelSeq+'&Lineup='+entry2.lineupSeq+'&Trims='+entry2.trimSeq+'&Conf='+entry2.addOptionSeq+'" target="_blank" class="btn_estm">견적</a>';
    									htmlStr += '</li>';
    									
    								});
    								
    								htmlStr += '</ul>';
    								htmlStr += '</dd>';
    							});
    		
    							$(".searchOptionResultList").html(htmlStr);
    							
    						},
    						complete : function() {}
    					});
    				}    		
    				
    				$("#popup_data").html($("#popup_option_result").clone(true, true).show().get(0).outerHTML);
    				openPopup('', 580, '');
    		
    				$("#popup_title").html(ttl);
    			}
    		});

    		// 상품검색 초기화
    		$(document).on("click", ".resetBtn", function(){
    			$( "input[type=checkbox]" ).prop('checked', false) ;
    			$('#searchResult').find("div").remove();
    			$("#searchResult").hide();
				$("#listSortType").val(1);
    			searchListAjax(1);
    		});

    		// 상품검색 삭제
    		$(document).on("click", ".attributeDelete", function(){
    			var id = $(this).parent().attr("id");
    			
    			$("."+id).prop('checked', false).removeClass('on')
    			$("."+id.replace("_", "")).prop('checked', false);
    			
    			$(this).parent().remove();
    			
    			if ($('#searchResult').find("div").length == 0) {
    				$("#searchResult").hide();
    			}
    			
				// 전기차 주행거리순일 때 모든 연료가 해제되었을 때
				var listSort = $("#listSortType").val();
				var fuelCnt = 0;
				if (listSort == 9 || listSort == 10) {		
					var attributeList = [];
					$('#searchResult .item').each(function(index) {
						var itemId = $(this).attr("id");
						// 속성값
						if ( itemId.indexOf('attributeDetailSeq') != -1) {
							attributeList.push($("."+itemId).val());
						}
					});		
					
					// 전기 연료 체크 개수
					attributeList.forEach(function(value) {
						var tmpStrArr = value.split("|");
						if (tmpStrArr[2] === "S") {
							if (tmpStrArr[1] == 20 || tmpStrArr == 964) {
								fuelCnt++;
							}
						}
					});
				}
				
				if (fuelCnt === 0) {
					$("#listSortType").val(1);
				}
				
    			searchListAjax(1);
    		});
    		
    		// 제조사
    		$(document).on("click", "#newcarFinder .brandSeq", function(){
    			var addSearchResult = kwd1 = brandCode = "";    			
    			var aDefaultKeyword = ['장기렌트카', '장기렌트가격비교', '장기렌트카가격비교사이트', '장기렌터카', '장기렌터카가격비교', '자동차리스', '리스차', '신차리스', '자동차리스가격', '차량리스', '수입차렌트', '외제차렌트', '수입차렌트카', '수입차장기렌트', '수입차리스', '수입자동차리스', '자동차리스가격', '외제차리스', '수입차리스가격', '수입차오토리스'];

    			kwd1 = aDefaultKeyword[Math.floor(Math.random() * aDefaultKeyword.length)];
    			
    			if (!$(this).hasClass("on")) {
    				$(this).addClass("on");
    				
    				brandCode = $(this).data('brand')
    				
    				addSearchResult = '<div class="item" id="brandSeq_'+brandCode+'">'+$(this).find("span").text()+'<button type="button" class="btn_delete attributeDelete"><span class="screen_behind">삭제</span></button></div>';
    				
    				$("#searchResult").append(addSearchResult);
    				$("#searchResult").show();
    				
    				// UXLOG 수집
    				var brandName = $(this).find("span").text();
    				
    				sendUXLOG("P27003",{"option":"신차리스트_검색옵션_브랜드", "brand":brandName});
    			}
    			else {    		
    				$(this).removeClass("on");
    				$("#brandSeq_"+$(this).data('brand')).remove();

    				if ($('#searchResult').find("div").length == 0) {
    					$("#searchResult").hide();
    				}
    			}
    			
    			NAVER_ADPOST_V2({
    				channel: "danawa.ch7",
    				pageSize: 5,
    				category1: "신차",
    				query: kwd1,
    				url : location.href,
    				test: !bIsReal,
    				mock: false
    			});
    			
    			sendGA('검색옵션 선택',$(this).parent().find("span").text());
    			
    			searchListAjax(1);
    		});

    		// 차종
    		$(document).on("click", ".segment", function(){
    			var addSearchResult = "";
    			
    			if ($(this).prop("checked") == true) {
    				$("#searchResult").show();
    				addSearchResult = '<div class="item" id="segment_'+$(this).val()+'">'+$(this).parent().find("span").text()+'<button type="button" class="btn_delete attributeDelete"><span class="screen_behind">삭제</span></button></div>'
    				$("#searchResult").append(addSearchResult);
    				
    				// UXLOG 수집
    				var segmentName = $(this).parent().find("span").text();
    				
    				sendUXLOG("P27003",{"option":"신차리스트_검색옵션_차종", "segment":segmentName});
    			}
    			else {
    				$("#segment_"+$(this).val()).remove();
    				
    				if ($('#searchResult').find("div").length == 0) {
    					$("#searchResult").hide();
    				}
    			}
    			
    			sendGA('검색옵션 선택',$(this).parent().find("span").text());
    			
    			searchListAjax(1);
    		});
    		
    		// 검색 옵션 눌렀을 시 
    		$(document).on("click", ".attributeDetailSeq", function(){
    			var checked = $(this).prop("checked");
    			var attributeSeqList = $(this).val();
    			var arr = attributeSeqList.split("|");
    			
    			$(".attributeDetailSeq_"+arr[1]).prop('checked', checked);

    			if ($(this).prop("checked") == true) {
    				$("#searchResult").show();
    				addSearchResult = '<div class="item" id="attributeDetailSeq_'+arr[1]+'">'+$(this).parent().find("span").text()+'<button type="button" class="btn_delete attributeDelete"><span class="screen_behind">삭제</span></button></div>'
    				$("#searchResult").append(addSearchResult);
    				    				
    				// UXLOG 수집
    				var groupName = $(this).closest("li").data("attr");
    				var detailName = $(this).parent().find("span").text().replace(/^\s+|\s+$/g, "");
    				
    				sendUXLOG("P27003",{"option":"신차리스트_검색옵션_"+groupName, "detail":detailName});
    			}
    			else {
    				$("#attributeDetailSeq_"+arr[1]).remove();
    				
					// 전기차주행거리순일 때 선택된 연료가 없을 경우 '인기모델순'으로 변경
					var sortValue = $("#listSortType").val();
					if (sortValue == 9 || sortValue == 10) {
							var attributeList = [];
						$('#searchResult .item').each(function(index) {
							var itemId = $(this).attr("id");
							// 속성값
							if ( itemId.indexOf('attributeDetailSeq') != -1) {
								attributeList.push($("."+itemId).val());
							} 
						});	
						
						var fuelCnt = 0;
						attributeList.forEach ((value, index, array) => {
							var tmpStrArr = value.split('|');
							if (tmpStrArr[2] == "S") {
								fuelCnt++;
							}
						});
						
						if (fuelCnt === 0) {
							$("#listSortType").val(1);
						}
					}
					
    				if ($('#searchResult').find("div").length == 0) {
    					$("#searchResult").hide();
    				}
    			}
    			
    			sendGA('검색옵션 선택',$(this).parent().find("span").text().replace(/^\s+|\s+$/g, ""));
    			
    			searchListAjax(1);
    		});

    		// 탭변경
    		$(document).on("click", ".tabHead .list li", function(){
    			var tabType = $(this).data("tab");
    			var eventLabel = {coming:'출시예정 탭', all:'전체 탭', onSale:'시판모델 탭'};
    			
    			// 전체보기 닫기
    			if ($(".btn_viewall").hasClass("open")) {
					$(".btn_viewall").trigger("click");
				}
    			
    			if (tabType == 'coming') {
    				// 상세검색 선택목록 초기화
    				$("#searchResult div").each(function(idx, element){    					
    					if ($(this).prop('id').indexOf("brand") == -1) {
    						$(this).remove();
    					}
    				})
    				
    				if ($('#searchResult').find("div").length == 0) {
    					$("#searchResult").hide();
    				}
    				
    				// 검색옵션 전체보기 비활성
    				$(".btn_viewall").attr('disabled', true)
    				
    				// 검색옵션 선택항목 제거
    				$(".container_detailsearch .search_list dl").each(function(idx, element){
    					if (!$(this).hasClass('brand')) {    						
    						// 검색옵션 선택항목 초기화
    						$(this).find('input[type=checkbox]').prop('checked', false);
    						
    						if (!$(this).hasClass('sub')) {
    							$(this).css('display','none');
    						}
    					}
    				})
    				
    				// 검색어 초기화
    				$("#searchKeyword").val('');    				
    				// 금액 초기화
    				$("#rangeMinPrice").val('');
    				$("#rangeMaxPrice").val('');
    			}
    			else {
    				$(".btn_viewall").attr('disabled', false)
    				
    				$(".container_detailsearch .search_list dl").each(function(idx, element){
    					if (!$(this).hasClass('brand') && !$(this).hasClass('sub')) {
    						$(this).css('display','block');
    					}
    				})
    			}
    			
    			$("#listTab").val(tabType);
    			
    			sendGA('모델 구분 선택',eventLabel[tabType]);
    			
    			moveScroll('', 0);
    			searchListAjax(1);
    		});
    		
    		// 정렬
    		$(document).on("click", ".listSortType", function(){
    			var sortType = $(this).val();
    			
    			$("#listSortType").val(sortType);
    			
    			if (sortType == '2') {
    				sendGA('차종순', '');
    			}
    			else if (sortType == '3' || sortType == '4') {
    				sendGA('가격순', '');
    			}
    			else if (sortType == '5' || sortType == '6') {
    				sendGA('연비순', '');
    			}
    			else if (sortType == '7' || sortType == '8') {
    				sendGA('출시순', '');
    			}
				else if (sortType == '9' || sortType == '10') {
					sendGA('전기차 주행거리순', '');
				}
    			
    			searchListAjax(1);
    		});
    		
    		// 가격범위 최소 select 이벤트
    		$(document).on("change", "#rangeMinPrice", function(){
    			var selectOptionValue = this.value;
    			
    			$("#rangeMaxPrice option").each(function(){
    				if(this.value != "") {
        				if(Number(this.value) < Number(selectOptionValue)) {
        					$(this).prop('disabled', true);
        				} else {
        					$(this).prop('disabled', false);
        				}   					
    				}
    			});
    		});
    		
    		// 가격범위 최소 select 이벤트
    		$(document).on("change", "#rangeMaxPrice", function(){
    			var selectOptionValue = this.value;
    			
    			if(selectOptionValue == "") {
    				$("#rangeMinPrice").find("option").attr('disabled', false)
    				$("#rangeMinPrice option:eq(0)").attr('selected', 'selected');
    			} else {
        			$("#rangeMinPrice option").each(function(){
        				if(this.value != "") {
            				if(Number(this.value) > Number(selectOptionValue)) {
            					$(this).prop('disabled', true);
            				} else {
            					$(this).prop('disabled', false);
            				}   					
        				}
        			});   				
    			}
    		});
    		
    		// 리스트 갯수
    		$(document).on("change", "#listCount", function(){
    			var listCount = $(this).val();
    			
    			$("#listCount").val(listCount);
    			
    			searchListAjax(1);
    		});

    		// 검색 버튼
    		$(document).on("click", ".btn_search", function(){
    			searchListAjax(1);
    		});

    		$(document).on("keydown", "#searchKeyword", function(key){
    			if(key.keyCode == 13) {
    				sendGA('모델명 검색','');
    				
    				searchListAjax(1);
    			}
    	    });

    		$(document).on("click", ".link__number, .link__pagination, .newcarPage", function(){
    			var page = $(this).attr("page");
    			
    			if ($(".btn_viewall").hasClass("open")) {
    				$(".btn_viewall").trigger("click");
    			}
    			
    			moveScroll('', 600);
    			
    			searchListAjax(page);
    		});
    	}
    	else if (lnb == 'sales') {    		
    		// 판매조건 탭 (금월 / 전월)
        	$('.tabHead.sales .list li button').live('click', function () {
        		$('.tabHead.sales .list li').removeClass('on');
        		$(this).parent().addClass('on');
        	
        		if ($(this).attr('id') == 'current') {
        			$('.currentMonth').removeClass('off');
        			$('.lastMonth').addClass('off');
        		}
        		else {
        			$('.currentMonth').addClass('off');
        			$('.lastMonth').removeClass('off');
        		}
        	});
    	}
    	else if (lnb == 'estimate') {    		
    		estmAct	= 1;
    		emod = 'single';
    		
    		$(document).ready(function() { 
    			listTrims(estmAct,$("#scriptModel").val());
    			itemPriceSpec();
    			var str = dnw_deChar2(estmDataSelf['Dcost']);
    			
    			dnw_array2(str, 'setCost');
    			calculate('redy', '');

				// 친환경 전기 차의 경우 상단에 문구 노출
				var tmpEVCnt = 0;
				var tmpEVList = "";
				$(".choice__price--subsidy").each(function(index, item) {
					var tmpThisTrimId = '';
					if($(this).hasClass('choice__price')) {
						tmpThisTrimId = $(this).parent().siblings("input").attr('id');
					} else {
						tmpThisTrimId = $(this).parent().parent().parent().siblings("input").attr('id');
					}
					
					var tmpTrimIdArr = tmpThisTrimId.split("trim_1");
					
					if (!tmpEVList) {
						tmpEVList += tmpTrimIdArr[1];
					}
					else {
						tmpEVList += "," + tmpTrimIdArr[1];
					}
					
					tmpEVCnt++;
				});
				
				if (tmpEVCnt > 0) {
					var explainEV = "<div class='box__triminfo'><span class='text__info'>전기차 보조금은 국고 + 지자체(서울) 기준으로 계산된 금액이며 지자체 선택 시 해당 지자체 기준으로 변경됩니다.</span></div>"
					$("#Trim_1 .estimate__title").append(explainEV);
				}
    			
    			// 세부모델 펼쳐보기 히든 유무
    			$("#info_lineup .btn_moreview").show();
    			
    			if ($("#info_lineup .eTrimBox dd").index() < 6) {
    				$("#info_lineup .btn_moreview").hide();
    			}
    			
    			// 옵션선택 펼쳐보기 히든 유무
    			$("#Optn_1 .btn_moreview").show();
    			
    			if ($("#Optn_1 ul.eChkItemList li").length < 6) {
    				$("#Optn_1 .btn_moreview").hide();
    			}
    			
    			// 판매조건 펼쳐보기 히든 유무
    			$("#Term_1 .btn_moreview").show();
    			
    			if ($("#Term_1 ul.eChkTermList li").length < 6) {
    				$("#Term_1 .btn_moreview").hide();
    			}

//    			fset = $("#Finc_"+ebox+" .eRsltFincName").attr("fincComp");
//    			calculate("fincC",fset);    			

    			$("#info_lineup .lineup_group .lineup").on("click", function(){
    				$(this).toggleClass("close");
    				$(this).parent().parent().find("dd").toggleClass("off");
    			});
    			
    			// 세부모델
    			$("#info_lineup .btn_moreview").on("click", function() {
    				location.hash= "info_lineup";
    				
    				$(this).toggleClass("all");
    				$("#info_lineup .contents").toggleClass("all");
    				$("#info_lineup .contents").toggleClass("scroll");
    			});
    			
    			// 옵션선택
    			$("#Optn_1 .btn_moreview").on("click", function() {
    				location.hash= "Optn_1";
    				
    				$(this).toggleClass("all");
    				$("#Optn_1 .contents").toggleClass("all");
    				$("#Optn_1 .contents").toggleClass("scroll");
    			});
    			
    			// 판매조건
    			$("#Term_1 .btn_moreview").on("click", function() {
    				location.hash= "Term_1";
    				
    				$(this).toggleClass("all");
    				$("#Term_1 .contents").toggleClass("all");
    				$("#Term_1 .contents").toggleClass("scroll");
    			});
    			
    			// 브랜드코드 지정
    			if (valCode.brnd) {
    				$("#layerPopup").data('brand', valCode.brnd)
    			}

    			// 전기차 보조금
    			if($("#Incnt_tab").length > 0) { // 캐시 적용 문제로 보조금탭 있는지 우선체크
    				if($("#trim_1"+ valCode.trms).parent().find("div.choice__price--subsidy").length > 0) {
        				getHttprequestSync('/service/ajax_estimate_EVform.php?trims='+valCode.trms+'&option='+codes.itms, 'Incnt_1');
        				
        				$("#Incnt_tab").removeClass("off");
        				$("#info_summary .eIncentiveDiv").removeClass("off");

						// 서울 특별시 선택
						$("#EVSidoSelect").val("S20").trigger("change");
						$("#EVSigunguSelect").val("1").trigger("change");
    					
    					calculate('incnt', '');
        			} else {
        				$("#Incnt_tab").addClass("off"); // 보조금탭
        				$("#Incnt_1").addClass("off"); // 보조금 혜택 선택 영역
        				$("#info_summary .eIncentiveDiv").addClass("off"); // 견적상세 보조금

						if (tmpEVCnt > 0) {
							$.ajax({
								type : "GET",
								url : webUrl + "/service/ajax_EVincentive_priceList.php",
								dataType : 'json',
								data : {
									modelCode : valCode.modl,
									sidoCode : 'S20',
									sigunguCode : 1,
								},
								success : function (data) {
									$(".choice__price--subsidy").each(function(index, item) {
										var tmpIdStr = '';
										
										if($(this).hasClass('choice__price')) {
											tmpIdStr = $(this).parent().siblings("input").attr('id');
										} else {
											tmpIdStr = $(this).parent().parent().parent().siblings("input").attr('id');
										}
										
										var tmpIdArr = tmpIdStr.split('_1');
										if (tmpIdArr[1] != valCode.trms) {
											var strCarDefaultPrice = $(this).children(".txt").children().text();
											var nCarDefaultPrice = strCarDefaultPrice.replace(/,/g, "");
											var carResultPrice = nCarDefaultPrice - (parseInt(data[tmpIdArr[1]]['nGovernmentIncentive']) + parseInt(data[tmpIdArr[1]]['nLocalIncentive']));
											
											var strCarResultPrice = carResultPrice.toLocaleString();
											$(this).children(".text__subsidy").text("보조금 적용 시 " + strCarResultPrice + "만 원");
										}
							
									});
								},
								error : function () {
									alert('보조금 정보 호출 실패');
								}
							});
						}
        			}
    			}
				
    			// UXLOG 수집
    			var modelCode = valCode.modl;
        		var modelName = $('#info_model .estimate-model__img img').attr('alt');

       			sendUXLOG('P17001',{"modelCode":modelCode, "modelName":modelName});
       			
       			/** 색상 **/
       			setTrimColorInfo();
       			
       			$("#financialCont").find("#multSelectCont").show();
        		setTimeout(function() {
      			  	$("#financialCont").find("#multSelectCont").css('display', 'none');
        		}, 5000);
    		});
			
			//팝업 처리
			$("#autodanawa_help").on("click", function(){
				$(".buttonHelp").removeClass("on");
				$(".buttonPopup").removeClass("on");
			});		

			if( $("#Optn_1 input:checked:eq(0)").length > 0) {
				$("#Optn_1 .contents").animate({
					scrollTop:$("#Optn_1 input:checked:eq(0)").offset().top - 575
				}, 500);
			}
    		
    		//견적 url복사
    		$(document).on("click", '#urlCopy', function(){
    			var url = $("meta[property='og:url'").attr("content");
    			
    			$("#popup_data").html("<div class='urlCopyBox'><span class='urlCopyTtl'> 아래 <em>url을 복사</em>해 주십시오.</span>" + "<textarea name='urlCopyTxt' title='페이지url' class='urlCopyTxt' readonly>" + url + "</textarea></div>");
    			
    			openPopup("견적 페이지 URL 복사", 400, 'selfLeft');
    		});	
    		
    		// 특정 모델 배너광고 노출
    		$(document).ready(function(){
	    		var code = $("#info_lineup .eTrimBox dl:eq(0)");
    		})

			$("#info_lineup .lineup_group .lineup").on("click", function(){
				$(this).toggleClass("close");
				$(this).parent().parent().find("dd").toggleClass("off");
			});
			
			var estimateT = $("#eDiv_1").offset().top;
			var msie6 = $.browser == 'msie' && $.browser.version < 7;
			
			if (!msie6) {
				$(window).scroll(function (event) {
					
					var scrollY = $(document).scrollTop();
					var scrollTop = $(this).scrollTop();
    				var fixedTop = 0;
    				var liIndex = 0;
    				
					if (scrollY > estimateT) {
						$('#self_summary').addClass('fix');
	
						var summary = $(document).scrollTop() + $("#self_summary").height(); //요약 길이
						var footer = $("#autodanawa_footer").offset().top;
	
						if(summary > footer) {
							$("#self_summary").css("top","-"+ (summary - footer) +"px");
						}
						else {
							$("#self_summary").css("top","0");
						}
					}
					else {
						$('#self_summary').removeClass('fix');
					}
					
					$("#eDiv_1 .tab-list li").removeClass('tab-list__item--on')
    				
    				if ($("#eDiv_1 .estimate-tab").hasClass('estimate-tab--fixed')) { 
    					fixedTop = $("#eDiv_1 .estimate-tab").height();
    				}
    				
					if($("#Incnt_1").length > 0 && $("#Incnt_1").css("display") != "none") { // 보조금탭 존재
						if (scrollTop > $("#eDiv_1 .estimate-tab").offset().top) {
	    					$("#eDiv_1 .estimate-tab").addClass('estimate-tab--fixed');
	    				}
	    				else if (scrollTop < $("#Trim_1").offset().top-fixedTop-(fixedTop+18)) {
	    					$("#eDiv_1 .estimate-tab").removeClass('estimate-tab--fixed');
	    					liIndex = 0;
	    				}
	    				else if (scrollTop > $("#Optn_1").offset().top-fixedTop && scrollTop < $("#Term_1").offset().top-fixedTop) {
	    					liIndex = 1;

	    					if ($("#Optn_1").css('display') == 'none') {
	        					liIndex = 0;
	        				}
	    				}
	    				else if (scrollTop > $("#Term_1").offset().top-fixedTop && scrollTop < $("#Incnt_1").offset().top-fixedTop) {
	    					liIndex = 2;
	    				}
	    				else if (scrollTop > $("#Incnt_1").offset().top-fixedTop && scrollTop < $("#financialInstrument").offset().top-fixedTop-100) {
	    					liIndex = 3;
	    				}
	    				else if (scrollTop > $("#financialInstrument").offset().top-fixedTop-100) {
	    					liIndex = 4;
	    				}
					} else {
						if (scrollTop > $("#eDiv_1 .estimate-tab").offset().top) {
	    					$("#eDiv_1 .estimate-tab").addClass('estimate-tab--fixed');
	    				}
	    				else if (scrollTop < $("#Trim_1").offset().top-fixedTop-(fixedTop+18)) {
	    					$("#eDiv_1 .estimate-tab").removeClass('estimate-tab--fixed');
	    					liIndex = 0;
	    				}
	    				else if (scrollTop > $("#Optn_1").offset().top-fixedTop && scrollTop < $("#Term_1").offset().top-fixedTop) {
	    					liIndex = 1;

	    					if ($("#Optn_1").css('display') == 'none') {
	        					liIndex = 0;
	        				}
	    				}
	    				else if (scrollTop > $("#Term_1").offset().top-fixedTop && scrollTop < $("#financialInstrument").offset().top-fixedTop-100) {
	    					liIndex = 2;
	    				}
	    				else if (scrollTop > $("#financialInstrument").offset().top-fixedTop-100) {
	    					liIndex = 4;
	    				}
					}

    				if ($("#Optn_1").css('display') == 'none' && liIndex == 1) {
    					liIndex = liIndex-1;
    				}
   
    				$("#eDiv_1 .tab-list li:eq("+liIndex+")").addClass('tab-list__item--on')
				});
			}

			// 할부상품, 캐시백 내용 도움말
			$(document).on("click", "#result_finance .g-btn__help, #result_cash .g-btn__help", function (){

				if ($(this).data('id') && $("#"+$(this).data('id')).length) {
    				$("#"+$(this).data('id')).click();
				}
    			
				$("#layerPopup .g-layer__cont").html($(this).closest(".choice").find(".infodetail").clone()).find(".infodetail").removeClass('off')
				openLayerPopup('full', $("#info_finance .tab-box__item--on .pay-type").text()+' 상품 상세 정보');
			});

			// 옵션상세 접기,펼치기
			$(document).on("click", "#Optn_1 .btn-toggle, #Term_1 .btn-toggle", function(){
				if($(this).hasClass('close')) {
					$(this).removeClass('close');
					$(this).closest('.choice-toggle').removeClass('choice-toggle--close')
					$(this).closest('.choice-toggle').addClass('choice-toggle--open')
				}
				else {
					$(this).closest('.choice-toggle').addClass('choice-toggle--close')
					$(this).closest('.choice-toggle').removeClass('choice-toggle--open')
					$(this).addClass('close');
				}
			});
			
			// 옵션 열기/닫기
			$(document).on("click", "#Optn_1 .choice-more__btn", function(){
				if($(this).parent().hasClass('choice-more--close')){
		        	$(this).find(".txt").text('닫기');
		        	$(this).parent().removeClass('choice-more--close').addClass('choice-more--open');
		        	
		        	$(this).parent().parent().find('.choice-toggle').removeClass('off');
		        }else{
		        	$(this).find(".txt").text('더보기');
		        	$(this).parent().removeClass('choice-more--open').addClass('choice-more--close');
		        	
		        	$.each($(this).parent().parent().find('.choice-toggle'), function(index, element){
		        		if (index > 2) {
		        			$(this).addClass('off');
		        		}
		        	});
		        }
			});

			// 결제방법 금액 초기화
			$(document).on("click", "#Finc_1 [name='payCondition'] .clear", function(){
				var id = $(this).data('id');

				if ($("#"+id).length && (id == 'compSelFincCaps' || id == 'compSelCashCaps')) {
					$("#"+id).val(0).trigger('change');
				}
			});

			$("#eDiv_1 .tab-list li").on('click', function(){

				var top = 20;
				
    			$("#eDiv_1 .tab-list li").removeClass('tab-list__item--on');

    			if (!$("#eDiv_1 .estimate-tab").hasClass('estimate-tab--fixed')) { 
    				top = 70;
				}

    			if ($(this).data('id')) {
    				moveScroll($(this).data('id'), top);
    			}
    			
    			$(this).addClass('tab-list__item--on');
    		});
			
			$(document).on('click', "#Trim_1 .btn-toggle", function (){
				if ($(this).closest(".eChkTrimList").hasClass('article-box--open')) {
					$(this).closest(".eChkTrimList").removeClass('article-box--open')
					$(this).closest(".eChkTrimList").addClass('article-box--close')
				}
				else {
					$(this).closest(".eChkTrimList").addClass('article-box--open')
					$(this).closest(".eChkTrimList").removeClass('article-box--close')
				}
			});

			$(document).on('click', "#info_summary .btn_toggle", function(){

				if ($("#info_summary").hasClass('estimate-result--open')) { 
					$("#info_summary").removeClass('estimate-result--open')
				}
				else {
					$("#info_summary").addClass('estimate-result--open')
				}
			});
			
			if( $("#Optn_1 input:checked:eq(0)").length > 0) {
				$("#Optn_1 .contents").animate({
					scrollTop:$("#Optn_1 input:checked:eq(0)").offset().top - 575
				}, 500);
			}
			
			//외장 색상 선택
			$(document).on('click', "#requestExteriorColorList button", function(){
				var choiceChk = false;
				if($(this).hasClass("request-color--choice") === false) {
					choiceChk = true;
				}
				choiceChk = true;
    			var selectedColor = '';
    			var carCode = '';
    			
    			if ($(this).hasClass("request-color--choice")) {
    				$(this).removeClass("request-color--choice");
    			} else {
    	   			$('#requestExteriorColorList .request-color__item').removeClass('request-color--choice');
        			$(this).addClass('request-color--choice');	
    			}
    			
    			$("#counsel_cont #requestExteriorColorDiv").empty();
    			
    			$("#requestExteriorColorList button").each(function () {
    				if ($(this).hasClass("request-color--choice")) {
    					// 차량 이미지
    					carCode = $("#counsel_cont #requestExteriorColorImg").data("carcode");
    	    			carCode = carCode.split("`");
    					
    	    			var exteriorCarImage = imgUrl+"/photo/"+carCode[0]+"/"+carCode[1]+"/color_"+($(this).attr("color")).substr(1,2)+"_360.png";
    					$("#counsel_cont #requestExteriorColorImg").attr("src", exteriorCarImage);
    					
    					var percentText = '';
   
    					if ($(this).data('percent') != '') {
    						percentText = "<span class='rate'>선택률: <span class='num'>"+$(this).data('percent')+"%</span></span>";
    					}
    					
    					selectedColor += "," + $(this).attr("color") + ":" + $(this).find(".blind").text();
    					$("#counsel_cont #requestExteriorColorDiv").append("<p class='txt'>"+$(this).find(".blind").text()+percentText+"</p>");
    				}
    			});

    			if (selectedColor.length > 1) {
    				selectedColor = selectedColor.substr(1, selectedColor.length);
    			}

    			$("#counsel_cont input[name='color']").val(selectedColor);
    			
    			if(choiceChk) {
        			var colorGroupArray = [];
    				
    				$(".request-color--choice").each(function() {
    					var colorGroup = $(this).attr("group");
    					if(colorGroup != "") {
        					if(colorGroup.indexOf(",") > -1) {
        						var tempArray = colorGroup.split(",");
        						tempArray.forEach(function(item){
        							colorGroupArray.push(item);
        						});
        					} else {
        						colorGroupArray.push($(this).attr("group"));
        					}   						
    					}
    				});

    				$("#requestInteriorColorList button").removeClass('request-color--disable');
    				$("#requestInteriorColorList button").removeAttr('disabled');
    				
    				$("#requestExteriorColorList button").removeClass('request-color--disable');
    				$("#requestExteriorColorList button").removeAttr('disabled');
    				
    				colorGroupArray.forEach(function(item){
    					$("#requestExteriorColorList button").each(function () {
    						if($(this).hasClass("request-color--choice") === false) {
    							if($(this).attr("group").indexOf(item) > -1) {
    								$(this).addClass('request-color--disable');
    								$(this).attr('disabled', 'disabled');								
    							} 
    						}
    					});
    					
    					$("#requestInteriorColorList button").each(function () {
    						if($(this).hasClass("request-color--choice") === false) {
    							if($(this).attr("group").indexOf(item) > -1) {
    								$(this).addClass('request-color--disable');
    								$(this).attr('disabled', 'disabled');								
    							}							
    						}
    					});
    				});
    			}
    		});
			
			//내장 색상 선택
			$(document).on('click', "#requestInteriorColorList button", function(){
				var choiceChk = false;
				if($(this).hasClass("request-color--choice") === false) {
					choiceChk = true;
				}
				choiceChk = true;
				var selectedColor = '';
				
				if ($(this).hasClass("request-color--choice")) {
					$(this).removeClass("request-color--choice");
				} else {
					$('#requestInteriorColorList .request-color__item').removeClass('request-color--choice');
					$(this).addClass('request-color--choice');					
				}
				
				$("#counsel_cont #requestInteriorColorDiv").empty();
				
				$("#requestInteriorColorList button").each(function () {
					if ($(this).hasClass("request-color--choice")) {
						selectedColor += "," + $(this).attr("color") + ":" + $(this).find(".blind").text();
						
						var percentText = '';
						   
    					if ($(this).data('percent') != '') {
    						percentText = "<span class='rate'>선택률: <span class='num'>"+$(this).data('percent')+"%</span></span>";
    					}
    					
						$("#counsel_cont #requestInteriorColorDiv").append("<p class='txt'>"+$(this).find(".blind").text()+percentText+"</p>")
					}
				});
				
				if (selectedColor.length > 1) {
					selectedColor = selectedColor.substr(1, selectedColor.length);
				}
				
				$("#counsel_cont input[name='interiorColor']").val(selectedColor);
				
				if(choiceChk) {
	    			var colorGroupArray = [];
					
					$(".request-color--choice").each(function() {
						var colorGroup = $(this).attr("group");
						if(colorGroup != "") {
							if(colorGroup.indexOf(",") > -1) {
        						var tempArray = colorGroup.split(",");
        						tempArray.forEach(function(item){
        							colorGroupArray.push(item);
        						});
							} else {
								colorGroupArray.push($(this).attr("group"));
							}							
						}
					});

					$("#requestInteriorColorList button").removeClass('request-color--disable');
					$("#requestInteriorColorList button").removeAttr('disabled');
					
					$("#requestExteriorColorList button").removeClass('request-color--disable');
					$("#requestExteriorColorList button").removeAttr('disabled');
					
					colorGroupArray.forEach(function(item){
						$("#requestInteriorColorList button").each(function () {
							if($(this).hasClass("request-color--choice") === false) {
								if($(this).attr("group").indexOf(item) > -1) {
									$(this).addClass('request-color--disable');
									$(this).attr('disabled', 'disabled');								
								} 
							}
						});
						
						$("#requestExteriorColorList button").each(function () {
							if($(this).hasClass("request-color--choice") === false) {
								if($(this).attr("group").indexOf(item) > -1) {
									$(this).addClass('request-color--disable');
									$(this).attr('disabled', 'disabled');								
								}							
							}
						});
					});
				}
 			});
    		
    		$(document).on("change", "#counsel_cont #sido", function () {
    			var sidoCode = $(this).val();
    			var sidoName = $("#counsel_cont #sido option:selected").html();

    			$.get(
					webUrl+"/service/ajax_auto_sigunguSelect.php",
					{
					    Sido:sidoCode,
					    Type:"name"
					},
					function (data, status) {
						if (status == "success") {
							$("#counsel_cont #sigungu").html(data.replace("전지역", "시/군/구")).parent().find('label').removeClass('hide').find('.placeholder').text('시/군/구');
						}
					}
				);
    		});
    		
    		$(document).on("change", "#counsel_cont #sigungu", function () {
    			var sidoName = $("#counsel_cont #sido option:selected").html();
    			
    			$(this).parent().find('label').addClass('hide').find('.placeholder').text(sidoName);
    		});
    		
    		$(document).on("keyup", "#counsel_cont #name", function(){
    			if ($(this).val().length == 0) {
    				$("#nameClear").addClass('hide')
    			}
    			else {
    				$("#nameClear").removeClass('hide')
    			}
    		})
    		
    		$(document).on("click", "#counsel_cont #nameClear", function(){
    			$("#counsel_cont #name").val('').trigger("keyup");
    		})
    		
    		$(document).on("keyup", "#counsel_cont #requestContents", function(){
    			if ($(this).val().length == 0) {
    				$("#requestContents").parent().find('label').removeClass('hide');
    			}
    			else {
    				$("#requestContents").parent().find('label').addClass('hide');
    			}
    		})
    		
    		$(document).on("click", "#counsel_cont #requestAgree .btn-toggle", function(){
    			if ($(this).closest('dl').hasClass('g-agree--open')) {
    				$(this).closest('dl').removeClass('g-agree--open').addClass('g-agree--close')
    			}
    			else {
    				$(this).closest('dl').removeClass('g-agree--close').addClass('g-agree--open')
    			}
    		});
    		
    		// 재확인 요청 레이어 숨김처리
    		$(document).on("click", ".reconfirmClose", function() {
    			$("#reconfirmLayerPopup").css('display', 'none');
    		});
    		// 재확인 후 견적 요청
    		$(document).on("click", "#reconfirmCompletion", function() {
    			var requestForm = $("<form></form>").hide();
    			sendGAExcpt('간편 견적요청', '견적요청완료', '');
    			
    			//GA4 테스트
    			try {gtag('event', '신차견적_확인완료_테스트');} catch(e) {}
				
				if (bIsReal) {
		    		requestForm.attr("action", "https://auto.danawa.com/action/ssl.request.action.php");
				}
				else{
		    		requestForm.attr("action", webUrl+"/action/ssl.request.action.php");
				}

				eval('try{ _trk_clickTrace( \'EVT\', \'PC_신차견적_견적페이지_레이어_확인완료클릭\' ); }catch(_e){ }');

    			requestForm.attr("method", "post");
				requestForm.attr("accept-charset", "utf-8");
				requestForm.attr("enctype", "multipart/form-data");
		        requestForm.appendTo("body");
		        
		        var rentPrice = $('#rentLeasePrice').text();
		        var regex = /[^0-9]/g;				// 숫자가 아닌 문자열을 선택하는 정규식
		        var result = rentPrice.replace(regex, "");
		        requestForm.append('<input type="hidden" name="rlPrice" id="rlPrice" value="' + result + '" />');
		        
				requestForm.append($("#eDiv_1 input"));
				requestForm.append($("#eDiv_1 textarea"));
				requestForm.append($("#eDiv_1 select"));
				requestForm.append($("#layerPopup input"));
				requestForm.append($("#layerPopup textarea"));
				requestForm.append($("#layerPopup select"));

				requestForm.submit();
    		});
    		
			// 견적요청
    		$(document).on("click", "#layerPopup #btn-request", function() {
    			var requestForm = $("<form></form>").hide();
    			var validateMessage = "";
    			var primeRateList = "";

    			var instalmentGoodsName = "";
    			$("#layerPopup input[name='buyType']").val($("#financialInstrument li[id^='tab_'].tab-box__item--on").data("type"));
    			if($("#financialInstrument li[id^='tab_'].tab-box__item--on").data("type") == "finance") {
    				$("#layerPopup input[name='instalmentPrice']").val($("#financialInstrument #installmentPrincipal").val());
    				$("#layerPopup input[name='instalmentPeriod']").val($("#financialInstrument #financialMonth option:selected").val());

    				var instalmentGoodsRate = "";
    				$("#financialInstrument input[id^='financialCheckBox_']:checked").each(function(){
    					if(instalmentGoodsName == "") {
    						instalmentGoodsName = $("label[for='"+ $(this).get(0).id +"']").text();
    						instalmentGoodsRate = $(this).data('rate');
    					} else {
    						instalmentGoodsName += "," + $("label[for='"+ $(this).get(0).id +"']").text();
    						instalmentGoodsRate += "," + $(this).data('rate');
    					}
    				});
    				
    				$("#layerPopup input[name='instalmentGoodsName']").val(instalmentGoodsName);
    				$("#layerPopup input[name='instalmentGoodsRate']").val(instalmentGoodsRate);

    				
    				
    			} else if($("#financialInstrument li[id^='tab_'].tab-box__item--on").data("type") == "cash") {
					$("#layerPopup input[name='cashPrice']").val($("#financialInstrument #cashPayment").val());
					
    				$("#financialInstrument input[id^='financialCheckBox_']:checked").each(function(){
    					if(instalmentGoodsName == "") {
    						instalmentGoodsName = $("label[for='"+ $(this).get(0).id +"']").text();
    					} else {
    						instalmentGoodsName += ", " + $("label[for='"+ $(this).get(0).id +"']").text();
    					}
    				});
					
					$("#layerPopup input[name='cashGoodsName']").val(instalmentGoodsName);
    			}
    			
    			var primeRateList = "";
    			if($("#financialInstrument input[id^='primeRateCheckBox_']:checked").length) {
    				$("#financialInstrument input[id^='primeRateCheckBox_']:checked").each(function(){
    					if(primeRateList == "") {
    						primeRateList = $("label[for='"+ $(this).get(0).id +"']").text() + "(-" + $(this).data('value') + "%)";
    					} else {
    						primeRateList += ", " + $("label[for='"+ $(this).get(0).id +"']").text() + "(-" + $(this).data('value') + "%)";
    					}
    				});
    			}
    			
    			eval('try{ _trk_clickTrace( \'EVT\', \'PC_신차견적_견적페이지_레이어_상담신청하기클릭\' ); }catch(_e){ }');

    			// 데이터 유효성 보기
    			var regPhone = /^01([0|1|6|7|8|9])-?([0-9]{3,4})-?([0-9]{4})$/;
    			if ($("#counsel_cont input[name='buyReply']:checked").length < 1) {
    				validateMessage = "상담 회신 방법을 선택해주세요.";
    			}
    			else if ($("#name").val().length == 0) {
    				validateMessage = "이름을 입력해 주십시오.";
    				$("#name").focus();
    			}
    			else if ($("#phone").val().length == 0 || !$.isNumeric($("#phone").val())) {
    				validateMessage = "연락처를 입력해 주십시오.";
    				$("#phone").focus();
    			}
    			else if (regPhone.test($("#phone").val()) === false) {
    				validateMessage = "연락처를 정확히 입력해 주십시오.";
    				$("#phone").focus();
    			}
    			else if ($("#sido").val() == '' || $("#sigungu").val() == '') {
    				validateMessage = "지역을 선택해주세요.";
    			}
    			else if (!$("#r-check_01").is(":checked")) {
    				validateMessage = "개인정보 수집 및 이용 동의를 해주십시오.";
    			}
    			else if (!$("#r-check_02").is(":checked")) {
    				validateMessage = "개인정보 제3자 제공 동의를 해주십시오.";
    			}
    			
    			if (validateMessage) {
    				alert(validateMessage)
    			}
    			else {
    				$("#reconfirmLayerPopup").css('display', 'block');
    				
    				$("#reconfirmLocal").text($("#sido").val() + ' ' + $("#sigungu").val());
    				$("#reconfirmName").text($("#name").val());
    				
    				var frontNumber = '';
    				var backNumber = '';
    				$("#phone1").val($("#phone").val().substring(0,3));
    				$("#phone2").val($("#phone").val().substring(3));
    				if($("#phone2").val().length == 7) {
    					frontNumber = $("#phone2").val().substring(0, 3);
    					backNumber = $("#phone2").val().substring(3, 7);
    				} else {
    					frontNumber = $("#phone2").val().substring(0, 4);
    					backNumber = $("#phone2").val().substring(4, 8);
    				}
    				
    				$("#reconfirmPhoneNum").text($("#phone1").val() + "-" + frontNumber + "-" + backNumber);
    			}
    		});
    		
    		// 견적 캡쳐
    		$(document).on("click","#requestCapture",function(){
    			var key = '';
    			var num = 0;
    			
    			localStorage.setItem('eInfoModel', $("#info_model .title").text());
				localStorage.setItem('eTextPriceInfo', $("#info_summary .eTextPriceInfo").text());
				localStorage.setItem('eFullName', $("#info_summary .eFullName").text());
				
				// 옵션
				localStorage.setItem('eOptionPriceInfo', $("#info_summary .eOptionPriceInfo").text());
				
    			// 할인
				localStorage.setItem('eRsltTermSum', $("#info_summary .eRsltTermSum").text());
								
				// 혜택
				localStorage.setItem('eDetailRsltFreeItem', $("#info_summary .item.eRsltFreeDesc").text());
				localStorage.setItem('eDetailRsltFreeDesc', $("#info_summary .price.eRsltFreeDesc").text());
				
				// 전기차 보조금
				if($("#info_summary .eIncentiveDiv.off").length == 0) {
					localStorage.setItem('eEvIncentiveTotal', $("#info_summary .eRsltTotIncnt").text());
					localStorage.setItem('eEvIncentiveGovernment', $("#info_summary .eRsltGovIncnt").text());
					localStorage.setItem('eEvIncentiveLocalZone', ($("#info_summary .eRsltLocIncnt").prev(".left").text()).replace("지자체 보조금",""));
					localStorage.setItem('eEvIncentiveLocal', $("#info_summary .eRsltLocIncnt").text());
				}
				
				// 비용
				localStorage.setItem('eEtcPriceSum', $("#info_summary .eEtcPriceSum").text());
				localStorage.setItem('eRsltRegiSum', $("#info_summary .eRsltRegiSum").text());
				localStorage.setItem('eIncPrice', $("#info_summary .eIncPrice").text());
				localStorage.setItem('eRsltTrnsDesc', $("#info_summary .eRsltTrnsDesc").text());
				
				// 견적합계
				localStorage.setItem('eRsltPriceTotalSum', $("#info_summary .eRsltPriceTotalSum").text());
				
				window.open(webUrl + '/newcar/requestCapture.php?Code='+rsltCode[1], '자동차 견적', 'width=1080px,height=800px,scrollbars=1');
    		});
    		
			/** 모델 특장점 레이어 밖 영역 클릭시, 닫기 **/
			$(document).click(function(e){
				/** 모델 특장점 레이어가 open되어 있는 경우만 **/
				if($(e.target).parents("#modelNoticePopup").length == 0 && $(e.target).parents("#LayerPopupNoticePosition").length == 0) {
					if($(e.target).get(0).id != 'modelNoticePopup') {
						if($('#LayerPopupNotice').is(':visible')) {
							$("#LayerPopupNotice #LayerPopupNoticePosition .btn-close").trigger("click");
						}
					}
				}
			});
    	}
    	else if (lnb == 'simpleEstimate') {
    	}
    	else if (lnb == 'request') {    		
    		//검색 submit
    		$(document).on('click', '#searchButton', function () {
    			$('#requestForm').submit();
    		});
    		
    		//브랜드, 지역
    		$(document).on('change', '#requestForm #brand, #requestForm #city', function () {
    			if ($(this).prop('id') == 'brand') {
    				$.get(
						webUrl + "/service/ajax_auto_model.php",{
						    Brand:$(this).val(),
						    Type:2
						},
						function (data, status) {
							if (status == "success") {
								$("#requestForm #model").html(data);
							}
						}
					);
    			}
    			else if ($(this).prop('id') == 'city') {
    				$.get(
						webUrl + "/service/ajax_auto_sigunguSelect.php",{
    					    Sido:$(this).val(),
    					    Type:"name"
    					},
    					function (data, status) {
    						if (status == "success") {
    							$("#requestForm #area").html(data);
    						}
    					}
    				);
    			}
    		});

    		$(document).on('click', '#requestDelete', function () {
    			var isDelete = confirm('구매상담 신청을 삭제 하시겠습니까?');
    			var deleteUrl = webUrl+"/action/ssl.request.action.php";
    			
    			if (bIsReal) {
    				deleteUrl = "https://auto.danawa.com/action/ssl.request.action.php";
				}
    			
    			if (isDelete) {
    				if (!$.cookie('dasysMSeq')) {
    					alert('잘못된 요청입니다. 다시 시도해주세요.');
    					window.location.reload(true);
    					return 0;
    				}
    				else {
    					$.ajax({
    						url : deleteUrl,
    						type : "post",
    						data : {
    							"action" : 'delete',
    							"postCipher" : $.cookie('cipher'),
    							"postDasysMSeq" : $.cookie('dasysMSeq'),
    							"requestNo" : $(this).data('requsetno')
    						},
    						dataType: "json",
    						contentType: "application/x-www-form-urlencoded; charset=UTF-8",
    						async: true,
    						cache: false,
    						crossDomain: true,
    						xhrFields: {
    							withCredentials: true
    						},
    						beforeSend: function () {
    							$("body").append("<div id='loading' style='display:none; position:fixed; z-index:999; height:100%; width:100%; top:0; left:0; background-color:#aaa; fileter:alpha(opacity=60); opacity:0.6; -moz-opacity:0.8;'><div style='z-index:1000; margin:300px auto; width:128px; height:128px; filter:alpha(opacity=100); opacity:1; -moz-opacity:1;'><img src='//autoimg.danawa.com/html/pix/common/now_loading.gif' alt='' /></div></div>");
    							$("#loading").show();
    						},
    						complete: function () {
    							$("#loading").hide();
    						},
    						success: function (data) {
    							alert(data.message);
    							$(location).attr('href', data.url);
    						},
    						error: function (request, error) {
    							console.log('error : ' + error);
    							$("#loading").hide();
    						}
    					});
    				}
    			}
    		});
    	}
    	else if (lnb == 'cash') {    		
    		$(document).ready(function(){
    			$('#autoCashback #name').val('');
    			$('#autoCashback #phone1 option:eq(0)').attr('selected', 'selected');
    			$('#autoCashback #phone2').val('');
    			$('#autoCashback #phone3').val('');
    			$('#autoCashback #agreeCk').attr('checked', false);
    		})

    	}
    	else if (lnb == 'finance') {
    		$(document).on('click', '#productDescription, #interestRateGuide', function () {
    			if($(this).hasClass("open")) {
    				$(this).removeClass("open");
    			}
    			else {
    				$(this).addClass("open");
    			}
    		});
    	}
    	else if (lnb == 'insure') {    		
    		// 보험비교 iframe 제어
    		if ('addEventListener' in window) { 
    			window.addEventListener('message', receiveMessage, false); 
    		} 
    		else if ('attachEvent' in window){ 
    			window.attachEvent('onmessage', receiveMessage); 
    		}
    	}
    }
    
    // 간편설문(신차, 렌트리스, 자동차백과)
    if(gnb == 'newcar' || gnb == 'leaserent' || gnb == 'auto') {
    	// 설문 노출여부 확인
		if(gnb == 'newcar'){
			if(lnb == 'request' && (sessionStorage.getItem("surveyNewcarRequest") == null || sessionStorage.getItem("surveyNewcarRequest") == false)) {
				$("#surveyContents").css("display","block");
			}
		}
		else if(gnb == 'leaserent') {
			if(lnb == 'leaserentSearch' && (sessionStorage.getItem("surveyLeaserentSearch") == null || sessionStorage.getItem("surveyLeaserentSearch") == false)) {
				$("#surveyContents.li_survey").css("display","block");
			}
		}
		else if(gnb == 'auto' && (sessionStorage.getItem("surveyAutoSide") == null || sessionStorage.getItem("surveyAutoSide") == false)) {
			$("#surveyContents").css("display","block");
		}
		
		// 좋아요/싫어요 선택
		$(document).on("click", "#hateButton, #goodButton", function(){
			var sCheckBtn = $(this).attr("id");
			var nSurveySeq = 0;
			
			// 설문문항 초기화
			$("#surveyContents .close_wrap").trigger("click");
			$("#surveyContents .survey_con_wrap").html('');
			
			// '좋아요'-자동 설문참여
			if(sCheckBtn == "goodButton") {
				nSurveySeq = getSimpleSurveyNo();
				
				$("#surveyContents").attr("data-survey",nSurveySeq);
				$("#surveyContents").attr("data-select",1);
				
				sendSimpleSurvey();
			}
			else {
				$("#surveyContents").attr("data-select",2);
				
				selectSimpleSurvey(sCheckBtn);
			}
		});
		
		// 설문 팝업창 닫기
		$(document).on("click", "#checkAddRequestTop5", function(){
			if ($(this).attr('checked')) {

				sendGA('블로그_전화상담 견적요청', '업체 추가 선택');
				
				var checkTopCount = $('#checkAddRequestTopCount').val();
				
	    		$("#write_form .request-addesti__item .request-addesti__list").each(function(index, element){
	    			if (index < checkTopCount) {
	        			$(element).find("input").attr('checked', true);
	    			} else { 
	        			$(element).find("input").attr('checked', false);
	    			}
	    		});
			} else {
				$("#write_form .request-addesti__item .request-addesti__list input[type='checkbox']").attr('checked', false)
			}
		});
		
		// 객관식 보기 선택
		$(document).on("click", "#surveyContents .survey_chk_item", function(){
			if($(this).parent().prev().data("type") == 1) { // 객관식 단일
				if($(this).hasClass('checked')) {
					$(this).removeClass('checked');
				}
				else {
					// 해당 질문의 선택지 체크 모두 해제
					$(this).parent().children().removeClass('checked');
					// 선택한 선택지 체크
					$(this).addClass('checked');
				}
			}
			else if($(this).parent().prev().data("type") == 2) { // 객관식 복수
				if($(this).hasClass('checked')) {
					$(this).removeClass('checked');
				}
				else {
					$(this).addClass('checked');
				}
			}
		});
		
		// 의견 보내기
		$(document).on("click", "#surveyContents .survey_submit", function(){
			sendSimpleSurvey();
		});
    }
});

var doubleSubmitFlag = false;
function doubleSubmitCheck() {
	if(doubleSubmitFlag){
		return doubleSubmitFlag;
	}else{
        doubleSubmitFlag = true;
        return false;
    }
}

//사양이미지 팝업
function itemDetail(element)
{
	var no = $(element).attr('no');
	var subject = $(element).find('#itemTitle').html();
	
	if(no){
		getHttprequest("/gallery/itemImg_detail.php?no="+no,'popup_data');
		openPopup(subject,1000,'');
	}
}

//판매실적 월 조회, 기간 조회
function selectRecord(type)
{
	var TabLi = tab;
	var brand = '';
	var classify = '';
	var monthFrom = monthTo = '';

	if ($("#recordTab li.on").length) {
		TabLi = $("#recordTab li.on").attr('id');
	}

	if ($("#finder_newcar .brandList li.on").length) {
		$("#finder_newcar .brandList li.on").each(function(idx, element){
			if (brand != '') {
				brand += ","
			}

			brand += $(this).data('brand');
		})
	}

	if ($("#classifyFinder .segmentList li.on button").length) {
		
		$("#classifyFinder .segmentList li.on button").each(function(idx, element){
			if (classify != '') {
				classify += ","
			}

			classify += $(this).attr('classify');
		})
	}
	

	if (type == 'month') {
		monthFrom = $("#selMonth option:selected").val() + "-" + $("#selDay option:selected").val() + "-00";		
	}
	else if (type == 'period') {
		if ($("#selMonthFrom option:selected").val() + $("#selDayFrom option:selected").val() > $("#selMonthTo option:selected").val() + $("#selDayTo option:selected").val()) {
			alert('조회 기간이 잘못되었습니다.');
			
			return false;
		}

		var stDate = new Date($("#selMonthFrom option:selected").val(), $("#selDayFrom option:selected").val(), 1) ;
		var endDate = new Date($("#selMonthTo option:selected").val(), $("#selDayTo option:selected").val(), 1) ;
		var btMs = endDate.getTime() - stDate.getTime() ;
		var btDay = btMs / (1000 * 60 * 60 * 24) ;
		
		if (btDay > 366) {
			alert('조회 기간은 최대 1년입니다');
			
			return false;
		}

		monthFrom = $("#selMonthFrom option:selected").val()+"-"+$("#selDayFrom option:selected").val()+"-00";
		monthTo = $("#selMonthTo option:selected").val()+"-"+$("#selDayTo option:selected").val()+"-00";
	}
	else {
		return false;
	}

	(TabLi) ? tabParam = '&Tab=' + TabLi : tabParam = '';
	(brand) ? brandParam = '&Brand=' + brand : brandParam = '';
	(classify) ? classifyParam = '&Classify=' + classify : classifyParam = '';

	location.href = '/' + gnb + '?Work=' + lnb + tabParam + brandParam + classifyParam + '&Month=' + monthFrom + '&MonthTo=' + monthTo;
}

// 파인더
function finderNewcar(){	// 신차 파인더
	var sBrand = "";
	var sClass = "";
	var sFuel = "";
	var sTm = "";
	var sDrive = "";
	var sPrice = "";
	var sDisplace = "";
	var sEffic = "";
	var sEffkd = "";
	var monthTerm = "";		
	var priceType = "";		
	var prodType = "";
	var lnk = "";
	var sOrder = "";
	var sSearchKeyword="";
	var nPunit = $("#leaserentListCount option:selected").val();
	var nMinPrice = "";
	var nMaxPrice = "";
	/* 브랜드 */
	var sCt = 0;
	var tCt = 0;

	//logger
	if(gnb == 'newcar') {
		eval('try{ _trk_clickTrace( \'EVT\', \'자동차_신차_파인더\' ); }catch(_e){ }');
	}else if (gnb == 'leaserent') {
		eval('try{ _trk_clickTrace( \'EVT\', \'자동차_리스/렌트_파인더\' ); }catch(_e){ }');
	}
	
	/* 검색 키워드 */
	var searchedKeyword = $("#leaserentSearchedKeyword").val();
	var tmpSearchKeyword = $("#leaserentInputSearchKeyword").val();
	if (searchedKeyword == tmpSearchKeyword) {
		sSearchKeyword = tmpSearchKeyword;
	}
	
	/* 최저 금액, 최대 금액 */
	var minPrice = $("#leaserentRangeMinPrice option:selected").val()
	var maxPrice = $("#leaserentRangeMaxPrice option:selected").val();
	
	var tmpMinPrice = $("#leaserentSelectedMinPrice").val();
	var tmpMaxPrice = $("#leaserentSelectedMaxPrice").val();
	
	if (minPrice == tmpMinPrice) {
		nMinPrice = tmpMinPrice;
	}
	
	if (maxPrice == tmpMaxPrice) {
		nMaxPrice = tmpMaxPrice;
	}
	
	
	$("#finder_newcar .brandList li").each(function(){
		var ckd = "";
		
		if($(this).hasClass("on")) ckd = "on";
		
		if(ckd){
			if(sBrand) sBrand += ",";
			sBrand += $(this).data("brand");
			sCt ++;
		}
		
		tCt ++;
	});

	if(sCt==tCt) sBrand = "";
	
	/* 차종 */
	var sCt = 0;
	var tCt = 0;
	
	if ($("#finder_newcar .first .segmentList li input:checked").length) {
		$("#finder_newcar .first .segmentList li input:checked").each(function(){
			if(sClass) sClass += ",";
			
			sClass += $(this).data("classify");
		});
	}

	/* 연료 */
	var sCt = 0;
	var tCt = 0;
	
	$("[id ^= 'fuelGroup']").each(function(){
		if($(this).attr("checked")){
			if(sFuel) sFuel += ",";
			
			sFuel += $(this).attr("value");
		}
	});
	
	
	/* 변속기 */
	var sCt = 0;
	var tCt = 0;
	
	$("[id ^= 'tmGroup']").each(function(){
		if($(this).attr("checked")){
			if(sTm) sTm += ",";
			
			sTm += $(this).attr("value");
			sCt ++;
		}
		
		tCt ++;
	});
	
	if(sCt==tCt) sTm = "";
	
	/* 구동 */
	var sCt = 0;
	var tCt = 0;
	
	$("[id ^= 'driveGroup']").each(function(){
		if($(this).attr("checked")){
			if(sDrive) sDrive += ",";
			
			sDrive += $(this).attr("value");
			sCt ++;
		}
		
		tCt ++;
	});
	
	if(sCt==tCt) sDrive = "";
	
	/* 정렬 */
	sOrder = $("#rentleaseSortType .select").data('value');
	
	/* 가격 */ 
	var sL =parseInt( $("#priceGroupL").val());
	var sH = parseInt($("#priceGroupH").val());
	if(sL !=0  && sH !=0  && sL == sH)  sPrice = "";
	else if(sL !=0  && sH !=0  && sL != sH && sL < sH)  sPrice = sL+","+sH;
	else if(sL !=0  && sH !=0  && sL != sH && sL > sH)  sPrice = sH+","+sL;
	else if(sL !=0 )  sPrice = sL+",";
	else if(sH !=0 )  sPrice =","+sH;
	
	/* 배기량 */ 
	var sL = parseInt($("#displaceGroupL").val());
	var sH = parseInt($("#displaceGroupH").val());
	if(sL != 0 && sH != 0 && sL == sH)  sDisplace = "";
	else if(sL != 0 && sH != 0 && sL != sH && sL < sH)  sDisplace = sL+","+sH;
	else if(sL != 0 && sH != 0 && sL != sH && sL > sH)  sDisplace = sH+","+sL;
	else if(sL != 0)  sDisplace = sL+",";
	else if(sH != 0)  sDisplace =","+sH;
	
	/* 연비 */ 
	var sL = parseInt($("#efficGroupL").val());
	var sH = parseInt($("#efficGroupH").val());
	if(sL != 0 && sH != 0 && sL == sH)  sEffic = "";
	else if(sL != 0 && sH != 0 && sL != sH && sL < sH)  sEffic = sL+","+sH;
	else if(sL != 0 && sH != 0 && sL != sH && sL > sH)  sEffic = sH+","+sL;
	else if(sL != 0)  sEffic = sL+",";
	else if(sH != 0)  sEffic =","+sH;
	
	/* 이용기간 */		
	$(".row_period li").each(function(){		
		if($(this).hasClass("select")){		
			monthTerm = $(this).attr('data-value');		
		}		
	});		
	/* 보증금/선납금 */		
	$(".row_pay li").each(function(){		
		if($(this).hasClass("select")){		
			priceType = $(this).attr('data-value');		
		}		
	});		
	/* 렌트리스 구분 */		
	$(".row_rent li").each(function(){		
		if($(this).hasClass("select")){		
			prodType = $(this).attr('data-value');		
		}		
	});

	sEffkd = $("#efficKind").val();
	if(sBrand) lnk +="&Brand="+sBrand;
	if(sClass) lnk +="&Classify="+sClass;
	if(sFuel) lnk += "&Fuel=" + sFuel;
	if(sOrder) lnk += "&Order=" + sOrder;
	if(sSearchKeyword) lnk += "&SearchWord=" + sSearchKeyword;
	if(nPunit) lnk += "&Punit=" + nPunit;
	if(nMinPrice) lnk += "&MinPrice=" + nMinPrice;
	if(nMaxPrice) lnk += "&MaxPrice=" + nMaxPrice;
	
	if(gnb=="newcar" && lnb=="search"){
		if(sFuel) lnk +="&Fuel="+sFuel;
		if(sTm) lnk +="&Tm="+sTm;
		if(sDrive) lnk +="&DriveWheel="+sDrive;
		if(sPrice) lnk +="&Price="+sPrice;
		if(sDisplace) lnk +="&Displace="+sDisplace;
		
		if(sEffic){
			lnk +="&EfficiencyKind="+sEffkd;
			lnk +="&Efficiency="+sEffic;
		}
	}
	else if(gnb=="leaserent" && lnb=="leaserentSearch") {		
		lnk +="&Period="+monthTerm+"&PriceType="+priceType+"&ProdType="+prodType;		
	}
	else if(gnb=="leaserent" && lnb=="mediumTermSearch") {		
		lnk +="&Period="+monthTerm;		
	}
	
	if(lnb=="leaserentSearch") {
		location = "./?Work=leaserentSearch"+lnk;
	}
	else if(lnb=="search") {
		location = "./?Work=search"+lnk;
	}
	else if(lnb=="sales") {
		location = "./?Work=sales"+lnk;
	}
	else if(lnb=="record") {
		var month = $("#selMonth option:selected").val()+"-"+$("#selDay option:selected").val()+"-00";
		var monthTo = '';
		
		if($("#selMonthTo").prop("disabled") == false){
			monthTo = $("#selMonthTo option:selected").val()+"-"+$("#selDayTo option:selected").val()+"-00";
		}
		
		location = "./?Work=record&Tab="+ tab + lnk + "&Month=" + month+"&MonthTo="+monthTo;
	}
	else if(lnb == "mediumTermSearch") {
		location = "./?Work=mediumTermSearch"+lnk;
	}
}

// 가격,제원,사양표 팝업
function getSpecPopup(type, lineup, subject, trims, model)
{
	// 견적/구입 스크립트의 lineup값 가져오기 필요
	if(type && lineup && subject) {
		if (!trims) {
			trims = "";
		}
		
		window.open("/auto/modelPopup.php?Type="+type+"&Lineup="+lineup+"&Trims="+trims, "popup_data"+model, "width=1180,height=800,status=1,scrollbars=yes,resizable=1,left=500,top=150");
	}
}

//카탈로그 변경
function catalogSel(model, no)
{
	if(mobile){
		window.open("/gallery/?Work=gallery_view&Model="+model+"&Tab=catalog&newwindow=2&title=카달로그");
	}
	else{
		if(gnb=="estimate"){
			window.open("/auto/?Work=model&Model="+model+"&Tab=catalog");
		}
		else if(lnb == 'model' && tab == 'image') {
			history.back(-1);
			$("#autodanawa_help").addClass("off");
			getHttprequest("/gallery/catalog.php?Tab=catalog&Model="+model+"&No="+no,"catalogBox");
		}
		else{
			history.back(-1);
			$("#autodanawa_help").addClass("off");
			
			getHttprequest("/gallery/catalog.php?Tab=catalog&Model="+model+"&No="+no,"popup_data");
		}
	}
}

// 사양/옵션 펼치기
function scrollX() {}

//신차 자동차보험 비교 iframe 제어
function receiveMessage(event)
{ 
	$("#compareInsure").height(1500);
	if (event.origin.indexOf("danawa.insvalley") < 0) {
		return;
	}
	else {
    	//console.log(event.data)
    	$("#compareInsure").height(event.data + 20); 
	}
}

//신차 시판모델 리스트
function searchListAjax(page)
{
	if (page == "") {
		page = 1;
	}

	var brandList = [];
	var segmentList = [];
	var attributeList = [];
	
	$('#searchResult .item').each(function(index) {
		var itemId = $(this).attr("id");
		
		// 속성값
		if ( itemId.indexOf('attributeDetailSeq') != -1) {
			attributeList.push($("."+itemId).val());
		// 브랜드
		} else if ( itemId.indexOf('brandSeq') != -1) {
			brandList.push($("."+itemId).data('brand'));
		// 세그먼트
		} else if ( itemId.indexOf('segment') != -1) {
			segmentList.push($("."+itemId).val());
		}
	});	
	
	$("#page").val(page);
	$( "input[type=checkbox]" ).prop("disabled", true);
	$("#container_newcarlist").append('<div class="cover on"><img src="//img.danawa.com/totalMain/ajax-loader.gif" alt="로딩중" class="loader"></div>'); 

	var sort = $("#listSortType").val();
	var rangeMinPrice = $("#rangeMinPrice").val();
	var rangeMaxPrice = $("#rangeMaxPrice").val();
	var searchKeyword = $("#searchKeyword").val();
	var listCount = $("#listCount").val();
	
	// 전기차 주행거리순일 경우
	if (sort == 9 || sort == 10) {
		
		var electronicCarFuelArr = ["2|20|S", "2|964|S"];// 전기차, 수소차 값
		var defaultElectronicCarFuelArr = ["2|20|S"];
				
		if (attributeList.length === 0) { // 선택된 검색 조건이 없을 경우
		
			defaultElectronicCarFuelArr = ["2|20|S"];
			
			defaultElectronicCarFuelArr.forEach((value, index, array) => {
				tmpStrArr = value.split('|');
				
				attributeList.push(value); // 속성 저장 배열 변수에 전기 연료 값 추가
				$(".attributeDetailSeq_" + tmpStrArr[1]).prop('checked', true); // 검색창에 해당 연료가 체크될 수 있도록
				addSearchResult = '<div class="item" id="attributeDetailSeq_' +tmpStrArr[1] + '">' + $(".attributeDetailSeq_" + tmpStrArr[1]).first().next("span").text() + '<button type="button" class="btn_delete attributeDelete"><span class="screen_behind">삭제</span></button></div>'
				$("#searchResult").append(addSearchResult);  // 검색창 아래에 선택된 연료가 보이도록
			});
			$("#searchResult").show();
			
		}	
		else {	
			
			var fuelCnt = 0;
			var fuelCheck = 0; // 전기 연료가 아닌 연료가 체크되어 있는 개수 확인용 변수
			
			for (var i = attributeList.length - 1; i >= 0; i--) {
				var tmpStrArr = attributeList[i].split('|');
				if (tmpStrArr[2] === 'S' && tmpStrArr[0] == 2) { // 연료 속성일 경우
					if (attributeList[i] !== electronicCarFuelArr[0] && attributeList[i] !== electronicCarFuelArr[1]) { // 연료속성이지만 전기차의 연료가 아닐 경우
						$(".attributeDetailSeq_" + tmpStrArr[1]).prop('checked', false); // 체크 제거
						attributeList.splice(i, 1);
						$("#attributeDetailSeq_"+tmpStrArr[1]).remove(); // 검색창 아래에 보이는 선택 옵션 삭제
						fuelCheck++;
					}
					else {
						fuelCnt++;
					}
				}	
			}
			
			if (fuelCheck != 0) {
				alert("전기차 주행거리순일 경우 전기 연료만 선택 가능합니다.");
			}
			
			if (fuelCnt === 0) {
				defaultElectronicCarFuelArr.forEach((value, index, array) => {
					tmpStrArr = value.split('|');
					
					attributeList.push(value); // 속성 저장 배열 변수에 전기 연료 값 추가
					$(".attributeDetailSeq_" + tmpStrArr[1]).prop('checked', true); // 검색창에 해당 연료가 체크될 수 있도록
					addSearchResult = '<div class="item" id="attributeDetailSeq_' +tmpStrArr[1] + '">' + $(".attributeDetailSeq_" + tmpStrArr[1]).first().next("span").text() + '<button type="button" class="btn_delete attributeDelete"><span class="screen_behind">삭제</span></button></div>'
					$("#searchResult").append(addSearchResult);  // 검색창 아래에 선택된 연료가 보이도록
				});
			}
			
		}	
	}
	
	var params = "listSortType="+sort
	+"&tab="+$("#listTab").val()
	+"&rangeMinPrice="+rangeMinPrice
	+"&rangeMaxPrice="+rangeMaxPrice
	+"&searchKeyword="+searchKeyword
	+"&listCount="+listCount
	+"&page="+page
	+"&brandList="+brandList
	+"&segmentList="+segmentList
	+"&attributeList="+attributeList;  

	$.ajax({ 
		type: 'POST', 
		url: 'searchAjax.php', 
		data:params,
		dataType : 'html', 
		success: function(data) {
			if (data.trim() == "noSearch") {
				alert("해당하는 모델이 없습니다.\n다른 옵션을 선택해보세요.");
				$('#searchResult .item').last().find("button").trigger("click");
			} else {
				$("#container_newcarlist").html(data);
				drawADScript('newcarList');
				
				if(sessionStorage.getItem("surveyNewcarSearch") == null || sessionStorage.getItem("surveyNewcarSearch") == false) {
    				$("#surveyContents.goodslist_survey").css("display","block");
    			}
			}
		},complete : function() {
			$("input[type=checkbox]").prop("disabled", false); 
			$("input[data=comming]").prop("disabled", true);
			$(".cover").removeClass("on");
			
			if ($("#newcarAdList").length && $("#newcarAdList ul li").length) {
				$("#newcarAdList ul li").each(function(index, item){
					sendGA('보험가입노출', $(this).data('modelname'));
				});
			}
	    }
	});
	
	var changeUrl = "/newcar/?&page="+page;
	history.pushState(null, null, changeUrl);
}

function initCounsel(level)
{
	if (level > 1) {
		$("#sido option:eq(0)").prop("selected", true);
		$("#sigungu option:eq(0)").prop("selected", true);
		$("#counsel_type input[type='checkbox']").prop("checked", false);
		$("#counsel_time input[type='radio']:eq(0)").prop("checked", true);
		$("#counsel_reply input[type='radio']:eq(1)").prop("checked", true);
	}

	if (level > 0) {
		$("#counsel_plan #cashPrice").val("");
		$("#counsel_plan #instalmentPrice").val("");
		$("#counsel_plan #instalmentPeriod option:eq(0)").prop("selected", true);
		$("#requestContents").val("");
	}
}

function checkEssentialItem(isAlert) {}

function drawADScript(type)
{ 
	// 신차 광고스크립트
	if (type == 'newcarList') {
    	var modelList = $("#container_newcarlist .modelList li");
    
    	if ($("#adScipt_newcarList").length && $("#adScipt_newcarList").html().indexOf("empty.gif") == -1 && modelList.length) {    
    		if (modelList.length > 2) {
    			$(modelList.get(2)).after($("#adScipt_newcarList").html());
    		}
    		else {
    			modelList.last().after($("#adScipt_newcarList").html());
    		}
    	}
	}
}

/* 탭 공통 */	
function tabRotateControl (thms, num)
{
	var thisTab = 1;
	var CtB = 1;
	
	$("#"+thms+" .TabContents > li").each(function(){
		if ($(this).hasClass("on")) thisTab = CtB;
		CtB ++;
	});
	
	if (num == 'Before') nextTab = thisTab - 1;
	else if (num == 'Next') nextTab = thisTab + 1;
	else if (num) nextTab = num;
	else nextTab = thisTab + 1;
	
	if (nextTab < 1) nextTab = CtB -1;
	else if (nextTab >= CtB) nextTab = 1;
	
	CtB = 1;
	
	$("#"+thms+" .TabContents > li").each(
		function()
		{
    		if (nextTab == CtB) $(this).addClass("on");
    		else $(this).removeClass("on");
    		
    		CtB ++;
		}
	);
}

// 롤링 시작
function tabRotateStart (thms)
{
	tabIntObj[thms] = setInterval("tabRotateControl('"+ thms +"','')", tabIntSet[thms]);
}

// 롤링 종료
function tabRotateStop (thms)
{
	clearTimeout(tabIntObj[thms]);
}

// 테마 레이어 표시 
function themeMainChange (set, no)
{
	$("."+ set +" .topic li").removeClass("on");
	$("."+ set +" .theme .cont").removeClass("on");
	$("."+ set +" .topic li[theme='"+ no +"']").addClass("on");
	$("."+ set +" .theme .cont[theme='"+ no +"']").addClass("on");
}

/** 가격표 유지비용 계산 **/
function maintainCostChange (trimNo) {
	if(autoDataArray != null) {
		autoDataArray.forEach(function(subItem) {
			if("T" + trimNo ==  subItem.code) {
				var str = dnw_deChar2(subItem.cont);
				dnw_array2(str,"setTrms");
				
				var strSelf = dnw_deChar2(autoCostDataArray);
				dnw_array2(strSelf, 'setCost');
				
				infos = new Array();// 부가정보 처리
				setFree = new Array(); // 면세 조건
				codes = new Array(); // 코드 설정 정리 code(코드) free(면세) zone(지역) othr(다자녀) 
				
				codes.year = $(".eSelMantYear" + trimNo).val();
				codes.mile = $(".eSelMantMile" + trimNo).val();
				/** 면세 조건 셋팅후 tfree_value 넣기 **/
				tfree_value($(".eSelFreeKind" + trimNo).val());
				
				setSpecKeyValue();
//				calculate_infos();
				/** calculate_infos() 함수 미작동으로 임시 소스적용**/

				/* 자동차세 */
				infos.ytax = 0; // MtSet[0] 
				if(setFree.enty==0 || setFree.enty==1 || setFree.enty==4){	// 비영업용
					// 2013-12-23 전기차 기능 추가
					// 2023.03.07 수소연료전치 추가
					if(setTrms.fuel.indexOf("E")>=0 || setTrms.fuel.indexOf("H")>=0){	
						infos.ytax = 100000 * 1.3;
					}else if(setTrms.dvsn.indexOf("P")>=0){	// 배기량에 30% 교육세 추가..
						if(setTrms.disp<=1000) infos.ytax = setTrms.disp * 80 * 1.3;
						else if(setTrms.disp<=1600) infos.ytax = setTrms.disp * 140 * 1.3;
						else infos.ytax = setTrms.disp * 200 * 1.3;
					}else if(setTrms.dvsn.indexOf("B")>=0){
						if(setTrms.prsn == "SG" || setTrms.prsn<100) infos.ytax = 65000;
						else if(setTrms.prsn == "LG") infos.ytax = 115000;
					}else if(setTrms.dvsn.indexOf("T")>=0){
						if(setTrms.load<=1000) infos.ytax = 28500;
						else if(setTrms.load<=2000) infos.ytax = 34500;
						else if(setTrms.load<=3000) infos.ytax = 48000;
						else if(setTrms.load<=4000) infos.ytax = 63000;
						else if(setTrms.load<=5000) infos.ytax = 79500;
						else if(setTrms.load<=8000) infos.ytax = 130500;
						else if(setTrms.load<=10000) infos.ytax = 157500;
						else infos.ytax = 157500 + number_round((setTrms.load - 10000)/10000,1,"floor") * 30000;
					}
				}else{	// 영업용
					if(setTrms.fuel.indexOf("E")>=0 || setTrms.fuel.indexOf("H")>=0){	// 2013-12-23 전기차 기능 추가
						infos.ytax = 20000;
					}else if(setTrms.dvsn.indexOf("P")>=0){	// 배기량에 30% 교육세 추가..
						if(setTrms.disp<=1600) infos.ytax = setTrms.disp * 18;
						else if(setTrms.disp<=2500) infos.ytax = setTrms.disp * 19;
						else infos.ytax = setTrms.disp * 24;
					}else if(setTrms.dvsn.indexOf("B")>=0){
						if(setTrms.prsn == "SG" || setTrms.prsn<100) infos.ytax = 25000;
						else if(setTrms.prsn == "LG") infos.ytax = 42000;
						else if(setTrms.prsn == "SR") infos.ytax = 50000;
						else if(setTrms.prsn == "LR") infos.ytax = 70000;
						else if(setTrms.prsn == "EX") infos.ytax = 100000;
					}else if(setTrms.dvsn.indexOf("T")>=0){
						if(setTrms.load<=1000) infos.ytax = 6600;
						else if(setTrms.load<=2000) infos.ytax = 9600;
						else if(setTrms.load<=3000) infos.ytax = 13500;
						else if(setTrms.load<=4000) infos.ytax = 18000;
						else if(setTrms.load<=5000) infos.ytax = 22500;
						else if(setTrms.load<=8000) infos.ytax = 36000;
						else if(setTrms.load<=10000) infos.ytax = 45000;
						else infos.ytax = 45000 + number_round((setTrms.load - 10000)/10000,1,"floor") * 10000;
					}
				}
				infos.ytax = number_round(infos.ytax,10,"floor");
				
				/* 연간 자동차세 */
				/* 장애인 면세 확인 */
				var freeH = 0;	// 지방세 장애인 면세
				
				if(setTrms.dvsn.indexOf("P")>=0 && (setTrms.disp <= 2000 || setTrms.prsn >= 7)) freeH = 1;
				else if(setTrms.dvsn.indexOf("B")>=0 && setTrms.prsn <= 15) freeH = 1;
				else if(setTrms.dvsn.indexOf("T")>=0 && setTrms.load <= 1000) freeH = 1;
				
				if(setFree.enty==0 && freeH){	// 장애인
					infos.ytax = 0;
					infos.ytaxK = setFree.grup;
				}
				else{
					infos.ytaxK = "";
				}
				
				/* 기간 중 자동차세 */	
				infos.ytaxS = 0;
				
				if (setTrms.dvsn.indexOf("P") >= 0 && setFree.enty == 1) {
					// 2013-12-23 전기차 기능 추가
					// 2023.03.07 수소연료전치 추가
					if(setTrms.fuel.indexOf("E")>=0 || setTrms.fuel.indexOf("H")>=0){	
						infos.ytaxS += infos.ytax * codes.year;
					}
					else {
						for( my = 1; my <= codes.year; my++) {
							/*
							 * 2021-01-12 자동차 세금감면 개선
							 * 구입 후 2년뒤(3년째부터 그해의 세금만 감면됨), 기존 총액 할인에서 변경함
							 */ 
							var dcT = my > 2 ? (1 - (0.05 * (my - 2))) : 1;
							var temp_ytax = number_round(infos.ytax * dcT, 10, "floor");
							
							infos.ytaxS += temp_ytax;
						}
					}
				}
				else {
					if (infos.ytax < 100000) {
						infos.ytaxS = number_round(infos.ytax * 0.9, 10, "floor") * codes.year;
					}
					else {
						infos.ytaxS = infos.ytax * codes.year;
					}
					
					/*hTax = number_round(infos.ytax * 0.5, 10, "floor");
					
					if(hTax<50000) infos.ytaxS = (hTax + number_round(hTax * 0.9, 10, "floor")) * codes.year;
					else infos.ytaxS = hTax * 2 * codes.year; // 자동차세액*/
				}

				/* 유류비 계산 */
				infos.effm = setTrms.effm;
				infos.effc = setTrms.effc;
				infos.effh = setTrms.effh;
				infos.disp = setTrms.disp;
				infos.year = codes.year;
				infos.mile = codes.mile;
				infos.fuelC = 0;
				
				if(setTrms.fuel.substring(0,1) =="G"){
					infos.fuel = "가솔린";
					if(setTrms.effm!="0.0") infos.fuelC = setCost.costG;
				}
				else if(setTrms.fuel.substring(0,1) =="D"){
					infos.fuel = "디젤";
					if(setTrms.effm!="0.0") infos.fuelC = setCost.costD;
				}
				else if(setTrms.fuel.substring(0,1) =="L"){
					infos.fuel = "LPG";
					if(setTrms.effm!="0.0") infos.fuelC = setCost.costL;
				}
				else if(setTrms.fuel.substring(0,1) =="E"){	// 2013-12-23 전기차 기능 추가
					infos.fuel = "전기";
					if(setTrms.effm!="0.0") infos.fuelC = setCost.costE;
				}
				else if(setTrms.fuel.substring(0,1) =="C"){	// 2017-08-02 CNG 기능 추가
					infos.fuel = "CNG";
				}
				else if(setTrms.fuel.substring(0,1) =="H"){	// 2018-03-21 수소 기능 추가
					infos.fuel = "수소";
					if(setTrms.effm!="0.0") infos.fuelC = setCost.fHFCDailyPrice;
				}
				
				if(!_.isEmpty(setTrms.newSpec.specFuelName)) {
					infos.fuel = setTrms.newSpec.specFuelName;
				}
	
				if(setTrms.fuel.substring(0,1) =="E" || setTrms.fuel.substring(0,1) =="H") {
					infos.effm = setTrms.newSpec.specElectricEfficiencyMix;
					infos.disp = setTrms.newSpec.specElectricMileage;
				} else {
					infos.effm = setTrms.newSpec.specEfficiencyMix;
					infos.disp = setTrms.newSpec.specDisplace;
				}
				
				if(infos.fuelC){
					infos.fuelS = number_round( codes.year * codes.mile / infos.effm * infos.fuelC,10,"round");
				}
				else{
					infos.fuelS = 0;
				}
				
				/* 유지비용 합계 */
				infos.total = infos.ytaxS + infos.fuelS;
				
				/** //calculate_infos **/
				
				var taxYear = "";
				if(infos.ytaxK){
					taxYear = "장애인 면제";
				}
				else{
					taxYear = number_format(infos.ytax);
				}
				$(".eRsltCarTaxYear" + trimNo).text(taxYear);
				$(".eRsltCarTax" + trimNo).text(number_format(infos.ytaxS));

				if(setTrms.fuel.substring(0,1) == "E"){
					$(".eRsltFuelText" + trimNo).text(infos.fuel+" "+number_format(infos.fuelC)+"원/㎾h");
					if(_.isEmpty(infos.effm)) {
						$(".eRsltFuelEffic" + trimNo).text("복합전비 인증中");
					} else {
						$(".eRsltFuelEffic" + trimNo).text(infos.effm+"㎞/㎾h");
					}
				} else if(setTrms.fuel.substring(0,1) =="H") {
					$(".eRsltFuelText" + trimNo).text(infos.fuel+" "+number_format(infos.fuelC)+"원/㎏");
					if(_.isEmpty(infos.effm)) {
						$(".eRsltFuelEffic" + trimNo).text("복합전비 인증中");
					} else {
						$(".eRsltFuelEffic" + trimNo).text(infos.effm+"㎞/㎏");
					}
				} else{
					$(".eRsltFuelText" + trimNo).text(infos.fuel+" "+number_format(infos.fuelC)+"원/ℓ");
					if(_.isEmpty(infos.effm)) {
						$(".eRsltFuelEffic" + trimNo).text("복합연비 인증中");
					} else {
						$(".eRsltFuelEffic" + trimNo).text(infos.effm+"㎞/ℓ");
					}
				}
				
				$(".eRsltFuelCost" + trimNo).text(number_format(infos.fuelS));
				
				number_animate(infos.total,".eRsltMantSum" + trimNo);	// 유지합계
			}
		});	
	}
}

function getSimpleSurveyNo() {
	var nSurveySeq = 0;
	
	if(bIsReal) {
		if(gnb == 'newcar') {
			if(lnb == 'search') {
				nSurveySeq = 22;
			}
			else if(lnb == 'request') {
				nSurveySeq = 24;
			}
		}
		else if(gnb == 'leaserent') {
			if(lnb == 'leaserentSearch') {
				nSurveySeq = 26;
			}
			else if(lnb == 'priceCompare') {
				nSurveySeq = 28;
			}
		}
		else if(gnb == 'auto') {
			nSurveySeq = 30;
		}
	}
	else {
		if(gnb == 'newcar') {
			if(lnb == 'search') {
				nSurveySeq = 53;
			}
			else if(lnb == 'request') {
				nSurveySeq = 55;
			}
		}
		else if(gnb == 'leaserent') {
			if(lnb == 'leaserentSearch') {
				nSurveySeq = 57;
			}
			else if(lnb == 'priceCompare') {
				nSurveySeq = 49;
			}
		}
		else if(gnb == 'auto') {
			nSurveySeq = 51;
		}
	}
	
	return nSurveySeq;
}

// 간편설문 조회
function selectSimpleSurvey(sCheckBtn) {
	var nSurveySeq = 0;
	var styleObj = {};
	
	nSurveySeq = getSimpleSurveyNo();
	
	$.ajax({
		type:"GET",
		url : "/service/ajax_simpleSurvey.php",
		data: {
			"flag" : 'inquiry',
			"nSurveySeq" : nSurveySeq,
			"sGnb" : gnb,
			"sLnb" : lnb
		},
		dataType : "text",
		error : function(request, status, error) {
			alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
		},
		success: function (data, status) {
			if (status == 'success') {
				if(gnb != "auto") {
					if(sCheckBtn == "hateButton") {
						$("#surveyContents").removeClass("good_open");
						$("#surveyContents").addClass("open");
					}
					else if(sCheckBtn == "goodButton") {
						$("#surveyContents").removeClass("open");
						$("#surveyContents").addClass("good_open");
					}
				}
				
				$("#surveyContents").attr("data-survey",nSurveySeq);
				
				// 팝업창 표시
				if(gnb == "newcar" && lnb == "request") {
					$("#surveyContents .estimate_con_wrap").html(data);
				}
				else {
					// 팝업창 위치조정
					if(gnb == "auto") {
						styleObj = {'display':'block','top':0,'right':0};
					}
					else if(gnb == "leaserent") {
						styleObj = {'display':'block','bottom':'-225px'};
					}
					
					$("#surveyContents .survey_con_wrap").html(data);
					$("#surveyContents .survey_con_wrap").css(styleObj);
					
					if(sCheckBtn == "hateButton") {
						window.setTimeout(function(){
					        var target = $("#surveyContents div.survey_con_wrap").attr("tabindex","-10").focus();
					    },500);
					}
				}
			}
			else {
				
			}
		}
	});
}

function sendSimpleSurvey() {
	var answeres = [];

	// 질문 선택지 체크
	$("#surveyContents .title").each(function() {
		var nQuestionType = $(this).data("type");
		var nQuestionSeq = $(this).data("seq");

		var nItemSeq = "";
		var sAnser = "";
		
		if(nQuestionType == 1 || nQuestionType == 2) { // 객관식
			$(this).next().children(".checked").each(function() {
				nItemSeq == "" ? nItemSeq = $(this).data("itemseq") : nItemSeq += "," + $(this).data("itemseq");
			});
			
			answeres.push({
				nSurveyQuestionItemSeq : nItemSeq,
				sAnswer : '',
				nSurveyQuestionSeq : nQuestionSeq,
				nQuestionType : nQuestionType
			});
		}
		else if(nQuestionType == 3) { // 주관식
			nItemSeq = $(this).next(".survey_con").data("itemseq");
			sAnser = $("textarea[name=textAnswer]").val();
			
			answeres.push({
				nSurveyQuestionItemSeq : nItemSeq,
				sAnswer : sAnser,
				nSurveyQuestionSeq : nQuestionSeq,
				nQuestionType : nQuestionType
			});
		}
	});
	
	var param = {
			flag : 'response',
			nSurveySeq : $("#surveyContents").data("survey"),
			sSelect : $("#surveyContents").data("select"),
			sBid : $.cookie("danawa-loggingApplicationClient"),
			itemsData : answeres
	}
	
	$.ajax({
		type:"GET",
		url : "/service/ajax_simpleSurvey.php",
		data: param,
		dataType : "text",
		error : function(request, status, error) {
			alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
		},
		success: function (data, status) {
			if (status == 'success') {
				if(gnb == 'newcar') {
					if(lnb == 'search') {
						sessionStorage.setItem("surveyNewcarSearch",true);
					}
					else if(lnb == 'request') {
						sessionStorage.setItem("surveyNewcarRequest",true);
					}
				}
				else if(gnb == 'leaserent'){
					if(lnb == 'leaserentSearch') {
						sessionStorage.setItem("surveyLeaserentSearch",true);
					}
					else if(lnb == 'priceCompare') {
						sessionStorage.setItem("surveyLeaserentPriceCompare",true);
					}
				}
				else if(gnb == 'auto') {
					sessionStorage.setItem("surveyAutoSide",true);
				}
				
				// 팝업창 닫기
				if(gnb != 'auto') {
					if($("#surveyContents").hasClass("good_open")) {
						$("#surveyContents").removeClass("good_open");
					}
					else if($("#surveyContents").hasClass("open")) {
						$("#surveyContents").removeClass("open");
					}
				}
				else {
					$("#surveyContents .survey_con_wrap").css("display","none");
				}
				
				if(gnb == 'auto') {
					$("#surveyContents .goods_aside_survey").html("<span class='answer'>감사합니다.<br/>더 노력하는 다나와가 되겠습니다.</span>");
				}
				else {
					$("#surveyContents").html("<span class='answer'>감사합니다. 더 노력하는 다나와가 되겠습니다.</span>");
				}
			}
			else {
				
			}
		}
	});
}

//트림 제원값 key, value 설정
function setSpecKeyValue() {
	if(!_.isUndefined(setTrms.newSpec) && !_.isEmpty(setTrms.newSpec)) {
		var tempArray = setTrms.newSpec.split("|");
		
		setTrms.newSpec = {};
		tempArray.forEach(function(item) {
			var subArray = item.split(":");
			if(subArray.length == 2) {
				setTrms.newSpec[subArray[0]] = subArray[1]
			}
		});
	}
}

// 메인 렌트/리스 간편상담 세부항목
function setSimpleRentLeaseLineup() {
	$.ajax({
		type:"GET",
		url : "/service/ajax_leaserent_simple_productList.php",
		dataType : "json",
		data : {
			"model" : $("#modelCode").val(),
			"trim" : $("#trimsCode").val(),
			"monthTerm" : $("#period").val(),
			"prodType" : $("#prodType").val(),
			"priceType" : $("#priceType").val()
		},
		error : function(request, status, error) {
			console.log("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
		},
		success : function(data) {
			$('.request-model__terms .box__select .box__lineup').html(data);
		}
	});
}

// 메인 렌트/리스 업체 리스트 재설정
function setSimpleRentLeaseProductList() {
	
	$("#rentLeaseSubmit").removeClass('on');

	$.ajax({
		type:"GET",
		url : "/service/ajax_productListMaker.php",
		dataType : "json",
		data : {
			"Trims" : $("#trimsCode").val(),
			"Period" : $("#period").val(),
			"ProdType" : $("#prodType").val(),
			"PriceType" : $("#priceType").val()
		},
		error : function(request, status, error) {
			console.log("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
		},
		success : function(data) {
			$('.request-addesti__wrap').html(data);
			
			if ($("#write_form input[name='name']").val() &&
				($("#write_form input[name='validatedPhoneNumber']").val() || $("#write_form #userPhone2").val())
				&& $("#write_form #agreeCheck1").is(":checked") 
				&& $("#write_form #agreeCheck2").is(":checked") 
				&& $("#write_form #sigungu").val()
				&& $('input[type="checkbox"][id^="r-addesti_"]:checked').length > 0) {
				$("#rentLeaseSubmit").addClass('on');
			} else {
				$("#rentLeaseSubmit").removeClass('on');
			}
		}
	});
}

// 메인 렌트/리스 초기납부금액 재설정
function setSimpleRentLeaseFirstAmount() {
	// 초기 납부금액
							
	var totalAmount = $(".request-model__terms .box__select input[name='radio_01']:checked").data('total');
	var priceType = $(".request-model__terms .box__option #pricetype li.on").data('pricetype');
	var firstAmount = "";
	
	if (totalAmount) {
		var ratio = 0;
		if(priceType != '1') {
			ratio = 0.3;
		}
		
		var total = totalAmount.replace(/\,/g, '')
		var tmpAmount = Math.floor(total * ratio);
		firstAmount = tmpAmount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
	}	
	
	$(".box__initial .text__number").text(firstAmount + "원");
}