if(!documentDom) document.domain="danawa.com";	// 기본 설정, 설정하지 않으려면 documentDom = true; 표시..
var clickX;
var clickY;

//hash감지
window.onhashchange = function (event) {
	if($("#catalog_popup").attr("class") == '' && document.location.hash.indexOf('gallery') < 0){
		$("#catalog_popup").addClass("off");		
	}
	else if($("#autodanawa_help").attr("class") == ''  && document.location.hash.indexOf('help') < 0){
		$("#autodanawa_help").addClass("off");		
	}
	else if($("#autodanawa_popup").attr("class") == ''  && document.location.hash.indexOf('popup') < 0){
		$("#autodanawa_popup").addClass("off");
	}
	else if (!$("#layerPopup").hasClass("off") && document.location.hash.indexOf('popup') < 0) {
		$("#layerPopup .btn-close").click();
	}
}

// IE8 Trim()생성
if(typeof String.prototype.trim !== 'function') {
  String.prototype.trim = function() {
    return this.replace(/^\s+|\s+$/g, ''); 
  };
}

$(function(){	
	$(window).load(function(){
		if(!$("#searchWord").val()){
			$("#searchWord").attr("road","1")
			$("#searchWord").val($("#searchWindow").text());
		}
	});

	$(document).ready(function() {
		
		$(".draggable").draggable();
		
		// GNB 제어
		$("#autodanawa_header .gnb__list").hover(function(){
			eval('try{ _trk_clickTrace( \'EVT\', \'자동차_GNB_전체\' ); }catch(_e){ }');
			$("#autodanawa_header #gnbMenu").addClass('gnb--active');
			$("#autodanawa_header .gnb__list").addClass('gnb--hover');
			$("#gnbDimm").addClass('active');
		}, function(){
			$("#autodanawa_header #gnbMenu").removeClass('gnb--active');
			$("#autodanawa_header .gnb__list").removeClass('gnb--hover');
			$("#gnbDimm").removeClass('active');
		});
		
		//230823, GNB 개선
		$(".link__user--login, #loginLayer, .layer__user-more").hover(function(){
			$(".layer__user-more").show();
		}, function(){
			$(".layer__user-more").hide();
		});
		
		// GNB 제어 snb
		$("#gnbMenu div.gnb__col").hover(function(){
			$(this).addClass('on');
		}, function(){
			$(this).removeClass('on');

			if(typeof(gnb) != undefined) {
				if(gnb == 'leaserent' || gnb == 'newcar' || gnb == 'usedcar' || gnb == 'auto' || gnb == 'news' || gnb == 'event') {
					$('#gnbMenu').find('.gnb__' + gnb).addClass('on');
				}
			}
		});
		
		$(document).on('focus', '#autodanawa_header .gnb__list', function(){
			eval('try{ _trk_clickTrace( \'EVT\', \'자동차_GNB_전체\' ); }catch(_e){ }');
			$("#autodanawa_header .gnb__list").addClass('gnb--hover');
		});
		
		$(document).on('click', "#autodanawa_header .gnb__list .btn-close", function(){
			$("#autodanawa_header .gnb__list").removeClass('gnb--hover');
		});
		
		// FOOTER 제어
		$(document).on('click', "#content_guide, #address_guide, #goodcont_guide", function(){
			if ($("#"+$(this).attr('id')+"__popup").length) {
				$("#"+$(this).attr('id')+"__popup").show();
			}
		});
		
		$(document).on('click', "#content_guide__popup .btn-close, #address_guide__popup .btn-close", function(){
			$(this).closest(".footer-layer").hide()
		});
		
		$("body").click(function(e) { 
		    if($("#content_guide__popup").css("display") == "block") {
		    	if(!$('#content_guide__popup').has(e.target).length) { 
		    		$("#content_guide__popup").hide()
		    	}
		    }
		    else if($("#address_guide__popup").css("display") == "block"){
		    	if(!$('#address_guide__popup').has(e.target).length) {
		    		$("#address_guide__popup").hide()
		    	}
		    }
		});
		
		$(document).on('click', '.sendGA', function(){
			var actionLabel = $(this).data('actionlabel').split("`");
			sendGA(actionLabel[0], actionLabel[1]);
		});
		
		$(document).on('click', '.sendGAExcpt', function(){
			var categoryActionLabel = $(this).data('categoryactionlabel').split("`");

			sendGAExcpt(categoryActionLabel[0], categoryActionLabel[1], categoryActionLabel[2]);
		});
		
		$(document).on('click', '.naverScript', function(){
			var typeValue = $(this).data('typevalue').split("`");
			naverScript(typeValue[0], typeValue[1]);
		});
		
		// AUTO-1989 웹 방화벽 xss 차단 우회
		$(document).on('click', '.proxyAlert', function(){
			var msg = $(this).data('msg');
			
			if (msg != "") {
				alert(msg)
			}
		});
	});

	$(document).on('focus', '#autodanawa_header .gnb .list > li.newcar a', function(){
		$('.menuMore').removeAttr("style");
	});

	$(document).on('focus', '#autodanawa_header .main .banner a, #autodanawa_header .main .banner img', function(){
		$('.menuMore').removeAttr("style");
	});

	$(document).on('click', "#autodanawa_header .close", function () {
		var date = new Date();
		
		$('.adverTop').hide();
		$('#autodanawa_right').addClass('banneroff');

		date.setTime(date.getTime() + (360 * 60 * 1000));
		document.cookie = "houseBannerOff" + "=" + "1" + "; path=/; expires=" + date + ";";
		
	});

	//다나와 앱 layer on off (요소 선택)
	$(document).on('click', "#title_mobileApp, #autodanawa_right .mobile, #mobile_service_layer .btn_apps_close, .obd2ContBox .floatingAppInstall img", function () {
		var type = $(this).data('type');	//top, side, undifined
		var layerElment = $("#mobile_service_layer");	// layer div
		
		$('.top_mobileApp').removeClass('on');
		
		if (layerElment.css('display') == 'block' && (layerElment.data('position') == type || type === undefined)) {
			layerElment.css('display','none');
			layerElment.find(".input_size_01").val("");
		}
		else {
			if (type == 'top') {
				$('.top_mobileApp').addClass('on');
				layerElment.css({"top":29, "left":0, 'position':'absolute'});
				
			}
			else if (type == 'side') {
				var offset = $('#autodanawa_right .mobile').offset();
				var height = layerElment.height();
				var width = layerElment.width();

				layerElment.css({"top":offset.top-height, "left":offset.left-(width+12), 'position':'fixed'});
			}
			else if (type == 'appInstall') {
				var offset = $('.obd2ContBox .floatingAppInstall img').offset();
				var height = layerElment.height();
				var width = layerElment.width();

				layerElment.css({"top":height+45, "left":offset.left-(width+12), 'position':'fixed'});
				getLayerInfo($("#mobile_service_layer .gnb_apps_list a:eq(2)"),'carscan');
			}
			
			layerElment.data("position", type);
			layerElment.css('display','block');
		}
	});
	
	// 다나와 앱 레이어 외부 클릭 닫기
	$(document).mouseup(function (e){
		 if (!$('#mobile_service_layer').is(e.target) && $('#mobile_service_layer').has(e.target).length === 0) {
	         var type = $(this).data('type');	//top, side, undifined
		     var layerElment = $("#mobile_service_layer");	// layer div
		     
		     if (layerElment.css('display') == 'block' && (layerElment.data('position') == type || type === undefined)) {
		    	 $('.top_mobileApp').removeClass('on');
		    	 
		    	 layerElment.css('display','none');
				layerElment.find(".input_size_01").val("");
		     }
		 }
	  });

	// 상단 광고 - 열기
	$(document).ready(function() {
		$("#adver_MouseOver").hover(function () { 
			var adverBoxType = '';
			var imgPath = $(this).parent().prev().attr("src");
			var dealy = 300;	//0.3초
			
			if(imgPath == "//autoimg.danawa.com/html/images/banner/DA_house_20161031.jpg"){
				adverBoxType = 'febreze';
				dealy = 100;
			}
			else if (imgPath == "//autoimg.danawa.com/html/images/banner/DA_house_20161216.jpg") { 
				adverBoxType = 'grendeur';
			}
			else if (imgPath == "//autoimg.danawa.com/html/images/banner/DA_house_20170206.jpg") { 
				adverBoxType = 'zic';
			}
			else if (imgPath == "//autoimg.danawa.com/html/images/banner/DA_house_20170602.jpg") { 
				adverBoxType = 'sscd';
				$("#adver_youtube_sscd").attr("src", 'https://www.youtube.com/embed/Nx27m9c10Lo?rel=0&amp;controls=0&amp;showinfo=0&amp;autoplay=1&amp;playlist=Nx27m9c10Lo&amp;loop=1');
			}

			if(adverBoxType == ''){
				return false;
			}
			
			timeoutId = setTimeout(function () { 
				var pureBoxDisplay = $('#adver_box_'+adverBoxType).css('display');
				if(pureBoxDisplay!="block"){
					// 딜레이 영상재생
					var movieDiv = $("#adver_youtube_"+adverBoxType);
					movieDiv.attr("src", movieDiv.attr("data-start"));
				}
				
		        $("#adver_box_"+adverBoxType).fadeIn(500);
		    }, dealy); 
		}, function () { 
			if (timeoutId) {
				clearTimeout(timeoutId); 
			} 
			timeoutId = false;
		});  
	});	

	//상단 광고 - 닫기
	$(document).on("click","#adver_close_pruedrive, #adver_close_pruedrive2, #adver_close_febreze, #adver_close_grendeur, #adver_close_zic, #adver_close_sscd",function(){
		var adverBoxType = '';
		if($(this).attr('id') == 'adver_close_pruedrive') {
			adverBoxType = 'pruedrive';
		}
		else if($(this).attr('id') == 'adver_close_pruedrive2') {
			adverBoxType = 'pruedrive2';
		}
		else if($(this).attr('id') == 'adver_close_febreze') {
			adverBoxType = 'febreze';
		}
		else if($(this).attr('id') == 'adver_close_grendeur') {
			adverBoxType = 'grendeur';
		}
		else if($(this).attr('id') == 'adver_close_zic') {
			adverBoxType = 'zic';
		}
		else if($(this).attr('id') == 'adver_close_sscd') {
			adverBoxType = 'sscd';
		}
		
		if(adverBoxType == ''){
			return false;
		}
			
		$("#adver_box_"+adverBoxType).hide();
		var movieDiv = $("#adver_youtube_"+adverBoxType);
		movieDiv.attr("src", movieDiv.attr("data-start").replace("&autoplay=1", '') );  
	});
	
	/* 팝업 레이어/팁 띄우기 */
	$(document).on("click",".popupTipOn",function(){
	 	var loca = "";
	 	if($(this).attr("loc")) loca=$(this).attr("loc");
	 	
	 	var contW = 900;
	 	if($(this).attr("lnkW")) contW=$(this).attr("lnkW");
	 	
	 	docuW = $(document).width();
	 	docuH = $(document).height();
	 	
	 	var lnk=$(this).attr("lnk");
	 	
	 	if($(this).attr("class").indexOf("popupTipOn")>=0){
	 		var pbox = "popupTipCont";
	 	}else if($(this).attr("class").indexOf("popupEstmOn")>=0){
	 		var pbox = "popupEstmCont";
	 	}else{
	 		var pbox = "popupLayerCont";
	 	}
	 	
	 	if(pbox != "popupEstmCont") getHttprequest(lnk+"&Type=popup",pbox);
	 	
	 	if(lnk.indexOf("Cont=")>0){	// b2b 견적 안내문 저장..
	 		$("#goodsCont").val($("#b2bGoods").val());
	 	}
	 	
		popupLayer_on(pbox,loca,docuW,docuH,contW); /* 열고자 하는 것의 아이디를 입력 */
		
		if(pbox == "popupEstmCont"){ // 견적, 비교하기 등 외부연결 예상되는 컨텐츠 일때..
			var hrf = location.href.split("#");
			
			location.href = hrf[0]+"#estmCont";
			calculate();
		}
		else if(pbox == "popupLayerCont" && lnk.indexOf("estimateG.php")>0){ // 레이어팝업 호출.. 견적 코드 지정하여 호출..
			emod = "modl";
			ebox = "modl";
			calculate();
		}
		
		return false;
	});
	  
	  /* 게시물 신고 */
	$(document).on("click","#reportBtn",function(){
		var rExp=$("#rExpetc").val();
		var fmInfo=$(this).attr("fmval");
		
		if(rExp=="")alert("관리요청 사유를 선택하거나 직접 입력해 주세요");		
		else{
			$("#boardInfo"+fmInfo+" > .reportExp").val(rExp);
			$.ajax({ 
				type : "POST"
				, async : true
				, url : "/service/ajax_reportResult.php"
				, dataType : "json"
				, timeout : 30000
				, cache : false
				, data : $("#boardInfo"+fmInfo).serialize()
				, contentType: "application/x-www-form-urlencoded; charset=UTF-8" 
				, error : function(request, status, error) { 
					alert("code : " + request.status + "\r\nmessage : " + request.reponseText); 
				} 
				, success : function(data) {
					alert(data['msg']);
					if(data['rslt'])window.location.reload();
				} 
			});
					
		}
		
	});
	  
	//검색창 클릭
	$(document).on('click', '#searchWord', function(){
		if($(this).attr("road")=="1"){
			$(this).attr("road","");$(this).val("");
		}
	});
	
	//자동완성
	/* 180528 자동완성 기능 제외 요청 */
	$('#searchWord').on('keyup', function(e) {
		if(e.which == 13) {
			goSearch();
			
			return false;
		}
	});
	
	$('#searchMore').on('click', function(e){
		$("#originSearchWord").val($("#searchWord").val());
		$("#searchWord").focus().val("");
	});
	
	// 버튼 페이지 이동
	$(document).on("click",".pageList button",function(){
		var link = $(this).attr("href");
		var box = $(this).parent().parent().attr("id");
		
		getHttprequest(link, box);
	});
	
	// 검색 포커스 class 추가
	$('#searchWord').focusin(function() {
	    $(this).parent().addClass('search--focused');
	})

	// 검색 포커스 아웃 class 제거
	$('#searchWord').focusout(function() {
		$(this).parent().removeClass('search--focused');
	});
	
	// 2019.07.05 mjmjmjmj91@danawa.com 버튼 페이지 이동(렌트리스)
	//$(document).on("click",".list__pagination a[id^='leaserent_page']",function(){
	//	var link = $(this).attr("data-url");
	//	var box = $(this).parent().parent().parent().parent().parent().attr("id");
	$(document).on("click",".list__pagination a[id^='leaserent_page']",function(){
		var link = $(this).attr("data-url");
		var box = 'resultList';

		if(gnb == 'leaserent' && lnb == 'mediumTermSearch') {
			sendGA('페이지이동','');
		}

		$.ajax({
			type:"GET",
			url : link,
			dataType : "html",
			beforeSend:function(){
	    		$(".reform .cover").addClass('on')
		    },
			error : function(request, status, error) {
				console.log("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
			},
			success : function(data) {
				$('#'+box).html(data);
				if(sessionStorage.getItem("surveyLeaserentSearch") == null || sessionStorage.getItem("surveyLeaserentSearch") == false) {
					$("#surveyContents.li_survey").css("display","block");
				}
				else {
					$("#surveyContents.li_survey").css("display","none");
				}
			},
			complete : function() {
				window.scrollTo(0,0);
				$(".reform .cover").removeClass("on");
		    }
		});
		
		//현재 URL 처리
		const queryString = link;
		const urlParams = queryString.split('?');
		
		//Page 변수 처리
		const urlParamsByData = new URLSearchParams(link);
		const page = urlParamsByData.get('Page');
		
		//페이징 변수 교체
		var urlParameter = '';
		for(var urlKey in urlParams) {
			if(urlParams[urlKey].indexOf('Work=leaserentSearch') !== -1 || urlParams[urlKey].indexOf('Work=mediumTermSearch') !== -1) {
				urlParameter = updateUrlParameter(urlParams[urlKey], 'Page', page);
			}
		}

		//push state 삽입
		var chageUrl = '';
		if(urlParameter != '') {
			changeUrl = "/leaserent/?" + urlParameter;
		} else {
			changeUrl = "/leaserent/?Page=" + page;
		}
		history.pushState(null, null, changeUrl);
	});
	
	// 팝업창 닫기
	$(document).on("click","#autodanawa_popup .close,#autodanawa_popup .bg",function(){
		
		var closeFlag = true;
		
		if (gnb == 'usedcar' && lnb == 'request' && $("#event_mycarsale").length) {
			if ($("#event_mycarsale img.upload-thumb").length || $("#event_mycarsale #txt_explain").val() ) {
				
				if (!confirm('신청을 취소하시겠습니까?')) {
					closeFlag = false;
				} 
			}
		}
		
		if (closeFlag) {
			if(gnb != 'leaserent' || lnb != 'priceCompare') {
				history.back(-1);
			}
			$("#autodanawa_popup").addClass("off");
			$("#autodanawa_popup .data").empty();
		}
	});
	
	// 도움말 닫기
	$(document).on("click","#autodanawa_help .close,#autodanawa_help .bg",function(){
		if ( typeof($("#help_data .model-info__point").attr("tooltip-layer")) === "undefined" && gnb != 'compare' ) {
			history.back(-1);
		}
		
		$("#autodanawa_help").addClass("off");
	});
	
	// 팝업 도움말
	$(document).on("click",".helpView",function(){
		var subject = $(this).attr("subject");
		var no = $(this).attr("no");
		var kind = $(this).attr("kind");
		
		if(kind && no && subject){
			getHttprequest("/service/help.php?no="+no+"&kind="+kind,"help_data");
			openHelp(subject,500,'');
		}
	});
	
	// 팝업 옵션 사양 정보
	$(document).on("click",".galleryView",function(){
		var subject = "사양 정보";
		var no = $(this).attr("val");
		var kind = "itemInfo";
		
		if(kind && no && subject){
			getHttprequest("/gallery/itemImg_detail.php?no="+no+"&kind="+kind,"help_data");
			openHelp(subject,500,'');
		}
	});
	
	// 신규 옵션 사양 정보
	$(document).on("click", ".optionInfo", function(e){		
		e.preventDefault();

		var no = $(this).attr("val");
		
		if (gnb == 'compare') {
			$("#help_data").html($("#optionKey_" + no).html());
			openHelp2('옵션 상세 정보', 500, '');
		} else if(lnb == "leaserentDealDetail") {
			var no = $(this).data("value");
			$(this).addClass("on");
			$("#layerPopup .g-layer__cont").empty().html($("#optionKey_"+no).html());
//			openLayerPopup('near', '용어사전', $(this));
			openLayerPopup('dim', '옵션 상세 정보');
		} else {
			$("#layerPopup .g-layer__cont").empty().html($("#optionKey_"+no).html())
			openLayerPopup('dim', '옵션 상세 정보');
		}
		return false;
	});
	
	$(document).on("click",".dictionaryView",function(){
		var subject = "용어 사전";	
		getHttprequest("/dictionary/dictionary.php?Dterm="+$(this).attr("val"),"help_data");
		openHelp(subject,620,'');
	});
	
	$(document).on("click", ".errorReport", function() {
		var param = '?referUrl=' + encodeURIComponent($(location).attr('href')); 
		
		if(gnb == 'leaserent' && lnb == 'priceCompare') {
			param += '&good_c=' + $(this).data("product") + '&cmpny_c=' + $(this).data("company") + '&price_q=' + $(this).data("price");
		}

		if($.cookie('dasysMSeq')) {
			window.open(inquiryUrl+"/onlineInquiry.php"+param, "errorReport", "width=800,height=880,status=1,top=100");
		}
		else {
			loginPopup();
		}
	});

	$(document).on('click', "#reportCancel", function(){
		history.back(-1);
		$("#autodanawa_popup").addClass("off");
	});
	
	//관심저장 삭제
	$(document).on("click", 'button[name=interestSave]', function(){
		if($.cookie('dasysMSeq')) {
			cn=$(this).attr("carname");
			br=$(this).attr("brand");
			mo=$(this).attr("model");
			
			//ajax
			$.ajax({
				type:"GET",
				url : "/service/interest_save.php",
				dataType : "text",
				data : "Type=save&Brand="+br+"&Model="+mo+"&Carname="+cn+"&no="+$.cookie('dasysMSeq')+"&site="+$.cookie('AccessSite'),
				contentType : "",
				error : function(response, error) {
					alert("다시 시도해주세요");
				},
				success : function(data) {
					var num = 	parseInt($(".save button[model="+mo+"]").siblings('span').html());
					if(data == 'delete') {
						alert("관심 모델에서 삭제되었습니다. ");
						if(num > 0) {
							$(".save button[model="+mo+"]").siblings('span').html(num - 1+"명");
						}
						$(".save button[model="+mo+"]").removeClass("on");

			
						if($("#notice li:eq(2)").find(".count em").html() - 1 <= 0) {
							$("#notice li:eq(2)").removeClass("on");
						}
						$("#notice li:eq(2)").find(".count em").html(parseInt($("#notice li:eq(2)").find(".count em").html()) - 1);
						
					}else if(data =='insert') {
						alert("마이페이지 > 보관함 > 관심 모델에 추가되었습니다.");
						$(".save button[model="+mo+"]").siblings('span').html(num + 1+"명");
						$(".save button[model="+mo+"]").addClass("on");

						if($("#notice li:eq(2)").find(".count em").html() <= 0) {
							$("#notice li:eq(2)").addClass("on");
						}
						$("#notice li:eq(2)").find(".count em").html(parseInt($("#notice li:eq(2)").find(".count em").html()) + 1);
					}else {
						alert("다시 시도해주세요");
					}
				}
			});
		}
		else {
			loginPopup();
		}
	});
	
	//딜러 로그인 hover
	$("[name='dealerLogin']").hover(function(){
		//
		$(this).addClass("on");
	}, function(){
		$(this).removeClass("on");
	});		

	//로그인
	$(document).on("click","[name='socialLogin']", function(){
		var index = $(this).index();
		var Site;
		
		if(index ==0){
			Site = "danawa";
		}else if(index == 1){
			Site = "naver";
		}else if(index == 2){
			Site = "daum";
		}else if(index == 3){
			Site = "kakao";
		}else if(index == 4){
			Site = "facebook";
		}

		var url = "/social/connect.php?site=" + Site;
		
		window.open(url);
	});

	$(document).on("click", "#logout", function() {
		var date = new Date();
		
		// 기존 쿠키 사용하던부분 임시적으로 쿠키제거
		$.cookie('dasysMSeq', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('dasysMid', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('dasysMkd', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('dasysMlevel', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('dasysMnote', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('dasysMuse', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('dasysNick', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('CheckTime', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('loginDFType', '0', {expires:date, path:'/', "domain":".danawa.com"});
		
		$.cookie('UserNo', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('UserName', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('AccessSite', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('AccessTime', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('SNSfacebookSeq', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('SNSfacebookNick', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('SNStwitterSeq', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('SNStwitteraNick', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('SNSnaverSeq', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('SNSnaverNick', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('SNSkakaoSeq', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('SNSkakaoNick', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('InformCount', '0', {expires:date, path:'/', "domain":"auto.danawa.com"});
		$.cookie('InterestCount', '0', {expires:date, path:'/', "domain":"auto.danawa.com"});
		
		$.cookie('SNSdanawaSeq', '0', {expires:date, path:'/', "domain":".danawa.com"});
		$.cookie('SNSdanawaNick', '0', {expires:date, path:'/', "domain":".danawa.com"});
		
		var backward = location.href;
		
		if (backward.indexOf('&popupBuy=true') > 0) {
			backward = backward.replace('&popupBuy=true', '');
		}
		
		if (backward.indexOf('&bannerType=finance') > 0) {
			backward = backward.replace('&bannerType=finance', '');
		}
		
		window.location.href = "https://auth.danawa.com/logout?url="+ encodeURIComponent(backward);
	});
	
    //유저정보
    $(document).on('click', 'button[name="memInfo"]', function(){
    	var type = $(this).attr("logintype");
    	var key = $(this).attr("key");
    	var search = $(this).attr("search");
    	var contentsType = $(this).attr("contentsType");
    	
    	getHttprequest(webUrl + "/service/ajax_memInfo.php?Type="+type+"&key="+key+"&search="+search+"&contentsType="+contentsType ,"help_data");
    	openHelp('회원정보',500,'');
    });
	
    //쪽지보내기
    $(document).on('click', '#memoSend', function(){
    	if($.cookie('dasysMSeq')) {
    		var flag = true;
    		var use = $.cookie('dasysMuse') != null ? $.cookie('dasysMuse') : '';
    		
    		if(location.pathname.indexOf('buy') > -1 && $(this).attr("sendtype") != 'comment') {
    			if( ( ($.cookie('dasysMkd') == 'N' || $.cookie('dasysMkd') == 'U') && $.cookie('AccessSite') =='danawa') || use.indexOf("D") > -1) {
    				flag = true;
    			}else {
    				flag = false;
    			}
    		}
    		
    		if(flag) {
    			$("#autodanawa_help").addClass("off");
        		
        		var windowOpen = window.open('','notieceWindow',"width=450px,height=400px,scrollbars=yes");
        		
        		windowOpen.location.href = "/mypage/?Work=noteWrite&Type="+ $(this).attr("logintype") +"&memKey="+$(this).attr("memKey") + "&sendType=" + $(this).attr("sendtype");
    		}
    		else {
    			if($.cookie('AccessSite') =='danawa') {
    				if(confirm("신차 구매상담은 신차,중고차 영업 회원만 쪽지를 발송할 수 있습니다.\n다나와 영업회원으로 신청하시겠습니까?")) {
        				url = '/mypage/?Work=memAgree';
        				window.open(url,"newwin1","toolbar=no, location=no, status=no, directories=no, scrollbars=yes, menubar=no, resizable=yes, left=0, top=0");
        			}
    			}
    			else {
    				if(confirm("신차 구매상담은 신차,중고차 영업 회원 회원만 쪽지를 발송할 수 있습니다.\n다나와 회원으로 가입하시겠습니까?")) {
        				url = 'https://auth.danawa.com/joinStep1?url='+ webUrl + '/social/connect.php?site=danawa';
        				window.open(url,"newwin1","toolbar=no, location=no, status=no, directories=no, scrollbars=yes, menubar=no, resizable=yes, left=0, top=0");
        			}    				
    			}    			
    		}
    	}
    	else {
    		$("#autodanawa_help").addClass("off");
    		loginPopup();
    	}
    });

  //닉네임 중복 체크
  $(document).delegate("#nickNameCheck","click",function(e) {
  	e.preventDefault();
  	
  	if($.cookie('AccessSite') != 'danawa') {
  		var nickName = $("#nickName").val();
  		var nickLength = nickName.length+(escape(nickName)+"%u").match(/%u/g).length-1;
  		
  		nickName = encodeURI(nickName);
  	
  		if(nickLength >= 6 && nickLength <= 20){
  			$.ajax({
  	    		type : "GET"
  	          	, async : false //true, false 
  	          	, url : "/social/nickNameCheck.php" //Request URL 
  	        	, dataType : "text" //전송받을 데이터의 타입 
  	          	, data :  "nickName=" + nickName
  	           	, contentType: "application/x-www-form-urlencoded; charset=UTF-8"   	          	
  	      		, success : function(data) {
  					if(data == "true") {
  						$("#nickCheck").attr("value","true");
  						alert("사용할 수 있습니다.");
  					}else if(data == "false") {
  						$("#nickCheck").attr("value","false");
  						alert("사용하실 수 없습니다.");
  					}else if(data == 'error') {
  						$("#nickCheck").attr("value","false");
  						alert("다시 시도해 주세요.");
  					}
  	            }
  	        	,error : function(request, error) { 
  	            	alert("code : " + request.status + "\r\nmessage : " + request.reponseText  + "/" + error); 
  	            }  
  	        });
  		}else {
  			$("#nickCheck").attr("value","false");
  			alert("닉네임은 6Byte ~ 20Byte 이내(한글 3~10자, 영문 6~20자)로 정해주세요.");
  		}	
  	}
  });

  // 라인업 탭 메뉴(가격/제원/사양+옵션)
  $(document).on('click', '.tabMenu > li', function(){
  	var listNum = $(".tabMenu > li").index( this );

  	$(".tabMenu > li").removeClass("on");
  	$(this).addClass("on");
  	$(".tabCont > li").removeClass("on");
  	$(".tabCont > li").eq(listNum).addClass("on");
  });
  
   //견적요청 현황
   $(document).on("click", "#estimateStart", function(e){
	   $(this).addClass('selfEstm');	//auto_x.x.x.js에 사용
	   getHttprequest(webUrl + '/service/sideEstimateNavi.php?Work=brand&Type=estimate', 'popup_data');
	   openPopup("모델 선택", 540, '');
   });
  
  $(document).on("click","#popup_data .estimateBrandList button",function(event){
  	var title = "모델 선택";
  	
  	brand = $(this).attr("brand");
  	
  	getHttprequest('/service/sideEstimateNavi.php?Work=model&Type=estimate&Brand=' + brand, 'popup_data');
  	
  	model = $(".location button[work='model']").attr("model");
  	
  	if(model) $("#popup_data button[model='"+model+"']").parent().addClass("on");
  	
  	openPopup(title,710,'');
  });

  //popup 모델 클릭
  $(document).on("click","#popup_data .estimateModelList button",function(event){
  	var model = $(this).attr("model");
  	
  	window.open("/newcar/?Work=estimate&Model="+model);
  	$("#autodanawa_popup").addClass("off");
  });
  
  var urlShareTimer
  
  //소셜 레이어 open
  $(document).on("click",".btn_share",function(event){
	  if(gnb == 'compare') {
		  $('#input_url').val(location.href);
	  }
	  
	  if($('.sns_share').hasClass('show')) {
		  $('.sns_share').removeClass('show');
		  $('.btn_share').removeClass('on');
	  }
	  else if ($('.url_share').hasClass('show')) {
		  $('.url_share').removeClass('show');
		  $('.sns_share').addClass('show');
		  $('.btn_share').addClass('on');
	  }
	  else {
		  $('.sns_share').addClass('show'); 
		  $('.btn_share').addClass('on');
	  }
	  
	  clearTimeout(urlShareTimer);
	  
	  sendGA('공유','');
  });

  //레이어 close
  $(document).on("click",".btn_close",function(event){
	  $('.sns_share').removeClass('show');
	  $('.url_share').removeClass('show');
	  $('.btn_share').removeClass('on');
	  clearTimeout(urlShareTimer);
  });
  
  // 레이어 외부 클릭
  $(document).mouseup(function (e){
	 if (!$('.sns_share').is(e.target) && $('.sns_share').has(e.target).length === 0
			 && !$('.btn_share').is(e.target) && $('.btn_share').has(e.target).length === 0
			 && !$('.url_share').is(e.target) && $('.url_share').has(e.target).length === 0) {
		 $('.sns_share').removeClass('show');
		 $('.url_share').removeClass('show');
		 $('.btn_share').removeClass('on');
		 clearTimeout(urlShareTimer);
	 }
  });
  
  //url 복사
  $(document).on("click",".copy_url, .input_url",function(event){
	  var copyText = document.getElementById("input_url");
	  
	  copyText.select();
	  document.execCommand("Copy");
	  
	  $('.sns_share').removeClass('show');
	  $('.url_share').addClass('show');
	  $('.btn_share').removeClass('on');
	  
	  urlShareTimer = setTimeout(function() {
		  $('.url_share').removeClass('show');
	  }, 2000);
  });
  
  //레이어팝업 브랜드 선택
  $(document).on("click", "#layerPopup .brand__list li", function(){
	$("#layerPopup").data('brand', $(this).data('brand'))
  })
	
  // 레이어팝업 닫기
  $(document).on("click", "#layerPopup .btn-close, #layerPopup .g-layer__dimm", function (e) {
	  var closeFlag = true;
	  
	  if ($(e.target).hasClass('g-layer__dimm') || $(e.target).hasClass('btn-close')) {
		  if ((gnb == 'leaserent' && lnb == 'priceCompare' && $("#write_form").length) || (gnb == 'leaserent' && lnb == 'mediumTermSearch' && $("#write_form").length)) {
			  if (($("#write_form input[name=carcolor]").length && $("#write_form input[name=carcolor]").val()) != "" || 
				  $("#write_form input[type=checkbox]:checked").length || 
				  $("#write_form #userName").val() || 
				  $("#write_form #sido").val() ||
				  $("#write_form #sigungu").val() || 
				  $("#write_form #requestContents").val() ) {
				  
				  if (!confirm('신청을 취소하시겠습니까?')) {
					  closeFlag = false;
				  } 
			  }
		  }
		  else if ((gnb == 'newcar' && lnb == 'estimate') || gnb == 'compare') {
			  if ($("#eDiv_1 .eFincPopup a.open").length) {
				  $("#eDiv_1 .eFincPopup a").removeClass("open");
			  }
			  
			  if ($("#counsel_cont").length) {
				  if ($("#counsel_cont input[name=color]").val() || 
						  $("#counsel_cont input[type=checkbox]:checked").length ||
						  $("#counsel_cont #name").val() ||
						  $("#counsel_cont #phone2").val() ||
						  $("#counsel_cont #sido").val() ||
						  $("#counsel_cont #sigungu").val() ||
						  $("#counsel_cont #requestContents").val() ) {
					  
					  if (!confirm('신청을 취소하시겠습니까?')) {
						  closeFlag = false;
					  } 
				  }
			  }
		  }
		
		  if (closeFlag) {
			//팝업 레이어 닫기시 호출했던 위치로 포커스 이동 - 웹 접근성 개선 230131
			if(typeof($('#layerPopup:visible div.g-layer__header h2')) != 'undefined') {
				//신차견적
				var layerContentsTitle = $('#layerPopup:visible div.g-layer__header h2.title').html();
				
				if(layerContentsTitle == '브랜드 선택') {
					//자동차백과 우측 신차견적내기 버튼
					if($('#layerPopup').attr('popupmode') == 'brandEstimate') {
						$('div.sideQuickBtn a').eq(0).focus();
					//우측 윙 신차견적 버튼
					} else if($('#layerPopup').attr('popupmode') == 'brandEstimateFromRightWing') {
						$('div#autodanawa_right ul#notice li').eq(1).find('a').focus();						
					} else if($('#layerPopup').attr('popupmode') == 'brandEstimateFromMain') {
						$('div.home_request div.newcar a').focus();						
					} else {
						if(gnb == 'auto' && lnb == 'brand'){
							$('div.location ul.list li').eq(2).find('button').focus();
						}
					}
				//렌트리스 리스트 보증금/선납금 레이어 팝업시 닫기 복귀 처리
				} else if(layerContentsTitle == '용어사전') {
					if(typeof($('#layerPopup:visible div.layer__sale-info strong.subj')) != 'undefined') {
						if($('#layerPopup:visible div.layer__sale-info strong.subj').html() == '보증금/선납금') {
							$('div.rent_option_wrap dl.row_pay dt a').focus();
						}
					}
				} else if(layerContentsTitle == '상세 비용') {
					if(gnb == 'leaserent' && lnb == 'priceCompare'){
						if(typeof($('div.re_directmall li.ri_info_color3 a')) != 'undefined') {
							$('div.re_directmall li.ri_info_color3 a').focus();
						}
					}
				//중기렌트 레이어 팝업시 닫기 복귀 처리
				} else if(layerContentsTitle == '다나와자동차 렌트리스 상담신청') {
					if(gnb == 'leaserent' && lnb == 'mediumTermSearch'){
						 $(this).parent().find();
						 var selectedTrimCode = $('#layerPopup:visible #write_form [name="nTrimsCode"]').val();
						 
						 $('a[id^="openRequestLayer_"]').each(function() {
							if($(this).attr('data-trimscode') == selectedTrimCode) {
								$(this).focus();
							}
						});
						
					}
				}
				
				if($('#layerPopup').attr('tabindex') != 'undefined') {
					$('#layerPopup').removeAttr('tabindex');
				}
				if($('#layerPopup').attr('popupmode') != 'undefined') {
					$('#layerPopup').removeAttr('popupmode');
				}
			}
			
			$("#layerPopup").find(".g-layer__cont").scrollTop(0).empty();
			$("#layerPopup").addClass('off').removeClass('g-layer--dimm');
			$("#layerPopup .g-layer__wrap").css({left:0, top:0});
			$("#layerPopup .g-layer__wrap").draggable({disabled:false});
			$("body").removeClass('disable-scroll').css('paddingRight', "0");
			  
			if (window.location.hash) {
				history.back(-1);
			}
			  
			if(lnb == "leaserentDealDetail") {
				$(".optionInfo.on").removeClass("on");
			}
		}
	  }
  });
  
  $(".tooltip #modelNoticePopup").click(function (e) {
	  e.preventDefault();
	  
	  var modelCode = '';
	  var brandCode = '';
	  
	  if(gnb == 'auto') {
		  modelCode = $('input[name="Model"]').val();
		  brandCode = $('input[name="Brand"]').val();
		  var defaultTop = 714;
		  if($('div.adverTop').height() == null) {
			  defaultTop = defaultTop - 50;
		  }
		  
		  if($('div.adverGnb').height() == null) {
			  defaultTop = defaultTop - 80;
		  }
		  
		  $('#LayerPopupNoticePosition').css('margin-left', '-270px');
		  
		  
	  } else if(gnb == 'newcar') {
		  modelCode = $('#scriptModel').val();
		  brandCode = $('#scriptBrandSeq').val();
		  
		  var defaultTop = 490;
		  if($('div.adverTop').height() == null) {
			  defaultTop = defaultTop - 50;
		  }
		  
		  if($('div.adverGnb').height() == null) {
			  defaultTop = defaultTop - 80;
		  }

		  $('#LayerPopupNoticePosition').css('margin-left', '-415px');
	  }
	  $('#LayerPopupNoticePosition').css('top', defaultTop + 'px');
	  
	  
		$("#help_data").html($(".tooltip .tooltip__contents").html());
		
		$.ajax({
	        type : "POST", //"POST", "GET"
	        url : "../service/ajax_model_notice.php", //Request URL
	        dataType : "html", //전송받을 데이터의 타입
	        data : {
	        	model: modelCode,
	        	brand: brandCode,
	        	articleNo:$('input[name="articleNo"]').val()
	        },
	        contentType: "application/x-www-form-urlencoded; charset=UTF-8" ,
	        success : function(data) {
				$('#noticeContent').html(data);
	        }
	    });
		
		$('#LayerPopupNotice').show();
		window.setTimeout(function(){
	        //var target = $("#layerPopup ul.brand__list > li").eq(0).find('a');
	        var target = $("#LayerPopupNoticePosition:visible").attr("tabindex","-10").focus();
	    },500);
		$(this).addClass('open');
	});
  

  
  $("div.modelinfo-check td a").live("click", function(e) {
	  e.preventDefault();
	  
	  var modelCode = '';
	  var brandCode = '';
	  
	  if(gnb == 'auto') {
		  modelCode = $('input[name="Model"]').val();
		  brandCode = $('input[name="Brand"]').val();
	  } else if(gnb == 'newcar') {
		  modelCode = $('#scriptModel').val();
		  brandCode = $('#scriptBrandSeq').val();
	  }
	  
	  $.ajax({
		  type : "POST", //"POST", "GET"
		  url : "../service/ajax_model_notice.php", //Request URL
		  dataType : "html", //전송받을 데이터의 타입
		  data : {
			  model: modelCode,
			  brand: brandCode,
			  articleNo:$(this).parent().parent().find($('input[name="selectArticleNo"]')).val()
		  },
		  contentType: "application/x-www-form-urlencoded; charset=UTF-8" ,
		  success : function(data) {
			  $('#noticeContent').html(data);
		  }
	  });
  });
  
  $("div#LayerPopupNotice .btn-close").live("click", function(e) {
		e.preventDefault();
		$('#LayerPopupNotice').hide();
		$(".tooltip .tooltip__lnk").removeClass('open');
	  
		if(gnb == 'auto' && lnb == 'model'){
			$('a#modelNoticePopup').focus();
		}
  });
  
  $(".releasetip #modelReleasePeriodPopup").click(function (e) {
	  $.ajax({
		  type : "POST", //"POST", "GET"
		  url : "../service/ajax_model_releasePeriod.php", //Request URL
		  dataType : "html", //전송받을 데이터의 타입
		  data : {
		  },
		  contentType: "application/x-www-form-urlencoded; charset=UTF-8" ,
		  success : function(data) {
			  $('#brandReleasePeriodPopup .modelinfo-release').html(data);
			  
			  var brandCode = $("#modelReleasePeriodPopup").data('brandcode');
			  $("#brandReleasePeriodPopup .tab-box__item").removeClass("tab-box__item--on");
			  $("#brandReleasePeriodPopup #releasePeriodItem-"+brandCode).addClass("tab-box__item--on");
			  $("#brandReleasePeriodPopup #releasePeriodPopupCont-"+brandCode).show();
			  
			  $("li[id^='releasePeriodItem-']").click(function (e) {
				  var brandCode = $(this).get(0).id.replace('releasePeriodItem-', '');
				  
				  $("#brandReleasePeriodPopup .tab-box__item").removeClass("tab-box__item--on");
				  $(this).addClass("tab-box__item--on");
				  
				  $("div[id^='releasePeriodPopupCont-']").hide();
				  $("#brandReleasePeriodPopup #releasePeriodPopupCont-"+brandCode).show();
			  });
		  }
	  });
	  
	  $("#brandReleasePeriodPopup").show();
	  window.setTimeout(function(){
	        var target = $("#brandReleasePeriodPopup div.g-layer__wrap").attr("tabindex","-10").focus();
	    },500);
  });
  
  $("#brandReleasePeriodPopup .btn-close").click(function (e) {
	  $("#brandReleasePeriodPopup").hide();
  });
});

//검색 이동
function goSearch(kd)
{
	if($("#searchWord").val() =="" || $("#searchWord").val().length<2){
		alert("2자 이상의 검색어를 입력해 주세요");
	}
	else{
		if(kd=="dnw"){
			var q=encodeURI($("#searchWord").val());
			window.open("http://search.danawa.com/dsearch.php?query="+q+"&tab=main","_blank" );
		}
		else{
			if($("#originSearchWord").val()){
				$("#searchWord").val($("#originSearchWord").val()+" "+$("#searchWord").val());				
			}
			
			var q=encodeURI($("#searchWord").val());
			
			window.location="/search/?q="+q;
		}
	}
	
	if(gnb == 'home') {
		sendGAExcpt('GNB','통합검색',$("#searchWord").val());
	}
}

function autoSearch()
{
	getHttprequest("/search/autoSearch.php?q="+encodeURIComponent($("#searchWord").val()),"search_preview");
}

/* Ajax */ 
function getHttprequest(URL, BOX)
{
	var requestSlicePosition = URL.indexOf('?');	
	var requestUrl = ''
	var requestUri = '';
	
	if (requestSlicePosition == -1) {
		requestUrl = URL;
	}
	else {
		requestUrl = URL.substring(0, requestSlicePosition);
		requestUri = URL.substring(requestSlicePosition+1);
	}
	
	$.ajax({
		type:"GET",
		url : requestUrl,
		dataType : "text",
		data : requestUri,
		contentType : "",
		error : function(response, error) {
			alert("다시 시도해주세요");
		},
		success : function(data) {
			$("#"+BOX).html(data);
		}
	});
}

/* Ajax async : false*/ 
function getHttprequestSync(URL, BOX)
{
	var requestSlicePosition = URL.indexOf('?');	
	var requestUrl = ''
	var requestUri = '';
	
	if (requestSlicePosition == -1) {
		requestUrl = URL;
	}
	else {
		requestUrl = URL.substring(0, requestSlicePosition);
		requestUri = URL.substring(requestSlicePosition+1);
	}
	
	$.ajax({
		type:"GET",
		url : requestUrl,
		async : false,
		dataType : "text",
		data : requestUri,
		contentType : "",
		error : function(response, error) {
			alert("다시 시도해주세요");
		},
		success : function(data) {
			$("#"+BOX).html(data);
		}
	});
}

function openHelp(ttl,w,loc, event)
{
	if(!window.location.hash || window.location.hash.indexOf("help")<0)  window.location.hash = window.location.hash + 'help';
	
	var docuW = parseInt(w);
	
	$("#help_title").text(ttl);

	// 팝업창 노출 지연
	timeoutId = setTimeout(function () { 
 		$("#autodanawa_help").removeClass("off");
    }, 200); 
	
 	var docuH = $(document).height();
 	var docuW = docuW + 20; 	
 	
 	$("#autodanawa_help .body").css( "width",w+"px" );
 	$("#autodanawa_help .bg").css("height",docuH);
	
 	var winW = $(window).width();
	var winH = $(window).height();
	var marginTop = 50;	// 위 아래 여백
	var marginSide = 10;	// 좌우 여백
	var headHeight = 50;	// title 높이
	var padding = 10;	// 내용 패팅
	
	$("#help_data").css("height","");
	
	var dataH = $("#help_data").height();
	
	if(dataH > winH - marginTop * 2 - headHeight - padding *  2){
		$("#help_data").css("height",(winH - marginTop * 2 - headHeight - padding *  2)+"px");		
	}
	
 	if(loc=='' || loc=='center'){	// 화면 중심 		
 	 	var scrollY = $(document).scrollTop();
 	 	var x = 0;
 	 	var y = 0;
 	 	var t = 0;
 	 	
 	 	if(winW < 1120) winW = 1120;
 	 	var x = parseInt((winW - w - 40 ) / 2);
 	 	
		$("#autodanawa_help .body").css( "left",x+"px" );
		var h = $("#help_data").height();
	 	y = parseInt((winH - h - 70) / 2);
	 	if( y< 50) y = 50;
	 	y += scrollY;
 		$("#autodanawa_help .body").css( "top", y+"px" );
	}else if(loc=="self"){	// 클릭한 주변
		$("#autodanawa_help .body").css( "left", (event.pageX-20)+"px" );
 		$("#autodanawa_help .body").css( "top", (event.pageY-10)+"px" );
	}else if(loc=="selfBottom"){	// 클릭한 주변
		if(winW < 1120) winW = 1120;
 	 	var x = parseInt((winW - w - 40 ) / 2);
		$("#autodanawa_help .body").css( "left", x+"px" );
 		$("#autodanawa_help .body").css( "top", (event.pageY+20)+"px" );
	}
	else{
		offset = $(loc).offset();
		$("#autodanawa_help .body").css( "left", offset.left+"px" );
		
		if(event) {
			$("#autodanawa_help .body").css( "top", (offset.top + event) + "px" );
		}
		else {
			$("#autodanawa_help .body").css( "top", offset.top+"px" );			
		}
	}
}

function openHelp2(ttl, w, loc, event)
{
	var docuW = parseInt(w);
	var docuH = $(document).height();
 	var docuW = docuW + 40;
 	
 	$("#help_title").text(ttl);
	$("#autodanawa_help").removeClass("off");
 	$("#autodanawa_help .body").css( "width",w+"px" );
 	$("#autodanawa_help .bg").css("height",docuH);
	
 	if (loc=='' || loc=='center') {
 		var winW = $(window).width();
 	 	var winH = $(window).height();
 	 	var scrollY = $(document).scrollTop();
 	 	var x = 0;
 	 	var y = 0;
 	 	var t = 0;
 	 	
 	 	if (winW < 1120) winW = 1120;
 	 	
 	 	var x = parseInt( (winW - w - 40 ) / 2 );
 	 	
		$("#autodanawa_help .body").css( "left",x+"px" );
		
		var h = $("#help_data").height();
		
	 	y = parseInt((winH - h - 70) / 2);
	 	
	 	if( y< 50) y = 50;
	 	
	 	y += scrollY;
 		$("#autodanawa_help .body").css( "top", y+"px" );
	}
 	else if(loc=="self"){	// 클릭한 주변
		$("#autodanawa_help .body").css( "left", (event.pageX-20)+"px" );
 		$("#autodanawa_help .body").css( "top", (event.pageY-10)+"px" );
	}
 	else if(loc == 'selfLeft') {
		$("#autodanawa_help .body").css( "left", (event.pageX-w)+"px" );
 		$("#autodanawa_help .body").css( "top", (event.pageY-10)+"px" );
	}
 	else{		
		if ($(loc).length) {
			offset = $(loc).offset();
			$("#autodanawa_help .body").css( "left", offset.left+"px" );
			$("#autodanawa_help .body").css( "top", offset.top+"px" );
		}
	}
}

function openPopup(ttl, w, loc)
{
	if(!window.location.hash || window.location.hash.indexOf("popup")<0)  window.location.hash= window.location.hash + 'popup';
	
	var docuW = parseInt(w);
	var docuH = $(document).height();
 	var docuW = docuW + 40;
 	
 	$("#popup_title").text(ttl);
	$("#autodanawa_popup").removeClass("off");
 	$("#autodanawa_popup .body").css( "width",w+"px" );
 	$("#autodanawa_popup .bg").css("height",docuH);
	
 	if(loc=='' || loc=='center'){	// 화면 중심
 		var winW = $(window).width();
 	 	var winH = $(window).height();
 	 	var scrollY = $(document).scrollTop();
 	 	var x = 0;
 	 	var y = 0;
 	 	var t = 0;
 	 	
 	 	if(winW < 1120) winW = 1120;
 	 	
 	 	var x = parseInt((winW - w - 40 ) / 2);
 	 	
		$("#autodanawa_popup .body").css( "left",x+"px" );
		
		var h = $("#popup_data").height();
		
	 	y = parseInt((winH - h - 70) / 2);
	 	
	 	if( y< 50) y = 50;
	 	
	 	y += scrollY;
 		$("#autodanawa_popup .body").css( "top", y+"px" );
	}else if(loc=="self"){	// 클릭한 주변
		$("#autodanawa_popup .body").css( "left", (event.pageX-20)+"px" );
 		$("#autodanawa_popup .body").css( "top", (event.pageY-10)+"px" );
	}else if(loc == 'selfLeft') {
		$("#autodanawa_popup .body").css( "left", (event.pageX-w)+"px" );
 		$("#autodanawa_popup .body").css( "top", (event.pageY-10)+"px" );
	}else{
		
		if ($(loc).length) {
			offset = $(loc).offset();
			$("#autodanawa_popup .body").css( "left", offset.left+"px" );
			$("#autodanawa_popup .body").css( "top", offset.top+"px" );
		}
	}
}

function openPopup2 (title, width, location, event)
{
	var docuW = parseInt(width);
	var docuH = $(document).height();
 	var docuW = docuW + 40;
 	
 	$("#popup_title").text(title);
	$("#autodanawa_popup").removeClass("off");
 	$("#autodanawa_popup .body").css("width", width+"px");
 	$("#autodanawa_popup .bg").css("height", docuH);
	
 	if (location=='' || location=='center') {	// 화면 중심
 		var winW = $(window).width();
 	 	var winH = $(window).height();
 	 	var scrollY = $(document).scrollTop();
 	 	var x = 0;
 	 	var y = 0;
 	 	var t = 0;
 	 	
 	 	if (winW < 1120) winW = 1120;
 	 	
 	 	var x = parseInt((winW - width - 40 ) / 2);
 	 	var h = $("#popup_data").height();
 	 	
		$("#autodanawa_popup .body").css("left", x+"px");
		y = parseInt((winH - h - 70) / 2);
	 	
	 	if(y< 50) y = 50;
	 	
	 	y += scrollY;
 		$("#autodanawa_popup .body").css( "top", y+"px" );
	}
 	else if (location == "self") {	// 클릭한 주변
		$("#autodanawa_popup .body").css( "left", (event.pageX-20)+"px" );
 		$("#autodanawa_popup .body").css( "top", (event.pageY-10)+"px" );
	} else if (location == "selfId") {
		offset = event.offset();
		$("#autodanawa_popup .body").css( "left", offset.left+"px" );
 		$("#autodanawa_popup .body").css( "top", $(document).scrollTop()+"px" );		
	}
 	else {
		offset = $(location).offset();
		$("#autodanawa_popup .body").css( "left", offset.left+"px" );
 		$("#autodanawa_popup .body").css( "top", offset.top+"px" );
	}
}

function openPopup3 (title, width)
{
	if(!window.location.hash || window.location.hash.indexOf("popup")<0)  window.location.hash= window.location.hash + 'popup';
	
	var docuW = parseInt(width);
	var docuH = $(document).height();
 	var docuW = docuW + 40;
 	var currentPointOffset = $(".request").offset();
 	
 	$("#popup_title").text(title);
	$("#autodanawa_popup").removeClass("off");
 	$("#autodanawa_popup .body").css("width", width+"px");
 	$("#autodanawa_popup .bg").css("height", docuH);
	
 	$("#autodanawa_popup .body").css( "left", (currentPointOffset.left)+"px" );
 	$("#autodanawa_popup .body").css( "top", (currentPointOffset.top)+"px" );
}

/* 배열로 만들기 */
function dnw_array(str,arr)
{
	eval(arr +'= new Array()');
	str = dnw_deChar(str);
	
	var strArr = str.split("#");
	var strCt = strArr.length;
	
	for(ct=0;ct<strCt;ct++){
		var strSet = strArr[ct].split("^");
		eval(arr+'[strSet[0]] = strSet[1]');
	}
}

function dnw_deChar2(str)
{
	str = JXG.decompress(str);
	str = dnw_decode(str);
	str = decodeURIComponent(str);
	str = str.replace(/&nbsp;/gi," ");
	
	return str;
}

function dnw_enChar2(str)
{
	alert("준비중..");
	
	return str;
}

function dnw_deChar(str)
{
	str = dnw_decode(str);
	str = decodeURIComponent(str);
	str = str.replace(/&nbsp;/gi," ");
	
	return str;
}

function dnw_enChar(str)
{
	str = encodeURIComponent(str);
	str = dnw_encode(str);
	
	return str;
}

function dnw_decode(input)
{
   var output = "";
   var chr1, chr2, chr3;
   var enc1, enc2, enc3, enc4;
   var i = 0;
   
   input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");
   
   do {
      enc1 = keyStr.indexOf(input.charAt(i++));
      enc2 = keyStr.indexOf(input.charAt(i++));
      enc3 = keyStr.indexOf(input.charAt(i++));
      enc4 = keyStr.indexOf(input.charAt(i++));
      chr1 = (enc1 << 2) | (enc2 >> 4);
      chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
      chr3 = ((enc3 & 3) << 6) | enc4;
      output = output + String.fromCharCode(chr1);
      
      if (enc3 != 64) {
         output = output + String.fromCharCode(chr2);
      }
      
      if (enc4 != 64) {
         output = output + String.fromCharCode(chr3);
      }
   } while (i < input.length);
   
   return output;
}

function dnw_encode(input)
{
   var output = "";
   var chr1, chr2, chr3;
   var enc1, enc2, enc3, enc4;
   var i = 0;
   
   do {
      chr1 = input.charCodeAt(i++);
      chr2 = input.charCodeAt(i++);
      chr3 = input.charCodeAt(i++);
      enc1 = chr1 >> 2;
      enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
      enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
      enc4 = chr3 & 63;
      if (isNaN(chr2)) {
         enc3 = enc4 = 64;
      } else if (isNaN(chr3)) {
         enc4 = 64;
      }
      output = output + keyStr.charAt(enc1) + keyStr.charAt(enc2) + 
         keyStr.charAt(enc3) + keyStr.charAt(enc4);
   } while (i < input.length);
   
   return output;
}

function dnw_array2(str,arr,cut1,cut2)
{
	if(!cut1) cut1 = "#";
	if(!cut2) cut2 = "^";
	
	eval(arr +'= new Array()');
	
	var strArr = str.split("#");
	var strCt = strArr.length;
	
	for(ct=0;ct<strCt;ct++){
		var strSet = strArr[ct].split("^");
		
		eval(arr+'[strSet[0]] = strSet[1]');
	}
}

/* 문자 앞뒤 공백제거 */
function string_trim(str)
{
	return str.replace(/^\s+|\s+$/g,"");
}

/* 숫자 에니메이션 */
function number_animate(numTo,box)
{
	var numTo = parseInt(numTo);
	var thisid = box;
	var $obj = $(thisid);
	
	if(numTo<0){
		numTo = Math.abs(numTo);
		var addStr = "(-) ";
	}else{
		var addStr = "";
	}
	
	var numNow = $obj.text();
	if(numNow.indexOf(" ")>0) numNow = numNow.substring(numNow.indexOf(" ")+1);
	
	var numNow = number_only(numNow);
	if(numTo == numNow) return addStr+number_format(numTo);
	else if(numTo > numNow && Math.abs(numTo - numNow)<10) var step = 1;
	else if(numTo < numNow && Math.abs(numTo - numNow)<10) var step = -1;
	else var step = parseInt((numTo - numNow) / 5);
	
	var step2 = Math.abs(step)+"";
	var len = step2.length;
	if(len<2) len = 0;
		
	var len2 = Math.pow(10,len-2);
	step = number_round(step,len2,"round");
	
	var spinning = setInterval(function(){
		$obj.text(function(){
			numNow += step;
			
			if(step > 0 && numNow >= numTo){
				 numNow = numTo;
				 clearInterval(spinning);
			}else if(step < 0 && numNow <= numTo){
				 numNow = numTo;
				 clearInterval(spinning);
	 		} 
				
			return addStr+number_format(numNow);
	 	});
	}, 40);
}

/* 절사방법 (floor round ceil) */
function number_round(num,dis,way)
{
	if(way == "floor") return Math.floor(num / dis ) * dis;
	else if(way == "ceil") return Math.ceil(num / dis ) * dis;
	else return Math.round(num / dis ) * dis;
}

/* 숫자만 검출하기 */
function number_only(str)
{
	if(str == "" || str == 0) return 0;
	
	str = ""+str+"";
	
	var rtn = "";
	var tmp = "";
	var way = "int";
	
	for(ilk = 0; ilk < str.length; ilk ++){
		tmp = str.charAt(ilk);
		
		if(tmp >= "0" && tmp <= "9"){
			rtn += tmp;
		}else if(tmp == "-"){
			rtn += tmp;
		}else if(tmp == "."){
			rtn += tmp;
			way = "float";
		}
	}
	
	if(!rtn) rtn=0;
	if(way == "float") return parseFloat(rtn);
	else return parseInt(rtn);
}

// 콤마 추가 (정수만 사용가능, 소수점 반올림..)
function number_format(num)
{
	if(num == "" || num == 0) return 0;
	
	num = Math.round(num);
	
	var str = ""+num+"";
	var rtn = "";
	
	for(ilk = 0; ilk < str.length; ilk ++){
		if(ilk > 0 && (ilk%3)==0 && str.charAt(str.length - ilk -1)!="-"){
			rtn = str.charAt(str.length - ilk -1) + "," + rtn;
		}else{
			rtn = str.charAt(str.length - ilk -1) + rtn;
		}
	}
	
	return rtn;
}

/* 이미지 없으면 블랭크 처리하기 */
function imageError(obj,kd)
{
	if(kd.substring(0,4)=="http") $(obj).attr("src",kd);
	else $(obj).attr("src","//autoimg.danawa.com/html/images/blank/"+kd);
}

/* 카카오톡 */
Kakao.init('bc28dbb79303c3490a7a205e22ad618b');

//소셜 공유
function sns_send(site,type)
{
	if(site=="twitter"){
		sns_send2('TWITTER');
	}
	else if(site=="facebook"){
		sns_send2('FACEBOOK');
	}
	else if(site=="kakao" ){
		sns_send2('KAKAO');
	}
	else if (site=="kakaostory") {
		sns_send2('KAKAO_STORY');
	}
}

// 2019.05.15 mjmjmjmj91@danawa.com 소셜 공유 통합
function sns_send2(site)
{
	var apiUrl = 'https://www.danawa.com/share/danawaSnsShareApi.php';
	var url = $("meta[property='og:url'").attr('content');
	var ttl = $("meta[property='og:title'").attr('content');
	var image = $("meta[property='og:image'").attr('content');
	var codes = "width=517, height=543, scrollbars=yes, status=no";
	
	if (site == "KAKAO") {
		Kakao.Link.sendDefault({
	    	objectType: 'feed',
	    		content: {
	    		title: ttl,
	    		description: '#신차 #중고차 #신차견적 #렌트리스',
	    		imageUrl: image,
	    		imageWidth: 360,
	    		imageHeight: 180,
	    		link: {
	    			mobileWebUrl: url,
	    			webUrl: url
	    		}
	    	}
	    });
	}
	else if (site == "LINE") {
		var siteUrl = apiUrl + '?snsType=' + site + '&url=' + encodeURIComponent(url);
		window.open(siteUrl, site, codes);
	}
	else {
		var siteUrl = apiUrl + '?snsType=' + site + '&content=' + encodeURI(ttl) + '&url=' + encodeURIComponent(url);
		window.open(siteUrl, site, codes);
	}
}

//로그인 창
function loginPopup() {
	window.location.href = "/social/connect.php?site=combine";
	
}

//딜러 로그인
function dealerLoginPopup(type, link)
{
	if($.cookie('dasysMSeq')) {
		if($.cookie('AccessSite') == 'danawa') {
			if(type == 'newcar') {
				if(link){
					location.href = link;
				}else{
					location.href = "/mypage/?Work=contract";	
				}
				
			}else if(type == 'usedcar') {
				if(link){
					location.href = link;
				}else{
					location.href = "/help/?Work=memAgree";	
				}
				
			}else if(type == 'usedcarInfo') {
				$("#popup_data").html("'신차 딜러'로 가입되어 있어 신청하실수 없습니다.신차 딜러 탈퇴 후 신청해주십시오.");
				openPopup('신차 딜러 회원일 경우', 300, 'center');
			}else if(type == 'newcarInfo') {
				$("#popup_data").html("'중고차 딜러'로 가입되어 있어 신청하실수 없습니다.중고차 딜러 탈퇴 후 신청해주십시오.");
				openPopup('중고차 딜러 회원일 경우', 300, 'center');
			}else if(type == 'newcarAleadyInfo') {
				$("#popup_data").html("이미 '신차 딜러'로 가입되어 있습니다.");
				openPopup('중고차 딜러 회원일 경우', 300, 'center');
			}else if(type == 'usedcarAleadyInfo') {
				$("#popup_data").html("이미 '중고차 딜러'로 가입되어 있습니다.");
				openPopup('중고차 딜러 회원일 경우', 300, 'center');
			}
		}else {
			alert("딜러 가입은 다나와 회원만 가능합니다");
		}
	}
}

//닉네임변경
function nickChangePopup()
{
	var txt = '<div class="nickChange_wrap">'+
		'<div class="title">다나와자동차에서 사용할 회원님의 닉네임을 정해주세요.</div>'+
			'<ul class="guide">'+
				'<li>닉네임은 6Byte ~ 20Byte 이내(한글 3~10자, 영문 6~20자)로 정해주세요.<li>'+
				'<li>다른 회원님의 닉네임과 중복될 수 없습니다. 중복 여부를 확인해주세요.<li>'+
			'</ul>'+
			
				'<div class="input clearFix">'+
					'<label for="nickName" class="screen_out">닉네임</label>'+
					'<input type="text" id="nickName" name="nickName"  placeholder="닉네임" maxlength="20" value="">'+
					'<input type="hidden" name="insertType" value="login">'+
					'<input type="text" style="display: none;" />'+
					'<button type="button" id="nickNameCheck">중복검사</button>'+
					'<input type="hidden" id="nickCheck" value="false">'+
				'</div>'+
			'<div class="btn">'+
			'<button type="button" id="nickconfirm" class="button large blue">적용하기</button>'+
		'</div>'+
	'</div>';
	
	$("#popup_data").html(txt);
	openPopup('닉네임 변경',540,'center');
}

/* 메일 유효성 검사 */
function check_Email(strValue)
{
	var regExp = /[0-9a-zA-Z][_0-9a-zA-Z-]*@[_0-9a-zA-Z-]+(\.[_0-9a-zA-Z-]+){1,2}$/;
	
	//입력을안했다면
	if(strValue.lenght == 0){
		 return false;
	}
	
	//데이터형식이맞지않다면
	if(!strValue.match(regExp)){
		return false;
	}
	
	return true;
 }

//콤마찍기 
function addComma(str)
{
	//str = String(str);
	var str = str.replace(/[^0-9]/g,'')
	
	return str.replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,');
}

//콤마풀기 
function removeComma(str)
{
	str = String(str);
	
	return str.replace(/[^\d]+/g, '');
}

//다나와 앱 info change
function getLayerInfo(obj, name) {
	$('.gnb_apps_list .gnb_apps_link').removeClass('active_apps');
	$('.gnb_apps_list #apps_link_' + name).addClass('active_apps');
	
	$('.gnb_apps_conts .gnb_apps_imgs').hide();
	$('.gnb_apps_conts #layerInfo_' + name).show();
	
	$("img[id^='qrCode_image']").hide();
	$("#qrCode_image_" + name).show();
	
	$('#now_mobileApp').val(name);
}

// 다나와 앱 설치 문자 전송
function sendSmsAppInstall(type)
{
	$.phoneVaildate = function(phoneNumber) {
		if(phoneNumber != "") { 
			var regExp = /^01([0|1|6|7|8|9]?)?([0-9]{3,4})?([0-9]{4})$/;
			
			if ( !regExp.test( phoneNumber ) ) {
			      return false;
			} else {
				return true;
			}
		}
	};	
	
	var serviceType = '';
	var appName = '';
	var phoneNumber = '';
	
	// buy>write
	if(type == 'buy'){
		phoneNumber = $("#phoneNumber").val();			
		serviceType = 'auto';
		appName = '자동차';

	// header, wing
	}else{
		var phoneNumObj = $("#mobile_service_layer .input_size_01");			
		serviceType = $('#now_mobileApp').val();
		appName = $('.active_apps').text();

		for(var i=0; i<phoneNumObj.length; i++){
			phoneNumber += phoneNumObj[i].value; 
		}
	}
	
	var phoneNumCheck = $.phoneVaildate(phoneNumber);
	
	if (phoneNumber == '' ) {
		alert("전화번호를 확인해주세요.");
		$("#mobile_service_layer .input_size_01").val("");
	} else {
		if (phoneNumCheck == false) {
			alert("전화번호 형식이 잘못되었습니다.");
			$("#mobile_service_layer .input_size_01").val("");
		} else {
			$.ajax({ 
				type : "POST" //"POST", "GET" 
				, async : true //true, false 
				, url : webUrl+"/service/ajax_sendSms.php" //Request URL 
				, dataType : "json" //전송받을 데이터의 타입 "xml", "html", "script", "json" 등 지정 가능 
				, timeout : 3000 //제한시간 지정 
				, cache : false //true, false 
				, data : {
					'processKind': 'sendSms',
					'serviceType': serviceType,
					'phone': phoneNumber,
					'appName'	: appName
				}
				, error : function(request, status, error) { 
					alert("code : " + request.status + "\r\nmessage : " + request.reponseText); 
				} 
				, success : function(data) {
					//console.dir(data);
					alert(data['msg'])
				} 
			});
		}
	}
}

//스크롤이동
function moveScroll(id, marginTop)
{
	if (!marginTop) {
		marginTop = 200;
	}
	
	var body = $("html, body");
	
	if (id) {
		var top = $("#"+id).offset().top;	
		body.stop().animate({scrollTop:top-marginTop}, '300', 'swing');
	}
	else { /*id가 없을 때는 animate 없이 상단으로 이동*/
		body.scrollTop(marginTop);
	}
}

function openLayerPopup(type, title, obj) {

	var scrollWidth= window.innerWidth-$(document).width();
	var objOffset = null;
	var objWidth = 0;
	
	if(!window.location.hash || window.location.hash.indexOf("popup")<0) {
		window.location.hash= window.location.hash + 'popup';
	}
	
	if (!scrollWidth) {
		scrollWidth = 17;
	}

	if (type == 'full') {
	}
	else if (type == 'near') {
		objOffset = obj.offset();
		objWidth = obj.width();
	}
	else if (type == 'dim') {
		$("#layerPopup").addClass('g-layer--dimm');
	}
	
	setTimeout(function() {
		$("#layerPopup .g-layer__header .title").text(title);
		$("#layerPopup").removeClass('off');
		if(lnb == "leaserentDealDetail") {
			$("body").addClass('disable-scroll');
		} else {
			$("body").addClass('disable-scroll').css('paddingRight', scrollWidth);
		}
		
		if (objOffset) {
			var popupOffset = $("#layerPopup .g-layer__wrap").offset();
			var popupLeft = objOffset.left+(objWidth+4) - popupOffset.left;
			var popupTop = objOffset.top - popupOffset.top;

			if ($(window).scrollTop()+$(window).height() < objOffset.top + $("#layerPopup .g-layer__wrap").height()) {
				popupTop = ($(window).height() - $("#layerPopup .g-layer__wrap").height() - 20) / 2;
			}

			$("#layerPopup .g-layer__wrap").css({left:popupLeft, top:popupTop});
		}
		
		if ($("#layerPopup input").length) {
			$("#layerPopup input:eq(0)").focus();
		} else {
			$("#layerPopup .btn-close").attr("tabindex", 0).focus();
		}
		
	}, 150);
}

function userInform(type) {
	if ($.cookie('dasysMSeq')) {
		if (type =='comment') {
			var url = "/mypage/?Work=inform&Tab=comment";
		}
		else if (type =='interest') {
			var url = "/mypage/?Work=interest&Tab=interest";
		}
		else if (type == 'estm') {
			var url = "/mypage/?Work=estimate&Tab=myEstm";
		}
		
		location.href=url;
	}
	else {
		loginPopup();
	}
}

function go_familySite(link){
	if(link) {
		window.open('about:blank').location.href = link;
	}
}

//네이버 전환률 수집
function naverScript(type, value) {

	var _nasa={};

	_nasa['cnv'] = wcs.cnv(type, value);

	if (!wcs_add) var wcs_add={};

	wcs_add['wa'] = 's_2f6cb86f147e';

	if (!_nasa) var _nasa={};

	wcs.inflow();
	wcs_do(_nasa);
} 

function sendGA(action, label) {
	
	var gaCategory = {
		'home':{
			'home':'메인'
		},
		'leaserent':{
			'leaserentSearch':'렌트/리스',
			'priceCompare':'렌트/리스',
			'mediumTermSearch':'1년렌트',
			'leaserentDeals':'금융사단독재고',
			'leaserentDealDetail':'금융사단독재고'
		},
		'newcar':{
			'dealer':'신차_신차 유료회원전용',
			'search':'신차리스트',
			'sales':'신차_신차 판매조건',
			'record':'신차_신차 판매실적',
			'request':'신차_신차 견적요청현황',
			'cash':'신차_신차 일시불정보',
			'finance':'신차_신차 할부정보',
			'insure':'신차_신차 자동차보험비교',
			'estimate':'신차_신차 견적내기'
		},
		'usedcar':{
			'home':'중고차_홈',
			'usedcarAdd':'중고차_매물관리_일반매물등록',
			'usedcarManage':'중고차_매물관리_등록매물관리',
			'list':'중고차_전체검색',
			'request':'중고차_내차팔기_판매상담현황',
			'finance':'중고차_중고차금융'
		},
		'auto':{
			'home':'백과_차량정보_홈',
			'brand':'백과_차량정보_브랜드',
			'model':'백과_차량정보_모델',
			'record':'백과_차량정보_판매실적',
			'modelPopup':'신차_신차 견적내기_가격제원사양',
		},
		'news':{
			'list':'뉴스/커뮤니티_리스트',
			'qna':'뉴스/커뮤니티_내게맞는차량문의'
		},
		'mypage':{
			'home':'마이페이지_홈',
			'infrom':'마이페이지_알림',
			'note':'마이페이지_쪽지',
			'estimate':'마이페이지_생성견적서',
			'interest':'마이페이지_관심모델',
			'boardList':'마이페이지_내게시물',
			'contractStatus':'마이페이지_딜러회원'
		},
		'help':{
			'notice':'이용안내_공지사항',
			'service':'이용안내_서비스안내',
			'member':'이용안내_회원안내',
			'adver':'이용안내_광고안내',
			'alliance':'이용안내_제휴문의'
		},
		'event':{
			'list':'이벤트_목록',
			'detail':'이벤트_상세'
		},
		'search':{
			'':'통합검색_홈'
		}
	};
	
	if (typeof(gaCategory[gnb]) == "undefined") {
		gaCategory[gnb] = {};
	}
	
	if (typeof(gaCategory[gnb][lnb]) == "undefined") {
		gaCategory[gnb][lnb] = {};
		gaCategory[gnb][lnb] = '미지정 ('+location.href+")";
	}
	
	//alert(gaCategory[gnb][lnb] + " " + action + " " + label);
	try {
		gtag('event', action, {'event_category':gaCategory[gnb][lnb],'event_label':label});
		//인사이트 클릭이벤트 신규, 230626
		_trk_clickTrace('EVT', 'GA_PC_' + gaCategory[gnb][lnb] + '_' + action + '_' + label);
	} catch(e) {
		console.log(e.message);
	}
}

function sendGAExcpt(category, action, label) {
	//alert(category + " " + action + " " + label);
	try {
		gtag('event', action, {'event_category':category,'event_label':label});
		//인사이트 클릭이벤트 신규, 230626
		_trk_clickTrace('EVT', 'GA_PC_' + category + '_' + action + '_' + label);
	}catch (e) {
		console.log(e.message);
	}
}

function openAutoTab(work) {
	// Location 선택
	if (work == "brandEstimate" || work == "brandEstimateFromRightWing" || work == "brandEstimateFromMain" || work == "brandEstimateForLeaserent") {
		
		var param = "brandEstimate";
		if (work == "brandEstimateForLeaserent") {
			param = "leaserentBrandEstimate";
		}
		
		getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=' + param, 'layerPopup .g-layer__cont');
		openLayerPopup('dim', '브랜드 선택');
		
		//브랜드 선택 레이어 팝업시 웹 접근성 수정
	    window.setTimeout(function(){
	        //var target = $("#layerPopup ul.brand__list > li").eq(0).find('a');
	        var target = $("#layerPopup:visible").attr("tabindex","-10").focus();
	    },500);
		
		window.setTimeout(function(){
	        var target = $("#layerPopup:visible").attr("popupmode", work);
	    },500);
		
		return;
	} else if(work=="brand"){
		if(gnb == 'leaserent' && lnb == 'priceCompare') {
			getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=brand&Type=buy&refer=leaserentSimpleEstimate', 'layerPopup .g-layer__cont');
		} else if (gnb == 'compare') {
			getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=brand&Type=compare&refer=compare', 'layerPopup .g-layer__cont');
		} else if (gnb == 'usedcar') {
			getHttprequest(webUrl + '/service/ajax_usedcar_brand.php?Step=brand', 'layerPopup .g-layer__cont');
		} else {
			getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=brand&Type=buy', 'layerPopup .g-layer__cont');
		}
		
		openLayerPopup('dim', '브랜드 선택');
		return;
	} else if (work == 'modelEstimate') {

		if ($("#layerPopup").data('brand')) {
			brand = $("#layerPopup").data('brand');
		}
		
		getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=model&Type=buy&Brand='+brand+"&refer=modelEstimate", 'layerPopup .g-layer__cont');

		openLayerPopup('dim', '모델 선택');
		return;
	} else if (work == 'leaserentModelEstimate') {
		
		if ($("#layerPopup").data('brand')) {
			brand = $("#layerPopup").data('brand');
		}
		
		getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=model&Type=buy&Brand='+brand+"&refer=leaserentSimpleModelEstimate", 'layerPopup .g-layer__cont');

		openLayerPopup('dim', '모델 선택');
		return;		
	} else if(work=="segment") {
		getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=segment&Type='+gnb+'&Brand=' + brand, 'layerPopup .g-layer__cont');
		openLayerPopup('dim', '모델 선택');
		return;
	} else if(work=="series") {
		
		if (gnb == "usedcar") {
			brand = $("#layerPopup").data('brand');
			getHttprequest('/service/ajax_usedcar_brand.php?Step=series&Brand='+brand,'layerPopup .g-layer__cont');
			openLayerPopup('dim', '모델 선택');
		} else {
			getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=series&Type='+gnb+'&Brand=' + brand, 'layerPopup .g-layer__cont');
			openLayerPopup('dim', '모델 선택');
		}
		
		return;
	} else if(work=="model") {
		var subject ="모델 선택";
		var bUseDefaultURL = true;
		
		if ($(".lnbTab button[work='brand']").attr("brand")) {
			brand = $(".lnbTab button[work='brand']").attr("brand");
		}

		if ($("#layerPopup").data('brand')) {
			brand = $("#layerPopup").data('brand');
		}
		
		if(gnb == 'leaserent' && (lnb == 'leaserentSimpleEstimate' || lnb == 'priceCompare')) {
			getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=model&Type=estimate&Brand=' + brand + '&month='+ month +'&refer=leaserentSimpleEstimate', 'layerPopup .g-layer__cont');
			bUseDefaultURL = false;
		} else if (gnb == 'compare') {
			getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=model&Type=compare&refer=compare&Brand='+brand+"&box="+estmAct, 'layerPopup .g-layer__cont');
			bUseDefaultURL = false;
		} else if (gnb == 'auto') {
			if (lnb == 'brand') {
				location = "./?Work=brand&Brand="+brand+"&Tab="+$("#autodanawa_gridC .gridLeft .tabs li.on").attr("tab");
				return;
			} else {
				getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=series&Type='+gnb+'&Brand=' + brand, 'layerPopup .g-layer__cont');
				bUseDefaultURL = false;
			}
		} else if (gnb == 'news') {
			if (lnb == 'list') {
				if (tab == 'photo' || tab == 'movie') {
					window.location = '/talk/?Tab='+tab+'&Work=list&Brand=' + brand;
					return;
				}
			} else if (lnb == 'qna') {
				getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=model&Type=buy&Brand='+brand+"&refer=qna", 'layerPopup .g-layer__cont');
				bUseDefaultURL = false;
			}
		} else if (gnb == 'mypage') {
			if (lnb == 'scPromotion' || lnb == 'shPromotion') {
				getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=model&Type=buy&Brand='+brand+"&refer=mypage", 'layerPopup .g-layer__cont');
				bUseDefaultURL = false;
			}
		}

		if (bUseDefaultURL) {
			getHttprequest(webUrl + '/service/navigatorNewcar.php?Work=model&Type=buy&Brand='+brand, 'layerPopup .g-layer__cont');
		}

		openLayerPopup('dim', subject);
		return;
	} else if (work == 'leaserentSimpleEstimateMain') {
		var trims = "";
		if ($("#layerPopup").data('brand')) {
			brand = $("#layerPopup").data('brand');
		}
		if ($("#layerPopup").data('model')) {
			model = $("#layerPopup").data('model');
		}
		if ($("#layerPopup").data('trims')) {
			trims = $("#layerPopup").data('trims');
		}
		
		var test = JSON.stringify(this);
		
		alert(test);
		
		rentLeaseSimpleEstimate(trims);
	}
}

// 메인 렌트리스 간편 상담
function rentLeaseSimpleEstimate(trims, prodType, popularPurchaseYN) {
	if ($("#layerPopup").data('trims')) {
			trims = $("#layerPopup").data('trims');
		}
	
	var popupTitle = '렌트리스 상담신청';
	
	$.ajax({ 
		type: 'GET', 
		url: webUrl + '/leaserent/mainLeaserentSimpleEstimate.php', 
		data:"trimsCode="+trims+"&prodType="+prodType+"&popularPurchaseYN="+popularPurchaseYN,
		dataType : 'html', 
		beforeSend:function(){
			$(".rent_blog_wrap .cover").addClass('on')
	    },
		success: function(data) {
			naverScript(1, 1000);
			$("#layerPopup .g-layer__cont").empty().html(data);
			$("#layerPopup .g-layer__wrap").draggable({disabled:true})
			$("#layerPopup .g-layer__cont").scrollTop(0);

			openLayerPopup('dim', popupTitle);
		},complete : function() {
			$(".rent_blog_wrap .cover").removeClass("on");
			$("#autodanawa_popup .bg").css("height",$(document).height()*(1.1));
			
			//레이어 팝업시 웹 접근성 수정
			window.setTimeout(function(){
		        var target = $("#layerPopup:visible").attr("tabindex","-10").focus();
		    },500);
	    }
	});
}

function rgb2hex(rgb) {
	if (  rgb.search("rgb") == -1 ) {
        return rgb;
	} else {
        rgb = rgb.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/);
        function hex(x) {
             return ("0" + parseInt(x).toString(16)).slice(-2);
        }
        return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]); 
    }
}

function onOffSlide(id) {
	if ($("#"+id).length) {
		if ($("#"+id).hasClass('close')) {
			$("#"+id).removeClass('close')
		}
		else {
			$("#"+id).addClass('close')
		}
	}
}

function sendUXLOG(uxid, oParam) {
	if(!uxid) {
		return 0;
	}

	// 회원일경우 수집 항목 추가 
	if($.cookie('dasysMSeq')) {
		oParam['userNumber'] = $.cookie('dasysMSeq');
	}
	
	try {
		DSAC.execute(JSON.stringify({"uxid":uxid, "parameter":oParam}));		//AWS 신규 로깅 스크립트
	} catch(e) {
		console.log(e.message);
	}
}

function updateUrlParameter(url, param, value){
    var regex = new RegExp('('+param+'=)[^\&]+');
    return url.replace( regex , '$1' + value);
}

function openReportPopup(category, no, title) {
	if($.cookie('dasysMSeq')) {
		
		if (title.length > 20) {
			title = title.substr(0, 50);
		}
		
		window.open("/report/report.php?contentsType="+category+"&contentsSeq="+no+"&title="+encodeURI(title), "report", "width=470,height=880,status=1,top=100");
	}
	else {
		if (confirm("로그인이 필요한 서비스입니다. 로그인하시겠습니까?")) {
			loginPopup();
		}
	}
}

function setUserBlock(userNo, userName) {
	
	if (confirm(userName+"님의 전체 게시물이 차단됩니다.\n차단목록에 추가하시겠습니까?")) {
		$.ajax({ 
			type : "POST"
			, async : true
			, url : "/service/ajax_reportResult.php"
			, dataType : "json"
			, timeout : 30000
			, cache : false
			, data : {
				'action':'setUserBlock',
				'blockUserNo':userNo
				}
			, contentType: "application/x-www-form-urlencoded; charset=UTF-8" 
			, error : function(request, status, error) { 
				console.log("code : " + request.status + "\r\nmessage : " + request.reponseText); 
			} 
			, success : function(data) {
				if (data.result == 0) {
					alert(data.msg)
				} else {
					console.dir(data);
					window.location.reload();
				}
			} 
		});
	}
}

function cancelBlockLayer(selector) {

	if ($("#"+selector).hasClass('off')) {
		$("#"+selector).removeClass('off');
	} else {
		$("#"+selector).addClass('off');
	}
}

function cancelBlock(category, contentsNo, cancelUserNo) {
	
	$.ajax({ 
		type : "POST"
		, async : true
		, url : "/service/ajax_reportResult.php"
		, dataType : "json"
		, timeout : 30000
		, cache : false
		, data : {
			'action':'cancelBlock',
			'contentsType':category,
			'contentsSeq':contentsNo,
			'cancelUserNo':cancelUserNo
			}
		, contentType: "application/x-www-form-urlencoded; charset=UTF-8" 
		, error : function(request, status, error) { 
			console.log("code : " + request.status + "\r\nmessage : " + request.reponseText); 
		} 
		, success : function(data) {
			if (data.result == 0) {
				alert(data.msg)
			} else {
				console.dir(data);
				window.location.reload();
			}
		} 
	});
}

//SMS 간편인증
var certificationObj;
var certificationTime = 180;
var certificationMin = "";
var certificationSec = "";
function certificationTimeout() {
	certificationTime--;
	
	certificationMin = parseInt(certificationTime/60);
	certificationSec = certificationTime%60;
	var innerText = '';
	if(certificationSec >=0 && certificationSec <= 9) {
		innerText = certificationMin+":0"+certificationSec;
	} else {
		innerText = certificationMin+":"+certificationSec;
	}
	$("#certifyTime").text(innerText);
	
	if(certificationTime <= 0) {
		clearInterval(certificationObj);
		$("#certifyTime").text("");
		$("#certifyTimeout").show();
	}
}